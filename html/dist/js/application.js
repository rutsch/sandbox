function reloadApp(){location.reload()}var objUtils={};function getEl(e){return document.getElementById(e)||document.getElementsByClassName(e)[0]||document.getElementsByTagName(e)[0]||null}function findPos(e){var t=0,o=0;if(e.offsetParent)do{t+=e.offsetLeft,o+=e.offsetTop}while(e===e.offsetParent);return[t,o]}function logAction(e,t,o){}function lon2x(e){return 2.752*e+473.75}function lat2y(e){return-2.753*e+231}function collectionHas(e,t){for(var o=0,i=e.length;o<i;o++)if(e[o]===t)return!0;return!1}function getFirstLevelChildElements(e,t){for(var o=e.getElementsByTagName(t),i=[],a=0;a<o.length;a++)o[a].parentNode===e&&i.push(o[a]);return i}function findParentBySelector(e,t){for(var o=getEl(e),i=document.querySelectorAll(t),a=o.parentNode;a&&!collectionHas(i,a);)a=a.parentNode;return a}function getParamStringFromObject(e){var t=[];for(var o in e)"string"==typeof o&&t.push(o+"="+encodeURIComponent(e[o]));return t.join("&")}function containsClass(e,t){var o="string"==typeof e?e:e.getAttribute("class");return"string"==typeof o&&o.split(" ").indexOf(t)>-1}function toggleClass(e,t,o){var i=e.getAttribute("class");"boolean"==typeof o?o?"string"==typeof i?containsClass(i,t)||e.setAttribute("class",i+" "+t):e.setAttribute("class",t):"string"==typeof i&&containsClass(i,t)&&e.setAttribute("class",i.replace(new RegExp("\\b"+t+"\\b","g"),"")):("string"==typeof i&&(i=containsClass(e,t)?i.replace(new RegExp("\\b"+t+"\\b","g"),""):i+" "+t),e.setAttribute("class",i))}function svgSetTransform(e,t){"Infinity"===t.scale&&(t.scale=1);var o="matrix("+t.scale+",0,0,"+t.scale+","+t.translatex+","+t.translatey+")";e.setAttributeNS(null,"transform",o)}function svgRetrieveZoomLevel(e){if(!e)return 1;var t=parseFloat(e.getAttributeNS(null,"transform").replace(/.*bla\(\s*(\d[^\,]*).*/g,"$1"));return isNaN(t)?1:t}function getTransformedWidth(e,t){return t.getTransformToElement(e).a*t.cx.animVal.value}function rgbFromHex(e){function t(e){return"#"===e.charAt(0)?e.substring(1,7):e}return{r:(a=e,parseInt(t(a).substring(0,2),16)),g:(i=e,parseInt(t(i).substring(2,4),16)),b:(o=e,parseInt(t(o).substring(4,6),16))};var o,i,a}function colourGradientor(e,t,o){var i=(2*e-1+1)/2,a=1-i;return[parseInt(t[0]*i+o[0]*a,10),parseInt(t[1]*i+o[1]*a,10),parseInt(t[2]*i+o[2]*a,10)]}function encodeUrl(e){return escape(e).replace(/\+/g,"%2C").replace(/\"/g,"%22").replace(/\'/g,"%27").replace(/\//g,"%2F")}function generateUniqueId(){var e=Math.random();e=Math.round(1e4*e);var t=Math.random();return t=Math.round(1e4*e),e=e+"x"+(new Date).getSeconds()+"x"+t}var matchFound=!1,returnObj={};function iterate(e,t,o){for(var i in e)if(e.hasOwnProperty(i))if("object"==typeof e[i])iterate(e[i],t,o);else if(e[i]===o&&i===t){returnObj=e,matchFound=!0;break}return returnObj}function handleShibbolethLoginRequired(e){null==window.objStore.getlocalstorageitem("stateremembered")&&(location.hash.indexOf("login/")>-1?window.objStore.setlocalstorageitem("stateremembered",JSON.stringify(window.app.defaultpagestate)):window.objStore.setlocalstorageitem("stateremembered",JSON.stringify(window.objPageState.hash2object(location.hash)))),e?e(null,{authenticated:!1}):window.objLogin.logout()}function psv(e,t,o,i){var a,n,r=!1;"prod"===window.objConfig.sitetype&&(r=!1),window.objLoading.show(),(a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){if(4===this.readyState)if(200===this.status)if(window.objLoading.hide(),a.responseText.toLowerCase().indexOf('name="samlrequest"')>0)handleShibbolethLoginRequired(i);else if(r)try{(e=JSON.parse(a.responseText)).hasOwnProperty("error")&&("Not authenticated"===e.error.message||"Token mismatch"===e.error.message)?(window.objStore.setlocalstorageitem("reloadtime",(new Date).getTime()/1e3),window.objLogin.logout()):i(null,e)}catch(e){i(e)}else try{var e;(e=JSON.parse(a.responseText)).hasOwnProperty("error")&&("Not authenticated"===e.error.message||"Token mismatch"===e.error.message)?window.objLogin.logout():i(null,e)}catch(e){a.responseText,i(e)}else i(a.statusText)},n=getParamStringFromObject(o),a.open(e,t+("GET"===e?"?"+n:""),!0),a.crossDomain=!0,a.withCredentials=!0,"POST"===e?(a.timeout=4e4,a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(n)):a.send()}function serverSideRequest(e){var t,o,i,a=!0,n=!1,r=!1,l=!1,s="",d="",w="post",u="",p=null;if(d=void 0!==e.url?e.url:"",p=void 0!==e.callback?e.callback:null,void 0!==e.bypasscache&&"true"===e.bypasscache&&(l=!0),w=void 0!==e.method?e.method.toLowerCase():"get","true"===(void 0!==e.debug?e.debug+"":"false").toLowerCase()&&(r=!0),"string"==typeof(u=void 0!==e.arrdata?e.arrdata:"")&&(u=void 0!==e.formdata?e.formdata:""),r&&(u.debug="true"),"string"!=typeof u&&(n=!0),null==p&&(a=!1),r&&alert("Parameters recieved:\nstrUrl="+d+"\ncallbackFunction="+p+"\nstrMethod="+w+"\narrFormData="+u+"\nbolSubmitFormData="+n+"\nbolAsync="+a),l&&("post"===w?d+=d.indexOf("?")>0?"&rnd="+generateUniqueId():"?rnd="+generateUniqueId():"string"!=typeof u?u.rnd=generateUniqueId():((u=new Array).rnd=generateUniqueId(),n=!0)),n){var c=new Array;for(t in u)"function"!=typeof u[t]&&"object"!=typeof u[t]&&(o=encodeUrl(u[t]),c.push(t+"="+o));s=c.join("&"),r&&alert("Form data sent to server:\n"+s)}var g=function(){try{return new XMLHttpRequest}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}}();g.onreadystatechange=a?function(){4===this.readyState&&(200===this.status?(i=g.responseText,r&&alert("just before callback function\n\n"+i),p(void 0,i)):(i="ERROR: There was a problem retrieving the server side data:\n"+g.statusText,p(i)))}:function(){},"get"===w.toLowerCase()&&s.length>0&&(d+="?"+s);try{g.open(w.toUpperCase(),d,a),n&&"post"===w.toLowerCase()?(g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(s)):g.send(null)}catch(e){if(!a)return null;p(JSON.stringify(e))}if(!a)return g.responseText}function countryClicked(e,t,o){var i=getEl(e);if(window.objPageState.mobile=!!t,window.objPageState.state.filter.oru!==e&&(!1===containsClass(i,"no-data")&&!1===window.objPageState.mobile||window.objPageState.mobile)){var a="detail",n=e;"string"==typeof o&&"worldmap"===o&&(a="worldmap",n="none"),window.objPageState.updatepagestate({view:a,filter:{oru:n,datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype}})}else window.objPageState.updatepagestate({view:"worldmap",filter:{oru:"none",datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype}})}function setNumberSeperators(e){var t="",o=new String(e),i=(o=o.split("."))[1]?o[1]:"";o=o[0].split("").reverse();for(var a=0;a<=o.length-1;a++)t=o[a]+t,(a+1)%3==0&&o.length-1!==a&&(t=","+t);return""!==i&&(t+=".",t+=i),t.indexOf(".")>-1&&t.split(".")[1].length<2&&(t+="0"),t}function formatFinancialData(e){return parseFloat(e)<0?"("+setNumberSeperators(0-parseFloat(e))+")":setNumberSeperators(e)}function formatMoney(e,t,o,i,a){if(void 0===e)return e;t=isNaN(t=Math.abs(t))?2:t,i=void 0===i?".":i,o=void 0===o?",":o,a=void 0===a?"":a;var n=e<0?"-":"",r=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",l=(l=r.length)>3?l%3:0;return n+a+(l?r.substr(0,l)+o:"")+r.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(t?i+Math.abs(e-r).toFixed(t).slice(2):"")}function loadUrlInBrowser(e){var t=!1;arguments.length>1&&(t=arguments[1]),window.objAnalytics.data.events.push({category:e.match(/^https?:\/\/.+\.(zip|dmg|txt|cfg|gz|pl|pdf)$/i)?"download":"link",action:"click",label:e}),window.app.state.webbrowser?t?window.open(e):location.href=e:t?window.open(e,"_system","location=no"):window.open(e,"_blank","location=no")}function hasProperty(e,t){return"object"==typeof e&&null!==e&&e.hasOwnProperty(t)}function isPublicSite(){return window.objConfig.sitetype.indexOf("public")>-1}function translateFragment(e){if(window.objConfig.fragments.hasOwnProperty(e)){var t=window.objConfig.fragments[e];return t.indexOf("CO2")>-1&&(t=t.replace(/^(.*CO)(\d)(.*)$/,"$1<sub>$2</sub>$3")),t.indexOf("m3")>-1&&(t=t.replace(/^(.*m)(\d)(.*)$/,"$1<sup>$2</sup>$3")),t}return"["+e+"]"}function cloneObject(e){try{return JSON.parse(JSON.stringify(e))}catch(e){return console.trace(),console.log("---------------")}}function css(e,t){for(var o in t)"string"==typeof o&&(e.style[o]=t[o])}function messageIframeResizeToParent(){window.setTimeout(function(){window.postMessageToParent({action:"adjustiframeheight",value:document.getElementsByTagName("body")[0].offsetHeight})},100)}function postMessageToParent(e){window.parent.postMessage("object"==typeof e?JSON.stringify(e):e,"*")}var objStore={vars:{uselocalstorage:!0},store:null,setlocalstorageitem:function(e,t){objStore.store.setItem(e,t)},getlocalstorageitem:function(e){return objStore.store.getItem(e)},removelocalstorageitem:function(e){objStore.store.removeItem(e)},init:function(){var e=this;try{var t="t_"+Date.now();localStorage.setItem(t,t);var o=localStorage.getItem(t);if(localStorage.removeItem(t),t!==o)throw new Error;objStore.store=window.localStorage}catch(t){e.vars.uselocalstorage=!1,objStore.store=new MemoryStorage}null==e.getlocalstorageitem("statguid")&&e.setlocalstorageitem("statguid","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}};!function(e,t,o){"function"==typeof define&&define.amd?define("memorystorage",[],function(){return o()}):"object"==typeof exports?module.exports=o():e.MemoryStorage=o()}(this,0,function(){"use strict";var e={clear:1,getItem:1,id:1,key:1,length:1,removeItem:1,setItem:1},t="__memorystorage_cloaked_items__",o={};return function i(a){function n(){return Object.keys(r).filter(function(t){return!(t in e)}).concat(Object.keys(l))}var r=o[a=a||"global"];if(r)return r;if(!(this instanceof i))return new i(a);r=o[a]=this;var l={};return Object.defineProperty(r,t,{enumerable:!1,configurable:!0,get:function(){return l}}),Object.defineProperty(r,"id",{enumerable:!0,configurable:!0,get:function(){return a}}),Object.defineProperty(r,"length",{enumerable:!0,configurable:!0,get:function(){return n().length}}),r.getItem=function(o){return o in e?this[t][o]:this[o]},r.setItem=function(o,i){o in e?this[t][o]=i:this[o]=i},r.removeItem=function(o){o in e?delete this[t][o]:delete this[o]},r.key=function(e){var t=n();return e>=0&&e<t.length?t[e]:null},r.clear=function(){for(var o=Object.keys(this).filter(function(t){return!(t in e)}),i=0;a=o[i];i++)a in e||delete this[a];var a;for(o=Object.keys(this[t]),i=0;a=o[i];i++)delete this[t][a]},"undefined"==typeof Proxy?r:new Proxy(r,{ownKeys:function(){return n()}})}});var objInfographic={},objArcProps={targetnode:null,targetleftwrapper:null,targetleftnode:null,centerx:150,centery:125,radius:100,angle:0,anglestored:0};function renderInfographic(e){void 0===e.initial&&(e.initial=!0),void 0===e.setall&&(e.setall=!0),generateArc({targetnode:objArcProps.targetnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:null,angle:e.angle}),e.setall&&generateArc({targetnode:objArcProps.targetleftnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:objArcProps.targetleftwrapper,angle:360-e.angle}),e.initial&&(objArcProps.anglestored=e.angle)}function applyInfographicDelta(e){e>=objArcProps.anglestored?renderInfographic({angle:e,initial:!1,setall:!0}):renderInfographic({angle:e,initial:!1,setall:!1})}function generateArc(e){var t=360-e.angle;t<=0&&(t=.1);var o=[];o.push("M "),o.push(e.centerx+e.radius*Math.cos((270-t)*Math.PI/180)+" "),o.push(e.centery+e.radius*Math.sin((270-t)*Math.PI/180)+" A "),o.push(e.radius+" "+e.radius+" 0 "+(t<180?"1":"0")+" 0 "),o.push(e.centerx+e.radius*Math.cos(270*Math.PI/180)+" "),o.push(e.centery+e.radius*Math.sin(270*Math.PI/180)),null!=e.leftwrapper&&e.leftwrapper.setAttributeNS(null,"transform","rotate("+t+","+e.centerx+","+e.centery+")"),e.targetnode.setAttributeNS(null,"d",o.join(""))}function animateArc(e,t){var o={angle:e.start};TweenLite.to(o,t,{angle:e.end,onUpdate:function(){generateArc({targetnode:objArcProps.targetnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:null,angle:o.angle}),generateArc({targetnode:objArcProps.targetleftnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:objArcProps.targetleftwrapper,angle:360-o.angle})},onComplete:function(){objArcProps.anglestored=e.end}})}var objFooter={init:function(){}},objHeader={el:{backbutton:null,togglefavouritebutton:null,regionname:null,breadcrumb:null,breadcrumbmarquee:null,regionnamemarquee:null},state:{showbackbutton:!1,togglefavouritevisible:!1},hidebackbutton:function(){window.TweenLite.to(this.el.backbutton,.3,{display:"none",onComplete:function(){}})},showbackbutton:function(){this.state.showbackbutton&&window.TweenLite.to(this.el.backbutton,.3,{display:"block",onComplete:function(){}})},hidefavouritebutton:function(){window.TweenLite.to(this.el.togglefavouritebutton,.3,{display:"none",onComplete:function(){}})},showfavouritebutton:function(){var e=this;window.TweenLite.to(e.el.togglefavouritebutton,.3,{display:"block",onComplete:function(){window.objBookmarks.isfavourite()?e.el.togglefavouritebutton.className=e.el.togglefavouritebutton.className+" selected":e.el.togglefavouritebutton.className=e.el.togglefavouritebutton.className.replace(" selected","")}})},togglefavourite:function(e){var t="fav_"+window.objPageState.state.filter.orulevel+"_"+window.objPageState.state.filter.mru+"_"+window.objPageState.state.filter.oru,o="";if(window.objBookmarks.isfavourite())window.objStore.removelocalstorageitem(t),e.className=e.className.replace(" selected",""),o="remove favourite";else{var i={oru:window.objPageState.state.filter.orulevel,mru:window.objPageState.state.filter.mru,region_id:window.objPageState.state.filter.oru,region_name:window.objOruFilter.getregionnamebyid(window.objPageState.state.filter.oru),breadcrumb:window.objMruFilter.getmrufilterbreadcrumb()};window.objStore.setlocalstorageitem(t,JSON.stringify(i)),e.className=e.className+" selected",o="add favourite"}window.objAnalytics.data.events.push({category:"button",action:"click",label:o}),window.objBookmarks.renderfavouritepanel()},btnbackclick:function(){this.hidebackbutton(),this.hidefavouritebutton(),window.objHeader.setregionname(window.objMap.state.mapname),window.objPageState.updatepagestate({view:"worldmap",filter:{oru:"none"}})},setregionname:function(e){var t=this;if(void 0!==e)if(window.isPublicSite())for(var o=document.getElementsByClassName("region_info_title"),i=0;i<o.length;i++)o[i].innerHTML=e;else window.TweenLite.to(t.el.regionname,.3,{opacity:0,onComplete:function(){e!==window.objMap.state.mapname&&(e=window.objMap.state.mapname+" &bull; "+e),t.el.regionname.innerHTML=e,t.el.regionnamemarquee=new Marquee("region_name",{behavior:"scroll",direction:"rtl",interrupt:"no",step:.1}),t.el.regionname.scrollWidth>t.el.regionname.clientWidth||t.el.regionnamemarquee&&t.el.regionnamemarquee.pause(),window.TweenLite.to(t.el.regionname,.3,{opacity:1})}})},setbreadcrumb:function(e){var t=this;window.TweenLite.to(t.el.breadcrumb,.3,{opacity:0,onComplete:function(){t.el.breadcrumb.innerHTML=e,t.el.breadcrumbmarquee=new Marquee("filter_breadcrumb",{behavior:"scroll",direction:"rtl",interrupt:"no",step:.1}),t.el.breadcrumb.scrollWidth>t.el.breadcrumb.clientWidth||t.el.breadcrumbmarquee&&t.el.breadcrumbmarquee.pause(),window.TweenLite.to(t.el.breadcrumb,.3,{opacity:1})}})},init:function(){this.el.backbutton=window.getEl("btn_back"),this.el.togglefavouritebutton=window.getEl("toggle_favourite"),this.el.regionname=window.getEl("region_name"),this.el.breadcrumb=window.getEl("filter_breadcrumb"),this.state.showbackbutton=window.app.state.width<768}},objMap={state:{visible:null},el:{mapwrapper:null,elsvgholder:null,svgcontentwrapper:null},vars:{showdetailview:!1,regionidtoshow:null,zoomdelta:.3,nodataids:[]},data:null,maps:{world:{url:"jvector_world.svg"},region:{url:"philips_regions.svg"},market:{url:"philips_markets.svg"},country:{url:"jvector_countries.svg"}},getcolorforpercentage:function(e,t,o,i){var a=[{pct:1e-7,color:t},{pct:.5,color:o},{pct:1,color:i}],n=2,r=0;return(e/=100)<=.5?(n=1,e*=2):(r=1,n=2,e=2*(e-.5)),"rgb("+window.colourGradientor(e,[a[n].color.r,a[n].color.g,a[n].color.b],[a[r].color.r,a[r].color.g,a[r].color.b]).join(",")+")"},retrieveworldmapsvg:function(){window.objTouchVars.elanimate=null,this.state.mapname=window.objOruFilter.convertoruleveltomarket(window.objPageState.state.filter.orulevel);var e=window.objStore.getlocalstorageitem("map_"+this.state.mapname+"_v"+window.objConfig.localstorageversion),t=!0;if(e&&e.indexOf("<svg")>-1&&(t=!1),t){var o=[];return o.type="xml",o.file=this.maps[this.state.mapname.toLowerCase()].url,o.method="getsvgworldmap",o.fulldomain=location.protocol+"//"+location.hostname,o.token=window.objLogin.token,o.v=window.pageVars.version,"string"==typeof(e=(e=window.serverSideRequest({url:window.objConfig.urls.authurl2,formdata:o,method:"get",debug:!1})).replace(/fill:#00ffff/g,""))?(window.objStore.setlocalstorageitem("map_"+this.state.mapname+"_v"+window.objConfig.localstorageversion,e),e):""}return e.replace(/fill:#00ffff/g,"")},getworldmapdata:function(){var e,t=this;switch(window.objDataFilter.state.filter.datasource){case"lives_improved":case"":e={fulldomain:location.protocol+"//"+location.hostname,method:"getworldmapdata",type:"json",token:window.objLogin.token,oru:window.objPageState.state.filter.orulevel,mru:window.objPageState.state.filter.mru,snapshotid:window.objConfig.currentsnapshotid},window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,function(e,o){null!=e?window.objError.show("There was an error retrieving the worldmap data. "+("object"==typeof e?JSON.parse(e):e),!0):o.hasOwnProperty("authenticated")&&!o.authenticated?window.handleShibbolethLoginRequired():o.hasOwnProperty("error")?window.objError.show("There was an error retrieving the worldmap data. "+o.error.message,!0):t.postprocessworldmapdata(o)});break;case"sustainability":t.postprocessworldmapdata(window.objData.sustainability);break;case"global_presence":t.postprocessworldmapdata(window.objData.global_presence)}},createdatatypelistforregions:function(e){var t=[],o=[];return window.objOruFilter.retrieveoruarr(e).forEach(function(e){t=[],o=[];var i="philips_"+e.guid;if(window.objData.sustainability&&window.objData.sustainability.snapshotdata&&window.objConfig.datasources.indexOf("sustainability")>-1)for(var a in window.objData.sustainability.snapshotdata[i])window.objData.sustainability.snapshotdata[i].hasOwnProperty(a)&&t.push(a);if(window.objData.global_presence&&window.objData.global_presence.snapshotdata&&window.objConfig.datasources.indexOf("global_presence")>-1)for(var a in window.objData.global_presence.snapshotdata[i])window.objData.global_presence.snapshotdata[i].hasOwnProperty(a)&&o.push(a)}),{global_presence:o,sustainability:t}},postprocessworldmapdata:function(e){var t=this,o=window.rgbFromHex("#cae3e9"),i=window.rgbFromHex("#46b0a8");t.vars.nodataids.length=0,window.objLoading.show(),t.data=window.cloneObject(e.snapshotdata);var a=window.getEl("svgcontentwrapper"),n=window.getFirstLevelChildElements(a,"path");if(0===n.length&&(n=window.getFirstLevelChildElements(a,"g")),"lives_improved"===window.objDataFilter.state.filter.datasource)for(var r in t.data)"string"==typeof r&&(t.data[r].lprc=100*t.data[r].l/t.data[r].p);var l={},s={},d="philips_";window.objOruFilter.retrieveoruarr().forEach(function(e,o){if(0===o&&e.guid.indexOf("_")>-1&&(d=""),0===o)for(var i in t.data[d+e.guid])"string"==typeof i&&(s[i]={min:null,max:null});"object"==typeof t.data[d+e.guid]?l[d+e.guid]=t.data[d+e.guid]:e.guid});for(var r in l)if("string"==typeof r)for(var w in s)if("string"==typeof w){var u=parseFloat(l[r][w]);isNaN(u)||(null===s[w].min&&null===s[w].max?s[w].min=s[w].max=u:u<s[w].min?s[w].min=u:u>s[w].max&&(s[w].max=u))}var p=100,c=100;("1"===window.objPageState.state.filter.orulevel||"global_presence"!==window.objDataFilter.state.filter.datasource&&"sustainability"!==window.objDataFilter.state.filter.datasource||"all"===window.objDataFilter.state.filter.subtype)&&"lives_improved"!==window.objDataFilter.state.filter.datasource||("lives_improved"===window.objDataFilter.state.filter.datasource?(p=s.lprc.max,c=s.lprc.min):(p=s[window.objDataFilter.state.filter.subtype].max,c=s[window.objDataFilter.state.filter.subtype].min));var g="1"===window.objPageState.state.filter.orulevel||("global_presence"===window.objDataFilter.state.filter.datasource||"sustainability"===window.objDataFilter.state.filter.datasource)&&"all"===window.objDataFilter.state.filter.subtype,b=p===c?1:100/(p-c);window.objConfig.colors[window.objPageState.state.filter.sector].hasOwnProperty("rgb")||(window.objConfig.colors[window.objPageState.state.filter.sector].rgb={},window.objConfig.colors[window.objPageState.state.filter.sector].rgb.low=window.rgbFromHex(window.objConfig.colors[window.objPageState.state.filter.sector].low),window.objConfig.colors[window.objPageState.state.filter.sector].rgb.middle=window.rgbFromHex(window.objConfig.colors[window.objPageState.state.filter.sector].middle),window.objConfig.colors[window.objPageState.state.filter.sector].rgb.high=window.rgbFromHex(window.objConfig.colors[window.objPageState.state.filter.sector].high));for(var f=0;f<n.length;f++){var h=n[f],m="UK"===h.id?"GB":h.id,v=(r=window.objPageState.state.filter.mru+"_"+(4!==window.objPageState.state.filter.orulevel?m.toLowerCase():m),!!t.data[r]&&t.data[r]);if(v){var y,j=!1;if("lives_improved"===window.objDataFilter.state.filter.datasource)y=t.data[r].percentageLI=t.data[r].lprc,t.data[r].l<100&&(j=!0);else if("all"===window.objDataFilter.state.filter.subtype){var _=[];for(var S in v)if("string"==typeof S){u=parseFloat(v[S]);isNaN(u)?"-"===v[S]?_.push("no"):_.push("yes"):0===u?_.push("no"):_.push("yes")}j=-1===_.indexOf("yes")}else"-"!==(y=v[window.objDataFilter.state.filter.subtype])&&void 0!==y||(j=!0);var x="#000";if(j&&window.objConfig.hideinactivecountries)x=t.getcolorforpercentage(100,o,o,o);else if(g)x=t.getcolorforpercentage(100,i,i,i);else{var P=100;p>c&&(P=(y-c)*b),P>=100&&(P=100),P<0&&(P=0),x=t.getcolorforpercentage(P,window.objConfig.colors[window.objPageState.state.filter.sector].rgb.low,window.objConfig.colors[window.objPageState.state.filter.sector].rgb.middle,window.objConfig.colors[window.objPageState.state.filter.sector].rgb.high)}h.style.fill=x,window.toggleClass(h,"no-data",j);for(var C=h.getElementsByTagName("*"),k=0;k<C.length;k++)"path"!==C[k].nodeName&&"polygon"!==C[k].nodeName&&"rect"!==C[k].nodeName&&"g"!==C[k].nodeName&&"polyline"!==C[k].nodeName||(C[k].style.fill=x,window.toggleClass(C[k],"no-data",j));j&&t.vars.nodataids.push(m)}else h.style.fill=o}t.el.rootanimate=window.getEl("viewport"),t.el.rootsvg=window.getEl("holder_1000").getElementsByTagName("svg")[0],t.el.svgcontentwrapper=window.getEl("svgcontentwrapper"),t.state.rootanimateattributevalues=t.retrievesvgelementobject(t.el.rootanimate),window.objTouchSettings.debug=!1,window.objTouchSettings.debugtointerface=!1,window.objTouchSettings.debugtoconsole=!0,window.objZoomPanSettings.mobile=window.app.state.mobileortablet,window.objZoomPanSettings.clickcallback=function(e){var t=e.srcElement;void 0===t&&(t=e.originalTarget);var o=t.nodeName,i=t.id?t.id:"",a=t.parentNode,n=(a.nodeName,a.id?a.id:"");""===i&&(i=n),"path"!==o&&"g"!==o&&"polygon"!==o||window.countryClicked(i)},window.initSgvZoomPan(t.el.rootsvg,t.el.rootanimate),t.resizeworldmap(),t.moveworldmap((t.el.elsvgholder.clientWidth-t.el.rootanimate.getBBox().width)/2,0),window.objLoading.hide(),window.objHeader.setregionname(t.state.mapname),window.objHeader.setbreadcrumb(window.objMruFilter.getmrufilterbreadcrumb()),t.vars.showdetailview?t.detailspanel():window.objRegionInfo.hide(),t.vars.showdetailview=!1,t.el.elsvgholder.style.visibility="visible",window.objRegionInfo.showhidelegend(p,c),window.objOruFilter.rendermobilegeographylist()},updatemap:function(e,t){var o=this;o.vars.showdetailview="boolean"==typeof e&&e,o.el.elsvgholder.style.visibility="hidden";var i=o.retrieveworldmapsvg();null!=i&&("function"==typeof t&&t(),window.removeHandlers(function(){o.el.elsvgholder.innerHTML="",o.el.elsvgholder.innerHTML=i,o.getworldmapdata()}))},retrievesvgelementobject:function(e){window.objSvgElementProperties={},window.objSvgElementProperties.translatex=0,window.objSvgElementProperties.translatey=0,window.objSvgElementProperties.scale=1;var t=window.findPos(e.ownerSVGElement);window.objSvgElementProperties.x=t[0],window.objSvgElementProperties.y=t[1];for(var o,i=0,a=this.el.rootanimate.attributes,n=a.length;i<n;i++)(o=a.item(i)).nodeName,window.objSvgElementProperties[o.nodeName]=o.nodeValue;return window.objSvgElementProperties.transformmatrix=e.getCTM(),window.objSvgElementProperties.size=e.getBoundingClientRect(),window.objSvgElementProperties},resizeworldmap:function(){if(void 0!==this.el.rootsvg){var e=this.el.elsvgholder.clientHeight,t=this.el.elsvgholder.clientWidth;this.el.rootsvg.setAttributeNS(null,"viewBox","0 0 "+t+" "+e),this.el.rootsvg.setAttributeNS(null,"enable-background","new 0 0 "+t+" "+e),this.el.rootsvg.setAttributeNS(null,"width",t),this.el.rootsvg.setAttributeNS(null,"height",e)}},moveworldmap:function(e,t){if(null!=window.objTouchVars.elanimate){var o={gesture:{center:{pageX:0,pageY:0}},clientX:0,clientY:0,target:{tagName:"svg"}};window.handleClickTouchStart(o),window.objTouchVars.clickstart=!1,o={gesture:{center:{pageX:e,pageY:t}},clientX:e,clientY:t},window.handleDrag(o),window.handleClickTouchEnd(o)}},centerworldmap:function(e){window.svgSetTransform(e,{scale:this.state.rootanimateattributevalues.scale,translatex:0,translatey:0,transformmatrix:{}}),this.el.rootanimate.setAttributeNS(null,"transform",""),this.moveworldmap((this.el.elsvgholder.clientWidth-this.el.rootanimate.getBBox().width)/2,0),this.state.rootanimateattributevalues=this.retrievesvgelementobject(this.el.rootanimate)},maximizeworldmap:function(e){var t=1,o=0,i=0;window.app.state.width/window.app.state.height>=this.state.rootanimateattributevalues.size.width/this.state.rootanimateattributevalues.size.height?(t=window.app.state.height/this.state.rootanimateattributevalues.size.height,o=(window.app.state.width-this.state.rootanimateattributevalues.size.width*t)/2):(t=window.app.state.width/this.state.rootanimateattributevalues.size.width,i=(window.app.state.height-this.state.rootanimateattributevalues.size.height*t)/2),window.svgSetTransform(e,{scale:t,translatex:0,translatey:0,transformmatrix:{}}),this.moveworldmap(o,i),this.state.rootanimateattributevalues=this.retrievesvgelementobject(this.el.rootanimate)},hideselectedcountries:function(){Array.prototype.slice.call(objMap.el.elsvgholder.getElementsByClassName("active")).forEach(function(e){e.removeAttribute("class")})},zoom:function(e){var t=this.state.rootanimateattributevalues.scale,o=window.objTouchVars.elsvg.createSVGPoint();o.x=window.app.state.width/2,o.y=window.app.state.height/2-125,window.handleZoom(o,"in"===e?t+this.vars.zoomdelta:t-this.vars.zoomdelta),this.state.rootanimateattributevalues=this.retrievesvgelementobject(this.el.rootanimate)},detailspanel:function(){var e=this;window.objOruFilter.state.selectedoruguid=window.objPageState.state.filter.oru,window.objBookmarks.isfavourite()?window.getEl("toggle_favourite").className=window.getEl("toggle_favourite").className+" selected":window.getEl("toggle_favourite").className=window.getEl("toggle_favourite").className.replace(" selected",""),window.objHeader.showbackbutton(),window.objHeader.showfavouritebutton(),"lives_improved"===window.objPageState.state.filter.datasource&&window.objSliders.start(),window.app.setmainwrapperclass();var t=window.objPageState.state.filter.mru+"_"+(window.objPageState.state.filter.oru.length<4?window.objPageState.state.filter.oru:window.objPageState.state.filter.oru.toLowerCase()),o=e.data[t],i=window.getEl(window.objPageState.state.filter.oru);if(i){var a=i.getAttribute("class");"string"==typeof a&&"no-data"===a&&!1===window.app.state.mobile?window.objPageState.updatepagestate({view:"worldmap",filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype,oru:"none"}}):window.TweenLite.to(i,0,{opacity:.7,onComplete:function(){e.hideselectedcountries(),i.setAttribute("class","active"),window.app.state.width>768?e.updateui(o,window.objPageState.state.filter.oru,i):window.TweenLite.to(e.el.elsvgholder,.2,{opacity:0,onComplete:function(){e.updateui(o,window.objPageState.state.filter.oru,i)}})}})}else window.objPageState.state.filter.oru},updateui:function(e,t,o){if(this.setroundeddatainui(e),"lives_improved"===window.objDataFilter.state.filter.datasource){window.objRegionInfo.el.data.percentagelivesimproved.textContent=this.roundlivesimprovedpercentage(e.percentageLI)+"%";var i=window.getEl("lives_improved_icons");i.innerHTML="";for(var a=this.roundlivesimprovedpercentage(e.percentageLI),n=0;n<100;n++){var r=document.createElement("img");n<a?r.setAttribute("src","img/person-selected.png"):r.setAttribute("src","img/person.png"),i.appendChild(r)}var l=document.querySelectorAll(".lives_improved_icons");l.length>1&&(l[1].innerHTML=l[0].innerHTML)}window.objHeader.setregionname(window.objOruFilter.getregionnamebyid(t.length<4?t:t.toLowerCase())),window.objRegionInfo.show(),window.TweenLite.to(o,.3,{opacity:1,onComplete:function(){}})},setroundeddatainui:function(e){var t=this.roundlivesimproveddataobject(e),o=window.getEl("region_info_wrapper lives_improved"),i=window.getEl("region_info_wrapper global_presence"),a=window.getEl("region_info_wrapper sustainability");function n(o){return"-"===e[o]?e[o]:t[o]}if("lives_improved"===window.objPageState.state.filter.datasource)window.objRegionInfo.el.data.nrlivesimproved.textContent=t.displayl+" "+window.translateFragment("million"),window.objRegionInfo.el.data.labellivesimproved.textContent=window.translateFragment("lives_improved"),window.objRegionInfo.el.data.gdp.textContent=t.displayg+t.labelg,window.objRegionInfo.el.data.population.textContent=t.displayp+t.labelp,window.TweenLite.to(i,.3,{opacity:0,"z-index":-1,onComplete:function(){}}),window.TweenLite.to(a,.3,{opacity:0,"z-index":-2,onComplete:function(){}}),window.TweenLite.to(o,.3,{opacity:1,"z-index":1,onComplete:function(){}});else if("global_presence"===window.objPageState.state.filter.datasource)window.objRegionInfo.el.data.assets.textContent=n("value_assets"),window.objRegionInfo.el.data.employees.textContent=n("value_employees"),window.objRegionInfo.el.data.female.textContent=n("value_female"),window.objRegionInfo.el.data.male.textContent=n("value_male"),window.objRegionInfo.el.data.plants.textContent=n("value_plants"),window.objRegionInfo.el.data.research.textContent=n("value_research"),window.objRegionInfo.el.data.sales.textContent=n("value_sales"),window.TweenLite.to(i,.3,{opacity:1,"z-index":1,onComplete:function(){}}),window.TweenLite.to(a,.3,{opacity:0,"z-index":-1,onComplete:function(){}}),window.TweenLite.to(o,.3,{opacity:0,"z-index":-2,onComplete:function(){}});else if("sustainability"===window.objPageState.state.filter.datasource){try{window.objRegionInfo.el.data.co2.textContent=n("value_co2"),window.objRegionInfo.el.data.emission.textContent=n("value_emissions"),window.objRegionInfo.el.data.emissionhaz.textContent=n("value_emissionshaz"),window.objRegionInfo.el.data.trc.textContent=n("value_trc"),window.objRegionInfo.el.data.waste.textContent=n("value_waste"),window.objRegionInfo.el.data.wasterecycled.textContent=n("value_wasterecycled"),window.objRegionInfo.el.data.water.textContent=n("value_water")}catch(e){console.dir(e)}window.TweenLite.to(i,.3,{opacity:0,"z-index":-1,onComplete:function(){}}),window.TweenLite.to(a,.3,{opacity:1,"z-index":1,onComplete:function(){}}),window.TweenLite.to(o,.3,{opacity:0,"z-index":-2,onComplete:function(){}})}},roundlivesimproveddataobject:function(e){var t=0;if("lives_improved"===window.objPageState.state.filter.datasource)return e.l>=0&&(e.l>=1e9&&(e.roundedl=Math.round(e.l/1e6)),e.l>=1e8&&e.l<1e9&&(e.roundedl=Math.round(e.l/1e6*10)/10,t=1),e.l>=1e7&&e.l<1e8&&(e.roundedl=Math.round(e.l/1e6*100)/100,t=2,"3"===window.objPageState.state.filter.orulevel&&(t=1)),e.l<1e7&&(e.roundedl=Math.round(e.l/1e6*1e3)/1e3,t=3),e.displayl=window.formatMoney(e.roundedl,t,",",".",""),e.labell=""),e.g>=0&&(e.g>1?(e.roundedg=Math.round(e.g/1),t=0):(e.roundedg=Math.round(e.g/1*10)/10,t=1),e.displayg=window.formatMoney(e.roundedg,t,",",".",""),e.labelg=""),e.p>=0&&(e.p>1e6?(e.roundedp=Math.round(e.p/1e6),t=0):(e.roundedp=Math.round(e.p/1e6*10)/10,t=1),e.displayp=window.formatMoney(e.roundedp,t,",",".",""),e.labelp=""),e;var o=window.cloneObject(e);for(var i in o)if("string"==typeof i)switch(i){case"value_co2":case"value_emissions":case"value_emissionshaz":case"value_waste":case"value_wasterecycled":case"value_assets":case"value_employees":case"value_sales":o[i]=window.formatMoney(e[i],0,",",".","");break;case"value_water":var a=e[i]+"";a.indexOf(",")>-1&&(a=a.replace(/,/g,"")),o[i]=window.formatMoney(a,0,",",".","");break;default:o[i]=e[i]}return o},roundlivesimprovedpercentage:function(e){return e>100?100:e>=10&&e<100?Math.round(e):e<10&&e>.1?Math.round(10*e)/10:"< 0.1"},init:function(){this.state.visible=!1,this.el.elsvgholder=window.getEl("holder_1000")}},objOverlay={state:{visible:null,tweening:null},el:{wrapper:null,closebutton:null},show:function(e,t){var o=void 0!==t&&t;this.state.tweening=!0,this.el.wrapper.style.display="block",o&&!this.state.tweening?window.TweenLite.to(this.el.wrapper,.3,{opacity:.7,delay:0,onComplete:this.showcomplete(e)}):(this.el.wrapper.style.opacity=.7,this.showcomplete(e))},showcomplete:function(e){objOverlay.state.visible=!0,objOverlay.state.tweening=!1,void 0!==e&&"boolean"!=typeof e&&e()},hide:function(e,t){var o=void 0!==t&&t;this.state.tweening=!0,o&&!this.state.tweening?window.TweenLite.to(this.el.wrapper,.3,{opacity:0,delay:0,onComplete:this.hidecomplete(e)}):this.hidecomplete(e)},hidecomplete:function(e){objOverlay.el.wrapper.style.display="none",objOverlay.state.visible=!1,objOverlay.state.tweening=!1,void 0!==e&&"boolean"!=typeof e&&e()},btncloseclick:function(){window.objHeader.btnbackclick()},init:function(){this.state.tweening=!1,this.state.visible=!1,this.el.wrapper=window.getEl("overlay"),window.isPublicSite()&&(this.el.wrapper.closebutton=window.getEl("loader"),this.el.wrapper.setAttributeNS(null,"onclick","objOverlay.btncloseclick();"))}},objRegionInfo={state:{visible:null,tweening:null,panel:"current"},el:{wrapper:null,nrlivesimproved:null,labellivesimproved:null,percentagelivesimproved:null,population:null,gdp:null,legendmax:null,legendmin:null},show:function(){if(this.state.tweening=!0,window.isPublicSite()&&(window.objFilter.hide(),window.objOverlay.show()),!0===window.app.state.mobile){this.removemobileregioninfos();var e=window.Sizzle("[data-target="+window.objPageState.state.filter.oru+"]")[0];e.getAttribute("class").indexOf("no-data")>-1?(e.className="mapselector no-data selected",e.innerHTML=e.innerHTML+'<div class="no-data-text">'+window.translateFragment("no_data_available")+"</div>"):(e.className="mapselector selected",e.innerHTML=e.innerHTML+window.getEl(window.objDataFilter.state.filter.datasource).outerHTML),e.getElementsByClassName("region_info_wrapper").length>0&&e.getElementsByClassName("region_info_wrapper")[0].removeAttribute("style"),window.app.state.inframe&&window.messageIframeResizeToParent()}else window.TweenLite.to(this.el.regionpanel,.3,{bottom:"0%",opacity:1,onComplete:this.showcomplete(this.el.regionpanel,!0)})},showcomplete:function(e,t){var o=objRegionInfo;o.state.tweening=!1,o.state.visible=!0,t?window.TweenLite.to(o.el.toolspanel,.3,{bottom:"0%",opacity:0,"z-index":-1}):window.css(o.el.toolspanel,{bottom:"0%",opacity:0,"z-index":-1})},hide:function(){this.state.visible&&(this.state.tweening=!0,window.app.state.width>768?window.TweenLite.to(this.el.regionpanel,.3,{bottom:"0%",opacity:0,onComplete:this.hidecomplete(this.el.regionpanel,!0)}):window.TweenLite.to(this.el.regionpanel,.3,{bottom:"-86%",opacity:0,onComplete:this.hidecomplete(this.el.regionpanel,!0)})),window.objPageState.mobile&&this.removemobileregioninfos(),window.objHeader.hidefavouritebutton()},hidecomplete:function(e,t){var o=objRegionInfo;o.state.tweening=!1,o.state.visible=!1,window.isPublicSite()&&window.objOverlay.state.visible&&window.objOverlay.hide(),t?window.TweenLite.to(o.el.toolspanel,.3,{bottom:"0%",opacity:1,"z-index":3}):window.css(o.el.toolspanel,{bottom:"0%",opacity:1,"z-index":3})},renderLegend:function(e,t){this.el.legend__title.innerHTML="all"===window.objDataFilter.state.filter.subtype?window.translateFragment("lives_improved"):window.translateFragment(window.objDataFilter.mapdatatypekeys(window.objDataFilter.state.filter.subtype)),this.el.legend__subtitle&&(this.el.legend__subtitle.innerHTML=""),this.el.legend__top_value.innerHTML=window.translateFragment("high"),this.el.legend__low_value.innerHTML=window.translateFragment("low")},showhidelegend:function(e,t){"lives_improved"===window.objPageState.state.filter.datasource||"all"!==window.objPageState.state.filter.subtype||"sustainability"===window.objPageState.state.filter.datasource&&"all"===window.objPageState.state.filter.subtype&&"3"===window.objPageState.state.filter.orulevel?(window.objRegionInfo.renderLegend(e,t),window.css(window.objRegionInfo.el.legend,{opacity:1})):window.css(window.objRegionInfo.el.legend,{opacity:0})},setdetailspanel:function(e,t){for(var o=document.getElementById(e+"_details"),i=void 0===t?"flex":"all"===t?"flex":"none",a=o.getElementsByTagName("div"),n=0;n<a.length;n++)"nr_label"===a[n].getAttribute("class")&&(-1===window.objMap.datatypes[e].indexOf(a[n].id)?a[n].style.display="none":a[n].style.display=i);void 0!==t&&"all"!==t&&(document.getElementById(t).style.display="inline-block")},hidedetailspanel:function(){window.objHeader.setregionname(window.objMap.state.mapname),window.objOruFilter.state.selectedoruguid="none",window.objPageState.updatepagestate({view:"worldmap",filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype,oru:"none"}})},removemobileregioninfos:function(){for(var e=window.Sizzle("[data-target] > div"),t=0;t<e.length;t++)e[t].parentNode.className="mapselector"+(e[t].parentNode.getAttribute("class").indexOf("no-data")>-1?" no-data":""),e[t].parentNode.removeChild(e[t])},showhistory:function(){var e=this;window.TweenLite.to(e.el.history,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},hidehistory:function(){var e=this;window.TweenLite.to(e.el.history,.3,{opacity:0,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},init:function(){this.state.visible=!1,this.state.tweening=!1,this.el.wrapper=window.getEl("region_info_wrapper"),this.el.regionpanel=window.getEl("region_info"),this.el.toolspanel=window.getEl("map_tools"),this.el.legend=window.getEl("map_tools__legend"),this.el.legend__title=window.getEl("map_tools__legend__title"),this.el.legend__subtitle=window.getEl("map_tools__legend__subtitle"),this.el.legend__top_value=window.getEl("map_tools__legend__top_value"),this.el.legend__low_value=window.getEl("map_tools__legend__low_value"),this.el.data={},this.el.data.nrlivesimproved=window.getEl("nr_lives_improved"),this.el.data.labellivesimproved=window.getEl("nr_lives_improved_label"),this.el.data.percentagelivesimproved=window.getEl("lives_improved_percentage"),this.el.data.population=window.getEl("nr_population"),this.el.data.gdp=window.getEl("nr_gdp"),this.el.data.assets=window.getEl("nr_assets"),this.el.data.employees=window.getEl("nr_employees"),this.el.data.female=window.getEl("nr_female"),this.el.data.male=window.getEl("nr_male"),this.el.data.plants=window.getEl("nr_plants"),this.el.data.research=window.getEl("nr_research"),this.el.data.sales=window.getEl("nr_sales"),this.el.data.co2=window.getEl("nr_co2"),this.el.data.emission=window.getEl("nr_emission"),this.el.data.emissionhaz=window.getEl("nr_emissionhaz"),this.el.data.trc=window.getEl("nr_trc"),this.el.data.waste=window.getEl("nr_waste"),this.el.data.wasterecycled=window.getEl("nr_wasterecycled"),this.el.data.water=window.getEl("nr_water"),this.el.btnshowcurrent=window.getEl("show_current"),this.el.btnshowsimulation=window.getEl("show_simulation"),this.el.history=window.getEl("graph"),this.el.regioninfotitle=window.getEl("region_info_title"),window.objArcProps.targetnode=window.getEl("arc_path"),window.objArcProps.targetleftwrapper=window.getEl("arc_path_left_wrapper"),window.objArcProps.targetleftnode=window.getEl("arc_path_left")}},objSliders={state:{visible:null,tweening:null},el:{wrapper:null,innerwrapper:null,slidersales:null,slidergreensales:null},vars:{data:null,content:null,slidersalesvalue:0,slidergreensalesvalue:0,livesimprovedcurrent:0,simulatorsampling:!1,debug:!1,updatetrendgraph:!0,updatecurrent:!1,usebiliniarinterpolation:!0,debugstring:"",recalculatecounter:0,setupsimulator:!0},calculatefloorceil:function(e,t){var o=0,i=0,a=Math.round(e/t)*t;return e>=0?e%t>t/2?o=(i=a)-t:i=(o=a)+t:Math.abs(e%t)>t/2||e%t==0?i=(o=a)+t:o=(i=a)-t,{floor:o,ceil:i}},start:function(){var e={fulldomain:location.protocol+"//"+location.hostname,method:"getlivesimprovedcachedata",type:"json",oru:window.objPageState.state.filter.oru,mru:window.objPageState.state.filter.mru,snapshotid:window.objConfig.currentsnapshotid,token:window.objLogin.token};this.recalculatecounter=0,window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,this.getsimulatordatahandler)},getsimulatordatahandler:function(e,t){var o=objSliders;e?window.objError.handleError("objSliders.start",e):t.hasOwnProperty("authenticated")&&!t.authenticated?window.handleShibbolethLoginRequired():window.hasProperty(t,"error")?window.objError.show(t.error.message,!0):(o.vars.data=t,window.app.trendgraph.predictionlabel=o.vars.data.layout.simulatorlabel,window.app.trendgraph.predictiondate=o.vars.data.layout.simulatordate,window.app.trendgraph.stylecurrentline=o.vars.data.layout.simulatorstyle,o.setuphistorygraph())},setuphistorygraph:function(){var e,t=this.vars.data.historicaldata,o={points:[],ymin:null,ymax:null},i="",a=-1e12,n=1e12,r=/(\d{4})-(\d{2})-(\d{2})/;t.sort(function(e,t){return new Date(e.dateend)-new Date(t.dateend)});for(var l=0;l<t.length;l++){var s=t[l].l;if(-1===s&&(s=0),e=r.exec(t[l].dateend),o.points.push({value:window.objMap.roundlivesimproveddataobject({l:s,g:-1,p:-1}).displayl,label:t[l].name,dateend:t[l].dateend,utcend:Date.UTC(+e[1],+e[2]-1,+e[3])}),l===t.length-1){var d=new Date(t[l].dateend);""!==window.app.trendgraph.predictionlabel?window.app.trendgraph.predictionlabel:"Q4 "+(d.getMonth()+1===12?d.getFullYear()+1:d.getFullYear()),i=""!==window.app.trendgraph.predictiondate?window.app.trendgraph.predictiondate:(d.getMonth()+1===12?d.getFullYear()+1:d.getFullYear())+"-12-31",e=r.exec(i),Date.UTC(+e[1],+e[2]-1,+e[3])}s>a&&(a=s),s<n&&(n=s)}if(o.ymin=parseFloat(window.objMap.roundlivesimproveddataobject({l:n,g:-1,p:-1}).displayl.replace(/,/,"")),o.ymax=parseFloat(window.objMap.roundlivesimproveddataobject({l:a,g:-1,p:-1}).displayl.replace(/,/,"")),window.objTrendGraph.props.axis.ygridlines=3,o.ymax<.1&&(window.objTrendGraph.props.axis.ygridlines=null),null!=window.app.trendgraph.pointsvisible&&o.points.length>window.app.trendgraph.pointsvisible)for(l=0;l<o.points.length-window.app.trendgraph.pointsvisible+1;l++)o.points.shift();o.styles={},o.styles.stylecurrentline=window.app.trendgraph.stylecurrentline,window.objTrendGraph.props.line.lastsegment.class="lastsegment",window.objTrendGraph.props.line.lastpoint.id="lp",window.objTrendGraph.reset(),window.setTimeout(function(){window.objTrendGraph.redrawgraph()},1e3),window.objTrendGraph.drawgraph(o)},init:function(){this.state.visible=!1,this.state.tweening=!1}},objLogin={token:null,role:"",state:{visible:null,tweening:null,usernamedisabled:null,passworddisabled:null,authenticating:null,messages:[]},vars:{},el:{wrapper:null,submit:null},btnsubmitclick:function(){var e=window.objConfig.urls.hasOwnProperty("urlshiblogin")?window.objConfig.urls.urlshiblogin:"https://www.livesimproved.philips.com/tools/shibboleth-authenticate.aspx";location.href=e+"?rnd="+Math.random()},findlatestsnapshotid:function(e){window.objConfig.snapshots=e.snapshotconfig;var t=new Date("1970-01-01"),o="";if(null!=window.objConfig.snapshots)for(var i=0;i<window.objConfig.snapshots.length;i++){var a=window.objConfig.snapshots[i];new Date(a.dateend)-t>0&&(o=a.snapshotid,t=new Date(a.dateend))}window.objConfig.currentsnapshotid=o},getsnapshotconfig:function(){var e=this,t={type:"json",fulldomain:location.protocol+"//"+location.hostname,method:"getsnapshotdetailssimple",token:objLogin.token};window.psv("GET",window.objConfig.urls.authurl2,t,function(t,o){t||window.hasProperty(o,"error")?window.hasProperty(o,"error")?window.objError.show("There was an error retrieving snapshot information. "+("object"==typeof o?JSON.stringify(o):o),!0):window.objError.show("There was an error retrieving snapshot information. "+("object"==typeof t?JSON.stringify(t):t),!0):void 0===o||"string"==typeof o||null===o?(window.objError.show("There was an error retrieving snapshot information. No data was received...",!0),window.handleShibbolethLoginRequired()):o.hasOwnProperty("authenticated")&&!o.authenticated?window.handleShibbolethLoginRequired():(e.findlatestsnapshotid(o),e.checkappconfigforupdates(o),window.isPublicSite()?(objLogin.token=window.generateUniqueId().replace(/x/g,""),e.continueretrievemetadata()):e.checksession())})},checksession:function(){var e={fulldomain:location.protocol+"//"+location.hostname,method:"checksession",type:"json"};window.psv("GET",window.objConfig.urls.authurl2,e,function(e,t){e||window.hasProperty(t,"error")?window.hasProperty(t,"error")?window.objError.show("There was an error retrieving session information. "+("object"==typeof t?JSON.stringify(t):t),!0):window.objError.show("There was an error retrieving session information. "+("object"==typeof e?JSON.stringify(e):e),!0):t.authenticated?(objLogin.token=t.token,objLogin.continueretrievemetadata()):window.handleShibbolethLoginRequired()})},continueretrievemetadata:function(){window.isPublicSite()||(window.app.defaultpagestate.view="worldmap"),window.app.retrievemetadata()},checksnapshotconfigforupdates:function(e){var t=window.objStore.getlocalstorageitem("snapshotconfig"),o=e.snapshotconfig;if(t){t=JSON.parse(t).snapshotconfig;for(var i=0;i<o.length;i++){for(var a=!1,n=0;n<t.length;n++)if(o[i].snapshotid===t[n].snapshotid&&(a=!0,o[i].lastmodified!==t[n].lastmodified)){this.state.messages.push('There is updated data for "'+o[i].name+'".');break}a||this.state.messages.push('A new data set "'+o[i].name+'" has been added.')}}window.objStore.setlocalstorageitem("snapshotconfig",JSON.stringify(e))},checkappconfigforupdates:function(e){var t=window.objStore.getlocalstorageitem("appconfig"),o=e.appinfo,i="";window.app.state.mobileortablet?(i="<b>New release available</b><p>A new version ("+(window.app.state.ios?o.iosid:o.androidid)+") of the Lives Improved app is available.</p>",i+='<p>Please visit the <span class="mimiclink" onclick="loadUrlInBrowser(\'https://www.livesimproved.philips.com/download\', true)">Lives Improved website</span> to download and install this new version.</p>',i+="<p>Details:</p>",t&&(t=JSON.parse(t),window.app.state.ios?t.iosid!==o.iosid&&(this.state.messages.push(i),this.state.messages.push(o.iosdescription)):t.androidid!==o.androidid&&(this.state.messages.push(i),this.state.messages.push(o.andrioddescription)))):(i="<b>The Lives Improved website has updated</b>",i+="<p>Details:</p>",(t=t?JSON.parse(t):null)?t.iosid!==o.iosid&&(this.state.messages.push(i),this.state.messages.push(o.iosdescription)):(this.state.messages.push(i),this.state.messages.push(o.iosdescription))),window.objStore.setlocalstorageitem("appconfig",JSON.stringify(e.appinfo))},hide:function(){var e=this;e.state.tweening=!0,window.app.state.ios?(e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1):window.TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},show:function(){var e=this;window.objSliders.vars.simulatorsampling=!1,e.el.wrapper.style.display="block",e.state.tweening=!0,window.app.state.ios?(e.el.wrapper.style.opacity=1,e.state.tweening=!1,e.state.visible=!0,location.href=window.objConfig.urls.urlshiblogin+"?rnd="+Math.random()):window.TweenLite.to(e.el.wrapper,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0,location.href=window.objConfig.urls.urlshiblogin+"?rnd="+Math.random()}})},logout:function(){window.objStore.removelocalstorageitem("token"),window.objPageState.updatepagestate({view:"login"})},showupdatemessages:function(){if(window.getEl("messagelist").innerHTML="",this.state.messages.length>0){for(var e=0;e<this.state.messages.length;e++)window.getEl("messagelist").innerHTML+="<li>"+this.state.messages[e]+"</li>";this.state.messages=[],this.showmessages()}},hidemessages:function(){var e=this;e.state.tweening=!0,window.TweenLite.to(e.el.messagespanel,.3,{opacity:0,onComplete:function(){window.objOverlay.hide(),e.el.messagespanel.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},showmessages:function(){var e=this;window.objOverlay.show(),e.state.tweening=!0,e.el.messagespanel.style.display="block",window.TweenLite.to(e.el.messagespanel,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},init:function(){this.state.passworddisabled=!1,this.state.usernamedisabled=!1,this.state.authenticating=!1,this.el.wrapper=window.getEl("login_panel"),this.el.submit=window.getEl("btn_submit"),this.el.messagespanel=window.getEl("messages_panel"),this.token=window.objStore.getlocalstorageitem("token")}},objError={state:{visible:null,tweening:null},el:{wrapper:null,text:null},hide:function(){var e=this;e.el.wrapper.innerHTML="",e.state.tweening=!0,TweenLite.to(e.el.wrapper,.3,{height:0,onComplete:function(){e.state.tweening=!1,e.state.visible=!1}})},show:function(e,t){var o=this;o.el.wrapper.innerHTML=e,o.state.tweening=!0,TweenLite.to(o.el.wrapper,.3,{height:50,onComplete:function(){if(o.state.tweening=!1,o.state.visible=!0,t)setTimeout(function(){o.hide()},4e3)}})},handleError:function(e,t){objLoading.state.visible&&objLoading.hide(),objOverlay.state.visible&&objOverlay.hide(),t.message&&(t=t.message),t.line?this.show("JS Error: line="+t.line+", message="+t.message+", stack="+t.stack,!0):"string"==typeof t?"token mismatch"==t.toLowerCase()||"not authenticated"==t.toLowerCase()?objLogin.show():this.show(t,!0):this.show(JSON.stringify(t),!0)},init:function(){this.state.visible=!1,this.state.tweening=!1,this.el.wrapper=getEl("error")}},objFilter={state:{visible:null,tweening:null,currentfilterhtml:""},el:{wrapper:null,filtercontent:null},show:function(){this.state.currentfilterhtml=this.el.filtercontent.innerHTML,window.isPublicSite()||window.objOverlay.show(),this.state.tweening||(this.state.tweening=!0,this.el.wrapper.style.display="block",window.TweenLite.to(this.el.wrapper,.3,{opacity:1,onComplete:this.showcomplete})),window.objMruFilter.setmrufilterstate(),window.objOruFilter.setorufilterstate()},showcomplete:function(){objFilter.state.tweening=!1,objFilter.state.visible=!0},hide:function(){var e=this;e.state.tweening||(e.state.tweening=!0,window.TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){window.isPublicSite()||window.objOverlay.hide(),e.el.filtercontent.innerHTML=e.state.currentfilterhtml,e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1,e.el.btnapply.style.display="none"}}))},blink:function(){var e=this;window.isPublicSite()?e.blinkcomplete():window.TweenLite.to(e.el.filtercontent,.2,{opacity:.5,onComplete:function(){e.el.loader.style.display="block",window.TweenLite.to(e.el.filtercontent,.4,{opacity:1,onComplete:e.blinkcomplete})}})},blinkcomplete:function(){objFilter.el.loader.style.display="none",objFilter.el.btnapply.style.display="block"},applyfilter:function(e){window.isPublicSite()||!this.state.visible||this.state.tweening||this.hide();var t=window.objOruFilter.retrieveselectedorulevel();this.state.currentfilterhtml=this.el.filtercontent.innerHTML,this.el.btnapply.style.display="none";var o=window.objOruFilter.state.selectedoruguid;"boolean"==typeof e&&e&&(o="none");var i="worldmap";"none"===o&&"1"!==t||(i="detail");var a=window.objDataFilter.state.filter.subtype;t!==window.objPageState.state.filter.orulevel&&"all"!==window.objDataFilter.state.filter.subtype&&"lives_improved"!==window.objDataFilter.state.filter.datasource&&(-1===window.objMap.createdatatypelistforregions(t)[window.objDataFilter.state.filter.datasource].indexOf(a)&&(a="all"));t!==window.objPageState.state.filter.orulevel&&"1"===t&&(i="detail",o="world"),window.isPublicSite()?window.objPageState.updatepagestate({view:i,filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:a,orulevel:t,oru:o,sector:window.objMruFilter.state.selectedsector,mru:window.objMruFilter.state.selectedmru}}):window.objPageState.updatepagestate({view:"worldmap",filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype,orulevel:window.objOruFilter.retrieveselectedorulevel(),oru:"none",sector:window.objMruFilter.state.selectedsector,mru:window.objMruFilter.state.selectedmru}}),window.isPublicSite()||window.objRegionInfo.state.visible&&!window.objRegionInfo.state.tweening&&window.objRegionInfo.hide()},init:function(){this.state.visible=!1,this.state.tweening=!1,this.el.wrapper=window.getEl("filter_panel"),this.el.loader=window.getEl("filter_loader"),this.el.filtercontent=window.Sizzle("#filter_panel div.modal_content")[0],this.el.btnapply=window.getEl("btn_apply_filter"),this.el.btnapply.style.display="none",this.state.currentfilterhtml=this.el.filtercontent.innerHTML}},objBookmarks={state:{visible:null,tweening:null},el:{wrapper:null},isfavourite:function(){var e="fav_"+objPageState.state.filter.orulevel+"_"+objPageState.state.filter.mru+"_"+objPageState.state.filter.oru;return null!=objStore.getlocalstorageitem(e)},addbookmark:function(){},removefavourite:function(e,t){e.stopPropagation();var o=t.parentNode,i=o.getAttribute("data-key");return objStore.removelocalstorageitem("fav_"+i),TweenLite.to(o,.2,{left:"100%",delay:0,onComplete:function(){TweenLite.to(o,.3,{height:0,delay:0,onComplete:function(){return o.parentNode.removeChild(o),!1}})}}),!1},findfavourites:function(){var e=[];if(objStore.vars.uselocalstorage)for(var t=0;t<objStore.store.length;t++){var o=localStorage.key(t);o.indexOf("fav_")>-1&&e.push(objStore.store.getItem(o))}return e},renderfavouritepanel:function(){for(var e=this,t=e.findfavourites(),o=document.createElement("ul"),i=0;i<t.length;i++){var a=JSON.parse(t[i]),n=objMruFilter.getsectorfrombreadcrumb(a.breadcrumb),r=document.createElement("li");r.setAttribute("data-oru",a.oru),r.setAttribute("data-mru",a.mru),r.setAttribute("data-region",a.region_id),r.setAttribute("data-sector",n);var l=a.oru+"_"+a.mru+"_"+(4!=a.oru?a.region_id.toLowerCase():a.region_id);r.setAttribute("data-key",l),r.innerHTML='<div class="bookmark_color" style="background:'+objConfig.colors[n].middle+'"></div><h2>'+a.region_name+'</h2><span class="bookmark_sub">'+a.breadcrumb+'</span><div class="remove_bookmark" onclick="objBookmarks.removefavourite(event, this);return false;"></div>',r.onclick=function(){e.openfavourite(this.getAttribute("data-oru"),this.getAttribute("data-mru"),this.getAttribute("data-region"),this.getAttribute("data-sector"))},o.appendChild(r)}e.el.list.innerHTML="",0==t.length?e.el.list.innerHTML='<div style="padding: 10px">Use the heart icon to add your favourite combinations to this bookmark list.</div>':e.el.list.appendChild(o)},openfavourite:function(e,t,o,i){objOruFilter.state.selectedoru=e,objMruFilter.state.selectedmru=t,objMruFilter.state.selectedsector=i,objOruFilter.settocurrentoru(),objPageState.updatepagestate({view:"detail",filter:{orulevel:e,oru:o,sector:i,mru:t}}),this.hide()},show:function(){var e=this;objOverlay.show(),e.state.tweening=!0,e.el.wrapper.style.display="block",TweenLite.to(e.el.wrapper,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},hide:function(){var e=this;e.state.tweening=!0,TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){objOverlay.hide(),e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},init:function(){this.state.visible=!1,this.state.tweening=!1,this.el.wrapper=getEl("bookmarks_panel"),this.el.list=getEl("bookmarkslist"),this.renderfavouritepanel()}},objExplain={state:{visible:null,tweening:null,contentloaded:!1},el:{wrapper:null,content:null},show:function(){var e=this;objOverlay.show(),e.state.tweening=!0,e.el.wrapper.style.display="block",TweenLite.to(e.el.wrapper,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0,e.state.contentloaded||serverSideRequest({url:objConfig.urls.base+"/data/faq.html"+(location.href.indexOf("http")>-1?"?rnd="+window.pageVars.version:""),method:"get",debug:!1,callback:function(t,o){e.el.content.innerHTML=o,e.state.contentloaded=!0}})}})},hide:function(){var e=this;e.state.tweening=!0,TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){objOverlay.hide(),e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},showfaqcontent:function(e,t){for(var o=Sizzle("#explain_content div.selected"),i=0;i<o.length;i++)o[i].className=o[i].className.replace(" selected","");e.className+=" selected",getEl(t).className+=" selected"},init:function(){this.state.visible=!1,this.state.tweening=!1,this.el.wrapper=getEl("explain_panel"),this.el.content=getEl("explain_content")}},objTrendGraph={state:{valuepopupopen:!1,trendpopupflipped:!1},vars:{popuptrendwidth:0,popuptrendheight:0,popuptrendtextwrapperheight:0,popupvaluewidth:0,popupvalueheight:0,data:null,template:null,debug:window.objConfig.sitetype.indexOf("dev")>-1},el:{root:null,lastsegment:null,lastpoint:null,popuptrend:null,popuptrendbase:null,popuptrendnumber:null,popuptrendtextwrapper:null,popupvalue:null,popupvaluenumber:null},props:{width:640,height:300,padding:{top:60,bottom:40,left:45,right:45},axis:{ymin:4,ymax:15,ystep:2.5,ygridlines:null,ygridlinesfullwidth:!0,showxlines:!1,xlinelength:8,showylines:!1,ylinelength:8,ylabelinset:!0,xpaddingleft:35,xpaddingright:10,ypaddingtop:20,ypaddingbottom:20},labels:{x:{padding:{bottom:20}},y:{translate:{x:0,y:8}}},coordinatepoint:{radius:5},title:{text:"Trend"},line:{lastsegment:{id:"last_segment",class:"last"},lastpoint:{id:"last_point",class:"last"}}},decimalplaces:function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},correctlabeldecimals:function(e,t){var o=!1,i=0;3===arguments.length&&(o=arguments[2]),t=t.replace(/,/,""),e=e.replace(/,/,""),t.indexOf(".")>-1&&(i=t.split(".")[1].length);var a=window.formatMoney(parseFloat(e),i,",",".","");return o&&a.indexOf(".")>-1&&(a=parseFloat(a).toFixed(a.split(".")[1].length-1)),a},reset:function(){},getMinMax:function(){for(var e={min:1e18,max:0},t=0;t<this.vars.data.points.length;t++){var o=1*this.vars.data.points[t].value.replace(",","");o<e.min&&(e.min=o),o>e.max&&(e.max=o)}return e},createColumn:function(e,t,o,i){var a=document.createElement("div"),n=document.createElement("div"),r=document.createTextNode(e.value);n.classList.add("value"),n.appendChild(r),a.appendChild(n);var l=document.createElement("div");l.classList.add("point"),l=this.drawPoint(l,e,t,o,i),a.appendChild(l);var s=document.createElement("div"),d=document.createTextNode(e.label);return s.classList.add("period"),s.appendChild(d),a.appendChild(s),a},drawPoint:function(e,t,o,i,a){var n=a*(1*t.value.replace(",","")-o.min)/i,r=document.createElement("div");return r.classList.add("y"),r.setAttribute("style","bottom: "+(n+15)+"px"),e.appendChild(r),e},createLine:function(e,t,o,i,a){var n=Math.sqrt((e-o)*(e-o)+(t-i)*(t-i)),r="rotate("+-180*Math.atan2(i-t,o-e)/Math.PI+"deg)",l=document.createElement("div");l.classList.add("line");var s="bottom: "+t+"px; transform: "+r+"; width: "+n+"px;";l.setAttribute("style",s),a.appendChild(l)},drawgraph:function(e){void 0===e&&(e=this.vars.data),this.el.root.innerHTML="",e.points.sort(function(e,t){return e.utcend-t.utcend}),this.vars.data=e;var t=this.getMinMax(),o=this.el.root.getBoundingClientRect().height-120;o<0&&(o=125);for(var i=t.max-t.min,a=0;a<this.vars.data.points.length;a++){var n=this.createColumn(this.vars.data.points[a],t,i,o);this.el.root.appendChild(n)}var r=document.querySelectorAll(".y");for(a=0;a<r.length-1;a++)r[a].getBoundingClientRect(),r[a+1].getBoundingClientRect()},redrawgraph:function(){for(var e=document.querySelectorAll(".line"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);for(var o=document.querySelectorAll(".y"),i=0;i<o.length-1;i++){var a=o[i].getBoundingClientRect(),n=o[i+1].getBoundingClientRect();this.createLine(a.x+5,1*o[i].style.bottom.replace("px","")+5,n.x+5,1*o[i+1].style.bottom.replace("px","")+5,o[i].parentNode)}},init:function(){this.el.root=document.getElementById("graph")}},objLoading={state:{visible:null,tweening:null},vars:{animate:!1},el:{wrapper:null},show:function(e){var t=this;t.state.tweening=!0,t.el.wrapper&&(t.el.wrapper.style.display="block",(objOverlay.state.visible||0==objOverlay.state.visible&&1==objOverlay.state.tweening)&&0==objFilter.state.visible?objLoading.el.wrapper.style.background='url("./img/ajax-loader.gif") no-repeat':objLoading.el.wrapper.style.background='url("./img/ajax-loader_white.gif") no-repeat',app.state.ios?(t.el.wrapper.style.opacity=.7,t.state.visible=!0,t.state.tweening=!1,e&&e()):TweenLite.to(t.el.wrapper,.3,{opacity:.7,delay:0,onComplete:function(){t.state.visible=!0,t.state.tweening=!1,e&&e()}}))},hide:function(e){var t=this;t.state.tweening=!0,t.el.wrapper&&(app.state.ios?(t.el.wrapper.style.display="none",t.state.visible=!1,t.state.tweening=!1,e&&e()):TweenLite.to(t.el.wrapper,.3,{opacity:0,delay:0,onComplete:function(){t.el.wrapper.style.display="none",t.state.visible=!1,t.state.tweening=!1,e&&e()}}))},init:function(){this.state.tweening=!1,this.state.visible=!1,this.el.wrapper=getEl("loading")}},objPanelInfo={state:{visible:null,tweening:null,contentloaded:!1},el:{wrapper:null,content:null},show:function(e){var t=this;t.getcontent(e,function(){t.state.tweening=!0,t.el.wrapper.style.display="block",window.TweenLite.to(t.el.wrapper,.3,{opacity:1,onComplete:function(){t.state.tweening=!1,t.state.visible=!0}})})},hide:function(){var e=this;e.state.tweening=!0,window.TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},getcontent:function(e,t){var o=this,i=e+"_intro.html";window.serverSideRequest({url:window.objConfig.urls.base+"/data/"+i+(location.href.indexOf("http")>-1?"?v="+window.pageVars.version:""),method:"get",debug:!1,callback:function(i,a){o.el.contentwrapper.className=e,o.el.content.innerHTML=a,t()}})},removelocalstorageitems:function(){window.objStore.removelocalstorageitem("seenAppIntro"),window.objStore.removelocalstorageitem("seenFilterIntro"),window.objStore.removelocalstorageitem("seenRegionInfoIntro"),location.reload()},init:function(){this.state.visible=!1,this.state.tweening=!1,this.el.wrapper=window.getEl("panel_info_panel"),this.el.contentwrapper=window.getEl("content_wrapper"),this.el.content=window.getEl("panel_info_content")}},objMruFilter={state:{selectedmru:null,selectedsector:null,tweening:null},el:{mrufilter:null,tempmru:null},setmrufilterstate:function(){this.state.selectedmru=window.objPageState.state.filter.mru,this.state.selectedsector=this.getmrufilteraxisarray(window.objPageState.state.filter.mru)[0].id,this.showlevel(this.state.selectedsector,this.state.selectedmru,!1)},getsectoridfromfilterhtml:function(){},getmrufilteraxisarray:function(e){var t="#filter_container #"+e,o=window.Sizzle(t)[0],i=[];if(o&&o.firstElementChild)for(i.push({id:o.id,name:o.firstElementChild.innerHTML});null!=o.parentNode&&"filter_list"!==o.parentNode.className;)"li"===(o=o.parentNode).localName&&i.push({id:o.id,name:o.firstElementChild.innerHTML});else i.push({id:"philips",name:"Philips Group"});return i.reverse()},getsectorfrombreadcrumb:function(e){return e.indexOf("ealthcare")>-1?"PD0900":e.indexOf("ighting")>-1?"PD0100":e.indexOf("ifestyle")>-1||e.indexOf("ersonal")>-1?"PD0200":e.indexOf("onnected")>-1?"DHS003":e.indexOf("iagnosis")>-1?"DHS001":e.indexOf("oyal")>-1?"royalphilips":"philips"},getmrufilterbreadcrumb:function(){for(var e=this.getmrufilteraxisarray(window.objPageState.state.filter.mru),t=[],o=0;o<e.length;o++)t.push(e[o].name);return t.join(" &bull; ")},preparehtml:function(e){this.el.tempmru.innerHTML=e,this.el.mrufilter=window.getEl("filter_container"),this.el.mrufilter.innerHTML=e,this.state.selectedsector=window.app.defaultpagestate.filter.sector},selectmru:function(e,t,o){e&&e.stopPropagation(),this.showlevel(t,o)},showlevel:function(e,t){this.state.selectedmru=t,this.state.selectedsector=e;for(var o=window.getEl(t),i=o.parentNode,a=window.getFirstLevelChildElements(i,"li"),n=window.getEl("filter_container").getElementsByTagName("li"),r=0;r<n.length;r++)n[r].className="";for(var l=0;l<a.length;l++){var s=a[l];if(s!==o)for(var d=s.getElementsByTagName("ul"),w=0;w<d.length;w++)2===arguments.length?window.TweenLite.to(d[w],.2,{height:0}):d[w].style.height="0px"}if(o.className="selected",2===arguments.length)(p=window.getFirstLevelChildElements(o,"ul")).length>0&&window.TweenLite.to(p[0],.4,{height:"auto"});else{var u=this.getmrufilteraxisarray(window.objPageState.state.filter.mru);for(r=0;r<u.length;r++){var p;(p=window.getFirstLevelChildElements(window.getEl(u[r].id),"ul")).length>0&&(p[0].style.height="auto")}}window.objHeader.setbreadcrumb(objMruFilter.getmrufilterbreadcrumb()),2===arguments.length&&window.objFilter.blink(),window.isPublicSite()&&window.objFilter.applyfilter()},init:function(e){this.state.tweening=!1,this.state.selectedmru=window.app.defaultpagestate.filter.mru,this.state.selectedsector="philips",this.el.mrufilter=window.getEl("filter_container"),this.el.tempmru=window.getEl("producttree_temp")}},objOruFilter={json:null,listlevel1world:[],listlevel2region:[],listlevel3market:[],listlevel4country:[],state:{selectedoru:null,selectedoruguid:null},el:{mrufilter:null,wrapper:null},postprocessorudata:function(){if(this.listlevel1world.push({guid:objOruFilter.json.unit.guid,parent:void 0}),"object"==typeof objOruFilter.json.unit.subunits)for(var e in objOruFilter.json.unit.subunits)if("string"==typeof e&&(this.listlevel2region.push({guid:objOruFilter.json.unit.subunits[e].guid,parent:objOruFilter.json.unit.guid}),"object"==typeof objOruFilter.json.unit.subunits[e].subunits))for(var t in objOruFilter.json.unit.subunits[e].subunits)if("string"==typeof t&&(this.listlevel3market.push({guid:objOruFilter.json.unit.subunits[e].subunits[t].guid,parent:objOruFilter.json.unit.subunits[e].guid}),"object"==typeof objOruFilter.json.unit.subunits[e].subunits[t].subunits))for(var o in objOruFilter.json.unit.subunits[e].subunits[t].subunits)"string"==typeof o&&this.listlevel3market.push({guid:objOruFilter.json.unit.subunits[e].subunits[t].subunits[o].guid,parent:objOruFilter.json.unit.subunits[e].subunits[t].guid})},retrieveoruarr:function(e){var t=parseInt(void 0===e?window.objPageState.state.filter.orulevel:e,10);switch(t){case 1:return window.objOruFilter.listlevel1world;case 2:return window.objOruFilter.listlevel2region;case 3:return window.objOruFilter.listlevel3market;case 4:return window.objOruFilter.listlevel4country;default:return window.objError.show("Unexpected level was passed ("+t+").",!0),[]}},setorufilterstate:function(){this.state.selectedoru=window.objPageState.state.filter.orulevel;var e="btn_country";switch(window.objPageState.state.filter.orulevel){case"1":e="btn_world";break;case"2":e="btn_region";break;case"3":e="btn_bmc"}this.selectoru(window.getEl(e),window.objPageState.state.filter.orulevel,!1)},getregionnamebyid:function(e){var t=window.translateFragment(e);if(t.indexOf("[")>-1){var o=void 0;"cantral-east_europe"===e&&(o="central-east_europe"),"central-east_europe"===e&&(o="cantral-east_europe"),o&&(t=window.translateFragment(o))}return window.returnObj={},t},selectoru:function(e,t){this.el.wrapper=window.getEl("oru_filter_container"),e.className="selected",this.state.selectedoru=t,window.objHeader.setbreadcrumb(window.objMruFilter.getmrufilterbreadcrumb()),2===arguments.length&&window.objFilter.blink(),window.objFilter.applyfilter(!0)},retrieveselectedorulevel:function(){return objOruFilter.state.selectedoru=objOruFilter.el.orulevelselect.options[objOruFilter.el.orulevelselect.selectedIndex].value,objOruFilter.state.selectedoru},settocurrentoru:function(){for(var e=this.el.wrapper.getElementsByTagName("option"),t=0;t<e.length;t++)e[t].getAttribute("value")===window.objPageState.state.filter.orulevel?e[t].setAttribute("selected","selected"):e[t].removeAttribute("selected")},rendermobilegeographylist:function(){var e='<ul class="c-region-list">';this.retrieveoruarr().forEach(function(t){-1===window.objMap.vars.nodataids.indexOf(t.guid)?e+='<li class="mapselector" data-target="'+t.guid+'" onclick="countryClicked(\''+t.guid+"', true)\">"+window.translateFragment(t.guid)+"</li>":e+='<li class="mapselector no-data" data-target="'+t.guid+'" onclick="countryClicked(\''+t.guid+"', true)\">"+window.translateFragment(t.guid)+"</li>"}),e+="</ul>",window.getEl("regions").innerHTML=e,window.app.state.mobile&&window.app.state.inframe&&window.messageIframeResizeToParent()},setdatalevelattribute:function(e){window.getEl("body").setAttribute("data-orulevel","level"+(e||document.getElementsById("oru-select").selectedValue))},convertoruleveltomarket:function(e){switch(parseInt(e,10)){case 1:return"World";case 2:return"Region";case 3:return"Market";case 4:return"Country"}return""},init:function(e){this.state.selectedoru=window.app.defaultpagestate.filter.orulevel,this.el.wrapper=window.getEl("oru_filter_container"),this.el.orulevelselect=window.getEl("oru-select"),objOruFilter.setdatalevelattribute(1)}},objDataFilter={el:{wrapper:""},vars:{subclicked:!1,timerid:null},state:{filter:{datasource:"lives_improved",subtype:""},subtype:{}},init:function(){this.el.wrapper=window.getEl("map-tab_panels")},resetsubtypeindicators:function(e){for(var t=0;t<e.length;t++)e[t].innerText=window.translateFragment("all_data")},setactivetab:function(e){for(var t=objDataFilter.el.wrapper.getElementsByClassName("active-tab"),o=0;o<t.length;o++)t[o].removeAttribute("class");e.setAttribute("class","active-tab")},mapdatatypekeys:function(e){var t={value_co2:"c_o_2",value_fte:"number_of_employees",value_waste:"waste",value_water:"water",value_emissions:"emissions",value_emissionshaz:"emissionshaz",value_trc:"lwc_rate",value_wasterecycled:"recycled",value_sales:"number_sales",value_male:"percentage_male",value_female:"percentage_female",value_research:"r_and_d_centers",value_plants:"manufacturing_sites",value_assets:"number_assets",value_employees:"number_of_employees"};return t[e]?t[e]:e},renderdatasubtypefilters:function(){var e=this;if(window.objConfig.datasources.indexOf("sustainability")>-1){var t='<div class="bg"></div><ul><li class="datasubtype" data-subtype="all" onclick="objDataFilter.changesubtype(\'sustainability\', \'all\')">'+window.translateFragment("all_data")+"</li>";window.objMap.datatypes.sustainability.forEach(function(o){o.indexOf("value_")>-1&&(t+='<li class="datasubtype" data-subtype="'+o+"\" onclick=\"objDataFilter.changesubtype('sustainability', '"+o+"')\">"+window.translateFragment(e.mapdatatypekeys(o)).replace(/^(.*?)(\s*\(.*\))$/g,"$1")+"</li>")}),t+="</ul>",window.Sizzle("li[data-panel=sustainability] .datatype-filter")[0].innerHTML=t}if(window.objConfig.datasources.indexOf("global_presence")>-1){var o='<div class="bg"></div><ul><li class="datasubtype" data-subtype="all" onclick="objDataFilter.changesubtype(\'global_presence\', \'all\')">'+window.translateFragment("all_data")+"</li>";window.objMap.datatypes.global_presence.forEach(function(t){t.indexOf("value_")>-1&&(o+='<li class="datasubtype" data-subtype="'+t+"\" onclick=\"objDataFilter.changesubtype('global_presence', '"+t+"')\">"+window.translateFragment(e.mapdatatypekeys(t)).replace(/^(.*?)(\s*\(.*\))$/g,"$1")+"</li>")}),o+="</ul>",window.Sizzle("li[data-panel=global_presence] .datatype-filter")[0].innerHTML=o}},setdatasubtypefilter:function(e,t){for(var o=document.getElementsByClassName("datasubtype"),i=0;i<o.length;i++)o[i].setAttribute("class","datasubtype");var a=window.Sizzle("li[data-panel="+e+"] li[data-subtype="+t+"]");void 0!==a&&a[0].setAttribute("class","datasubtype active")},changedatasource:function(e){objDataFilter.vars.subclicked||(objDataFilter.state.filter.datasource=e,objDataFilter.state.filter.subtype="all",window.objFilter.applyfilter())},changesubtype:function(e,t){objDataFilter.vars.subclicked=!0,objDataFilter.state.filter.datasource=e,objDataFilter.state.filter.subtype=t,window.objFilter.applyfilter(),objDataFilter.vars.timerid=setTimeout(function(){objDataFilter.vars.subclicked=!1},50)},datasourcechanged:function(e){var t=window.Sizzle("li[data-panel="+e+"]")[0];objDataFilter.setactivetab(t),objDataFilter.resetsubtypeindicators(objDataFilter.el.wrapper.getElementsByClassName("subtypeindicator")),window.getEl("body").removeAttribute("data-subtype"),"lives_improved"!==e&&window.objRegionInfo.setdetailspanel(e,"all"),"lives_improved"!==e&&objDataFilter.setdatasubtypefilter(e,"all")},subtypechanged:function(e,t){var o=window.Sizzle("li[data-panel="+e+"] li[data-subtype="+t+"]")[0],i=window.Sizzle("li[data-panel="+e+"]")[0];objDataFilter.setactivetab(i),objDataFilter.resetsubtypeindicators(objDataFilter.el.wrapper.getElementsByClassName("subtypeindicator")),i.getElementsByClassName("subtypeindicator")[0].innerHTML=o.innerHTML,window.getEl("body").setAttribute("data-subtype",t),"lives_improved"!==e&&window.objRegionInfo.setdetailspanel(e,t),"lives_improved"!==e&&objDataFilter.setdatasubtypefilter(e,t)},renderdatalabel:function(e){var t=window.objConfig.datalabels[window.objConfig.siteid],o=window.objConfig.datalabels.q318;"lives_improved"===e?"future"===window.objConfig.datatype&&(t=o):"sustainability"===e&&"qr"===window.objConfig.pubtype&&("future"===window.objConfig.datatype&&(t=o),t+="_ht");var i=window.translateFragment(t);window.app.state.inframe&&window.setTimeout(function(){window.postMessageToParent({action:"setdatalabel",value:i})},100)}},app={state:{width:null,height:null,mobile:null,mobileortablet:null,ios:!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),ios7:!!navigator.userAgent.match(/OS 7_/g),ipad:!!navigator.userAgent.match(/(iPad)/g),orientation:"",ie:!!window.MSStream,webbrowser:location.href.indexOf("http")>-1,initialmapview:!0,inframe:top!==self},vars:{basehtml:null},defaultpagestate:{view:"detail",popup:"none",filter:{datasource:"lives_improved",subtype:"all",orulevel:"1",oru:"world",sector:"philips",mru:"philips"}},labels:{simulatortitle:" simulation"},trendgraph:{predictionlabel:"Q1 2014",predictiondate:"2014-03-31",pointsvisible:null,stylecurrentline:""},el:{outerwrapper:null},btnfilterclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"open filter panel"}),window.objFilter.show()},btnbookmarksclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"open bookmarks panel"}),window.objBookmarks.show()},btnexplainclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"open help panel"}),window.objExplain.show()},btnlogoutclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"logout"}),window.objLogin.logout()},showtransparentlayer:function(){window.getEl("transparentlayer").style.display="block"},hidetransparentlayer:function(){window.getEl("transparentlayer").style.display="none"},isMobile:{any:function(){return"none"===window.getComputedStyle(window.getEl("map"),null).display},mobileortablet:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}},setmainwrapperclass:function(){window.app.el.outerwrapper.className=window.objConfig.sitetype+" "+window.objPageState.state.filter.sector+" view-"+window.objPageState.state.view+" datasource-"+window.objPageState.state.filter.datasource+" subtype-"+window.objPageState.state.filter.subtype+" orulevel-"+window.objPageState.state.filter.orulevel+" oru-"+window.objPageState.state.filter.oru+" sector-"+window.objPageState.state.filter.sector+" mru-"+window.objPageState.state.filter.mru+" pubtype-"+window.objConfig.pubtype+" nrdatasources-"+window.objConfig.datasources.length},retrievemetadata:function(){var e={fulldomain:location.protocol+"//"+location.hostname,method:"getoruandproductdata",type:"json",token:window.objLogin.token,snapshotid:window.objConfig.currentsnapshotid};window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,app.retrievemetadatahandler)},retrievemetadatahandler:function(e,t){e||window.hasProperty(t,"error")?window.hasProperty(t,"error")?window.objError.show("There was an error retrieving metadata information. "+("object"==typeof t?JSON.stringify(t):t),!0):window.objError.show("There was an error retrieving metadata information. "+("object"==typeof e?JSON.stringify(e):e),!0):t.hasOwnProperty("authenticated")&&!t.authenticated?window.handleShibbolethLoginRequired():(window.objOruFilter.json=t.result.orudata,window.objOruFilter.postprocessorudata(),window.objMruFilter.preparehtml(t.result.productdata),window.objConfig.datasources.indexOf("sustainability")>-1?app.retrievesustainabilitydata():window.objConfig.datasources.indexOf("global_presence")>-1?app.retrieveglobalpresencedata():app.processinitialview(!0))},retrievesustainabilitydata:function(){var e={_type:"json",method:"getworldmapdata",token:window.objLogin.token,source:"sustainability",period:window.objConfig.datatype,pubtype:window.objConfig.pubtype};window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,function(e,t){null!=e?window.objError.show("There was an error retrieving the sustainability data. "+("object"==typeof e?JSON.parse(e):e),!0):(window.objData.sustainability=t,window.objConfig.datasources.indexOf("global_presence")>-1?app.retrieveglobalpresencedata():app.processinitialview(!0))})},retrieveglobalpresencedata:function(){var e={_type:"json",method:"getworldmapdata",token:window.objLogin.token,source:"global_presence",period:window.objConfig.datatype,pubtype:window.objConfig.pubtype};window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,function(e,t){null!=e?window.objError.show("There was an error retrieving the Global Presence data. "+("object"==typeof e?JSON.parse(e):e),!0):(window.objData.global_presence=t,app.processinitialview(!0))})},start:function(e){window.objLogin.hide(),window.objMap.updatemap(e,app.showappintromessage)},showappintromessage:function(){var e=window.objStore.getlocalstorageitem("seenAppIntro");window.isPublicSite()?window.objStore.setlocalstorageitem("seenAppIntro","true"):e&&app.state.mobile||!app.state.mobile?window.objLogin.showupdatemessages():(window.objPanelInfo.show("app"),window.objStore.setlocalstorageitem("seenAppIntro","true"))},getdimensions:function(){this.state.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.state.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.state.width>this.state.height?this.state.orientation="landscape":this.state.orientation="portrait"},processinitialview:function(e){var t=this;if(location.hash.length>0){var o=window.objPageState.hash2object(location.hash);o.hasOwnProperty("error")?location.hash=window.objPageState.object2hash(t.defaultpagestate):e?window.objPageState.handlechange(o):location.hash.indexOf("!/login/")>-1||(window.objStore.setlocalstorageitem("stateremembered",JSON.stringify(o)),o.view="login",location.hash=window.objPageState.object2hash(o))}else if(null!==window.objStore.getlocalstorageitem("stateremembered"))try{var i=JSON.parse(window.objStore.getlocalstorageitem("stateremembered"));window.objStore.removelocalstorageitem("stateremembered"),location.hash=window.objPageState.object2hash(i)}catch(e){window.objStore.removelocalstorageitem("stateremembered"),location.hash=window.objPageState.object2hash(t.defaultpagestate)}else location.hash=window.objPageState.object2hash(t.defaultpagestate)},initobjects:function(){this.getdimensions(),this.state.mobile=this.isMobile.any(),this.state.mobileortablet=this.isMobile.mobileortablet(),window.objStore.init(),window.objAnalytics.init(),window.objLogin.init(),window.objMap.init(),window.objFooter.init(),window.objHeader.init(),window.objOverlay.init(),window.objRegionInfo.init(),window.objSliders.init(),window.objError.init(),window.objFilter.init(),window.objBookmarks.init(),window.objExplain.init(),window.objTrendGraph.init(),window.objLoading.init(),window.objPanelInfo.init(),window.objOruFilter.init(),window.objMruFilter.init(),window.objDataFilter.init(),this.state.ios&&(window.objZoomPanSettings.dragtimerdelay=800,window.objZoomPanSettings.touchtimerdelay=300,this.state.ios7&&(window.getEl("title_bar").style.height="65px",window.getEl("info").style.top="10px",window.getEl("btn_back").style.top="10px",window.getEl("toggle_favourite").style.top="10px")),this.setmainwrapperclass(),app.state.inframe&&window.toggleClass(document.body,"inframe",!0);var e=window.translateFragment("wm_label_ar16"),t=parseInt(window.objConfig.siteid.replace(/^.*(\d\d)$/,"$1"),10);"qr"===window.objConfig.pubtype&&window.objConfig.siteid.indexOf("q1")>-1&&t--,e=e.replace("16",t),window.objConfig.siteid.indexOf("q2")>-1||window.objConfig.siteid.indexOf("q3")>-1?e=e.replace("full-year","the first half-year").replace("2017","2018"):window.objConfig.siteid.indexOf("q4")>-1&&(e=e.replace("full-year","the second half-year")),document.getElementById("sustainability_footnote").innerHTML=e,window.objLogin.getsnapshotconfig()},retrievetranslationfragments:function(e,t){if(e)window.objError.show(e,!0);else{window.app.vars.basehtml=t;var o=location.href.replace(/^(.*)index.*$/,"$1")+"data/locale-"+window.objConfig.lang+("en"===window.objConfig.lang?"_US":"_CN")+".json";(window.location.href.indexOf("results.philips.com")>-1||window.location.href.indexOf("resultshub.com")>-1)&&(o="/publications/"+(app.state.inframe?window.objConfig.siteid:"ar16")+"/data/locale-"+window.objConfig.lang+("en"===window.objConfig.lang?"_US":"_CN")+".json"),window.psv("GET",o,{v:window.pageVars.version},function(e,t){if(e)window.objError.show("There was an error retrieving translation fragments. "+("object"==typeof e?JSON.stringify(e):e),!0);else{for(var o in t)"string"==typeof o&&(window.objConfig.fragments[o]=t[o]);window.app.reworkbasehtml()}})}},reworkbasehtml:function(){window.app.vars.basehtml=window.app.vars.basehtml.replace(/\[([a-zA-Z\d\s_-]*?)\]/g,function(e,t,o,i){return window.translateFragment(t)}),app.el.outerwrapper.innerHTML=window.app.vars.basehtml;for(var e=document.getElementsByClassName("datafilter"),t=[],o=0;o<e.length;o++){var i=e[o].id.replace(/tab_/,"");-1===window.objConfig.datasources.indexOf(i)&&t.push(e[o].id)}t.forEach(function(e){document.getElementById(e).parentNode.removeChild(document.getElementById(e))}),window.app.initobjects()},init:function(){app.defaultpagestate.filter.datasource=window.objConfig.datasources[0],this.el.outerwrapper=window.getEl("content_outer_wrapper"),window.serverSideRequest({url:window.objConfig.urls.base+"/data/body_content.html?v="+window.pageVars.version,method:"get",debug:!1,callback:window.app.retrievetranslationfragments})}},regValid=/^#\!\/(login|worldmap|detail?)\/((\w|\d|-)+)\/((\w|\d|-)+)\/((\w|\d|-)+)\/((\w|\d|-)+)\/(filter|faq|help|bookmark|none?)\/((\w|\d|-)+)\/((\w|\d|-)+?)$/g,objPageState={state:{view:null,popup:null,filter:{datasource:null,subtype:null,orulevel:null,oru:null,sector:null,mru:null}},stateremembered:{},vars:{processed:0},clonestateobject:function(){return{view:this.state.view,popup:this.state.popup,filter:{orulevel:this.state.filter.orulevel,oru:this.state.filter.oru,sector:this.state.filter.sector,mru:this.state.filter.mru,datasource:objPageState.state.filter.datasource}}},setstateobject:function(e){e.hasOwnProperty("view")&&(this.state.view=e.view),e.hasOwnProperty("popup")&&(this.state.popup=e.popup),e.hasOwnProperty("filter")&&(e.filter.hasOwnProperty("orulevel")&&(this.state.filter.orulevel=e.filter.orulevel),e.filter.hasOwnProperty("oru")&&(this.state.filter.oru=e.filter.oru),e.filter.hasOwnProperty("sector")&&(this.state.filter.sector=e.filter.sector),e.filter.hasOwnProperty("mru")&&(this.state.filter.mru=e.filter.mru),e.filter.hasOwnProperty("datasource")&&(this.state.filter.datasource=e.filter.datasource),e.filter.hasOwnProperty("subtype")&&(this.state.filter.subtype=e.filter.subtype))},updatepagestate:function(e){var t=objPageState.clonestateobject();e.hasOwnProperty("view")&&(t.view=e.view),e.hasOwnProperty("popup")&&(t.popup=e.popup),e.hasOwnProperty("filter")&&(e.filter.hasOwnProperty("orulevel")&&(t.filter.orulevel=e.filter.orulevel),e.filter.hasOwnProperty("oru")&&(t.filter.oru=e.filter.oru),e.filter.hasOwnProperty("sector")&&(t.filter.sector=e.filter.sector),e.filter.hasOwnProperty("mru")&&(t.filter.mru=e.filter.mru),e.filter.hasOwnProperty("datasource")&&(t.filter.datasource=e.filter.datasource),e.filter.hasOwnProperty("subtype")&&(t.filter.subtype=e.filter.subtype)),location.hash=objPageState.object2hash(t),objPageState.vars.processed++},hash2object:function(e){return regValid.test(e)?{view:e.replace(regValid,"$1"),popup:e.replace(regValid,"$10"),filter:{orulevel:e.replace(regValid,"$2"),oru:e.replace(regValid,"$4"),sector:e.replace(regValid,"$6"),mru:e.replace(regValid,"$8"),datasource:e.replace(regValid,"$11"),subtype:e.replace(regValid,"$13")}}:{error:!0}},object2hash:function(e){return"#!/"+e.view+"/"+e.filter.orulevel+"/"+e.filter.oru+"/"+e.filter.sector+"/"+e.filter.mru+"/"+e.popup+"/"+e.filter.datasource+"/"+(e.filter.subtype?e.filter.subtype:"all")},calculatestatedelta:function(e,t){var o={filter:{}};for(var i in e)if("string"==typeof i&&t.hasOwnProperty(i))if("filter"===i){if(t.hasOwnProperty("filter"))for(var a in e.filter)"string"==typeof a&&t.filter.hasOwnProperty(a)&&e.filter[a]!==t.filter[a]&&(o.filter[a]=t.filter[a])}else e[i]!==t[i]&&(o[i]=t[i]);return o},handlechange:function(e){var t=this.calculatestatedelta(this.state,e);window.objAnalytics.data.views.push({page:location.hash.substr(2),title:location.hash.replace(regValid,function(){if("login"===e.view)return"/login";if(null==window.objOruFilter.json)return"/nothing";for(var t="/"+arguments[1]+"/"+window.objOruFilter.convertoruleveltomarket(arguments[2]).toLowerCase()+"/"+arguments[4]+"/",o=window.objMruFilter.getmrufilteraxisarray(arguments[8]),i=[],a=0;a<o.length;a++)i.push(o[a].name.toLowerCase().replace(/[\s]/gi,"_").replace(/&amp;/,"and"));return t+=i.join("/")+"/"+arguments[10]})});var o=!1,i=!1,a=!1,n=!1,r=!1,l=!1;if(this.state.filter.orulevel!==e.filter.orulevel&&(i=!0,o=!0),this.state.filter.oru!==e.filter.oru&&(a=!0,o=!0),this.state.filter.sector!==e.filter.sector&&(o=!0),this.state.filter.mru!==e.filter.mru&&(o=!0),this.state.filter.datasource!==e.filter.datasource&&(n=!0,o=!0,window.objDataFilter.state.filter.datasource=e.filter.datasource),this.state.filter.subtype!==e.filter.subtype&&(r=!0,o=!0,window.objDataFilter.state.filter.subtype=e.filter.subtype),"login"===this.state.view&&"login"!==e.view&&(l=!0),this.state.mobileortablet&&this.state.initialmapview&&l&&"login"!==e.view&&app.showtransparentlayer(),(i||n||r)&&(window.objMap.datatypes=window.objMap.createdatatypelistforregions(e.filter.orulevel),window.objDataFilter.renderdatasubtypefilters(),"all"!==e.filter.subtype?window.objDataFilter.subtypechanged(e.filter.datasource,e.filter.subtype):window.objDataFilter.datasourcechanged(e.filter.datasource),window.objDataFilter.renderdatalabel(e.filter.datasource)),a&&"lives_improved"!==e.filter.datasource&&window.objRegionInfo.setdetailspanel(e.filter.datasource,e.filter.subtype),this.state.view!==e.view)switch(e.view){case"login":this.stateremembered=this.clonestateobject(),this.setstateobject(e),window.objLogin.show();break;default:this.updateworldmapview(e,t)}else o&&this.updateworldmapview(e,t);window.objOruFilter.setdatalevelattribute(e.filter.orulevel),this.setstateobject(e),window.app.setmainwrapperclass()},updateworldmapview:function(e,t){this.setstateobject(e);var o=!1;t.hasOwnProperty("filter")&&(t.filter.hasOwnProperty("orulevel")||t.filter.hasOwnProperty("datasource")||t.filter.hasOwnProperty("sector"))&&(o=!0),"object"==typeof window.objMap.data&&!1===o?(t.hasOwnProperty("filter")&&t.filter.hasOwnProperty("subtype")&&window.objMap.updatemap("detail"===e.view,app.showappintromessage),"detail"===e.view?window.objMap.detailspanel():(window.objRegionInfo.hide(),window.objMap.hideselectedcountries(),window.objHeader.setregionname(window.objMap.state.mapname))):(window.objOruFilter.settocurrentoru(),"detail"===e.view?app.start(!0):app.start())},copyfilterattributes:function(e){self.state.filter.orulevel!==e.filter.orulevel&&(self.state.filter.orulevel=e.filter.orulevel),self.state.filter.oru!==e.filter.oru&&(self.state.filter.oru=e.filter.oru),self.state.filter.sector!==e.filter.sector&&(self.state.filter.sector=e.filter.sector),self.state.filter.mru!==e.filter.mru&&(self.state.filter.mru=e.filter.mru)},init:function(){}},objAnalytics={data:{views:[],events:[]},state:{enabled:-1===location.href.indexOf("www.results.philips.com")},asyncanalytics:function(){for(var e=0;e<this.data.views.length;e++)this.state.enabled&&window.ga("send","pageview",this.data.views[e]),e===this.data.views.length-1&&(this.data.views.length=0);for(e=0;e<this.data.events.length;e++){if(this.data.events[e].hasOwnProperty("category")&&this.data.events[e].hasOwnProperty("action"))switch(Object.keys(this.data.events[e]).length){case 2:this.state.enabled&&window.ga("send","event",this.data.events[e].category,this.data.events[e].action);break;case 3:this.data.events[e].hasOwnProperty("label")&&this.state.enabled&&window.ga("send","event",this.data.events[e].category,this.data.events[e].action,this.data.events[e].label);break;case 4:this.data.events[e].hasOwnProperty("label")&&this.data.events[e].hasOwnProperty("value")&&this.state.enabled&&window.ga("send","event",this.data.events[e].category,this.data.events[e].action,this.data.events[e].label,this.data.events[e].value)}e===this.data.events.length-1&&(this.data.events.length=0)}window.setTimeout(function(){objAnalytics.asyncanalytics()},500)},init:function(){var e,t,o,i,a,n;this.state.enabled&&(t=window,o=document,i=location.href.indexOf("http")>-1?"//www.google-analytics.com/analytics.js":"js/lib/analytics.js",t.GoogleAnalyticsObject="ga",t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,a=o.createElement("script"),n=o.getElementsByTagName("script")[0],a.async=1,a.src=i,n.parentNode.insertBefore(a,n),e=location.href.indexOf("http")>-1?"auto":{storage:"none",clientId:window.objStore.getlocalstorageitem("statguid")},window.ga("create","UA-52778332-1",e),window.ga("set","forceSSL",!0),window.ga("send","pageview",{page:"/start"+(location.href.indexOf("http")>-1?"/website":"/app")}),this.asyncanalytics())}};window.onresize=function(){app.getdimensions();try{app.isMobile.any()||(window.objMap.resizeworldmap(),window.objMap.centerworldmap(window.objMap.el.rootanimate)),window.objTrendGraph.redrawgraph()}catch(e){}},window.onhashchange=function(){var e=objPageState.hash2object(location.hash);e.hasOwnProperty("error")?location.hash=objPageState.object2hash(app.defaultpagestate):objPageState.handlechange(e)},window.objData={};