function reloadApp(){location.reload()}function getEl(e){return document.getElementById(e)||document.getElementsByClassName(e)[0]||document.getElementsByTagName(e)[0]||null}function findPos(e){var t=0,o=0;if(e.offsetParent)do{t+=e.offsetLeft,o+=e.offsetTop}while(e===e.offsetParent);return[t,o]}function logAction(e,t,o){}function lon2x(e){return 2.752*e+473.75}function lat2y(e){return-2.753*e+231}function collectionHas(e,t){for(var o=0,a=e.length;o<a;o++)if(e[o]===t)return!0;return!1}function getFirstLevelChildElements(e,t){for(var o=e.getElementsByTagName(t),a=[],i=0;i<o.length;i++)o[i].parentNode===e&&a.push(o[i]);return a}function findParentBySelector(e,t){for(var o=getEl(e),a=document.querySelectorAll(t),i=o.parentNode;i&&!collectionHas(a,i);)i=i.parentNode;return i}function getParamStringFromObject(e){var t=[];for(var o in e)"string"==typeof o&&t.push(o+"="+encodeURIComponent(e[o]));return t.join("&")}function containsClass(e,t){var o="string"==typeof e?e:e.getAttribute("class");return"string"==typeof o&&o.split(" ").indexOf(t)>-1}function toggleClass(e,t,o){var a=e.getAttribute("class");"boolean"==typeof o?o?"string"==typeof a?containsClass(a,t)||e.setAttribute("class",a+" "+t):e.setAttribute("class",t):"string"==typeof a&&containsClass(a,t)&&e.setAttribute("class",a.replace(new RegExp("\\b"+t+"\\b","g"),"")):("string"==typeof a&&(a=containsClass(e,t)?a.replace(new RegExp("\\b"+t+"\\b","g"),""):a+" "+t),e.setAttribute("class",a))}function svgSetTransform(e,t){"Infinity"===t.scale&&(t.scale=1);var o="matrix("+t.scale+",0,0,"+t.scale+","+t.translatex+","+t.translatey+")";e.setAttributeNS(null,"transform",o)}function svgRetrieveZoomLevel(e){if(!e)return 1;var t=parseFloat(e.getAttributeNS(null,"transform").replace(/.*bla\(\s*(\d[^\,]*).*/g,"$1"));return isNaN(t)?1:t}function getTransformedWidth(e,t){return t.getTransformToElement(e).a*t.cx.animVal.value}function rgbFromHex(e){function t(e){return"#"===e.charAt(0)?e.substring(1,7):e}return{r:function(e){return parseInt(t(e).substring(0,2),16)}(e),g:function(e){return parseInt(t(e).substring(2,4),16)}(e),b:function(e){return parseInt(t(e).substring(4,6),16)}(e)}}function colourGradientor(e,t,o){var a=(2*e-1+1)/2,i=1-a;return[parseInt(t[0]*a+o[0]*i,10),parseInt(t[1]*a+o[1]*i,10),parseInt(t[2]*a+o[2]*i,10)]}function encodeUrl(e){return escape(e).replace(/\+/g,"%2C").replace(/\"/g,"%22").replace(/\'/g,"%27").replace(/\//g,"%2F")}function generateUniqueId(){var e=Math.random();e=Math.round(1e4*e);var t=Math.random();return t=Math.round(1e4*e),e=e+"x"+(new Date).getSeconds()+"x"+t}function iterate(e,t,o){for(var a in e)if(e.hasOwnProperty(a))if("object"==typeof e[a])iterate(e[a],t,o);else if(e[a]===o&&a===t){returnObj=e,matchFound=!0;break}return returnObj}function handleShibbolethLoginRequired(e){null==window.objStore.getlocalstorageitem("stateremembered")&&(location.hash.indexOf("login/")>-1?window.objStore.setlocalstorageitem("stateremembered",JSON.stringify(window.app.defaultpagestate)):window.objStore.setlocalstorageitem("stateremembered",JSON.stringify(window.objPageState.hash2object(location.hash)))),e?e(null,{authenticated:!1}):window.objLogin.logout()}function psv(e,t,o,a){var i,n="",r=!1;"prod"===window.objConfig.sitetype&&(r=!1),window.objLoading.show(),(i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){if(4===this.readyState)if(200===this.status)if(window.objLoading.hide(),i.responseText.toLowerCase().indexOf('name="samlrequest"')>0)handleShibbolethLoginRequired(a);else if(r)try{(e=JSON.parse(i.responseText)).hasOwnProperty("error")&&("Not authenticated"===e.error.message||"Token mismatch"===e.error.message)?(window.objStore.setlocalstorageitem("reloadtime",(new Date).getTime()/1e3),window.objLogin.logout()):a(null,e)}catch(e){a(e)}else{var e=JSON.parse(i.responseText);e.hasOwnProperty("error")&&("Not authenticated"===e.error.message||"Token mismatch"===e.error.message)?window.objLogin.logout():a(null,e)}else a(i.statusText)},n=getParamStringFromObject(o),i.open(e,t+("GET"===e?"?"+n:""),!0),i.crossDomain=!0,i.withCredentials=!0,"POST"===e?(i.timeout=4e4,i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(n)):i.send()}function serverSideRequest(e){var t,o,a,i=!0,n=!1,r=!1,l=!1,s="",d="",w="post",u="",p=null;if(d=void 0!==e.url?e.url:"",p=void 0!==e.callback?e.callback:null,void 0!==e.bypasscache&&"true"===e.bypasscache&&(l=!0),w=void 0!==e.method?e.method.toLowerCase():"get","true"===(void 0!==e.debug?e.debug+"":"false").toLowerCase()&&(r=!0),"string"==typeof(u=void 0!==e.arrdata?e.arrdata:"")&&(u=void 0!==e.formdata?e.formdata:""),r&&(u.debug="true"),"string"!=typeof u&&(n=!0),null==p&&(i=!1),r&&alert("Parameters recieved:\nstrUrl="+d+"\ncallbackFunction="+p+"\nstrMethod="+w+"\narrFormData="+u+"\nbolSubmitFormData="+n+"\nbolAsync="+i),l&&("post"===w?d+=d.indexOf("?")>0?"&rnd="+generateUniqueId():"?rnd="+generateUniqueId():"string"!=typeof u?u.rnd=generateUniqueId():((u=new Array).rnd=generateUniqueId(),n=!0)),n){var c=new Array;for(t in u)"function"!=typeof u[t]&&"object"!=typeof u[t]&&(o=encodeUrl(u[t]),c.push(t+"="+o));s=c.join("&"),r&&alert("Form data sent to server:\n"+s)}var g=function(){try{return new XMLHttpRequest}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}}();g.onreadystatechange=i?function(){4===this.readyState&&(200===this.status?(a=g.responseText,r&&alert("just before callback function\n\n"+a),p(void 0,a)):(a="ERROR: There was a problem retrieving the server side data:\n"+g.statusText,p(a)))}:function(){},"get"===w.toLowerCase()&&s.length>0&&(d+="?"+s);try{g.open(w.toUpperCase(),d,i),n&&"post"===w.toLowerCase()?(g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(s)):g.send(null)}catch(e){if(!i)return null;p(JSON.stringify(e))}if(!i)return g.responseText}function countryClicked(e,t,o){var a=getEl(e);if(window.objPageState.mobile=!!t,window.objPageState.state.filter.oru!==e&&(!1===containsClass(a,"no-data")&&!1===window.objPageState.mobile||window.objPageState.mobile)){var i="detail",n=e;"string"==typeof o&&"worldmap"===o&&(i="worldmap",n="none"),window.objPageState.updatepagestate({view:i,filter:{oru:n,datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype}})}else window.objPageState.updatepagestate({view:"worldmap",filter:{oru:"none",datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype}})}function setNumberSeperators(e){var t="",o=new String(e),a=(o=o.split("."))[1]?o[1]:"";o=o[0].split("").reverse();for(var i=0;i<=o.length-1;i++)t=o[i]+t,(i+1)%3==0&&o.length-1!==i&&(t=","+t);return""!==a&&(t+=".",t+=a),t.indexOf(".")>-1&&t.split(".")[1].length<2&&(t+="0"),t}function formatFinancialData(e){return parseFloat(e)<0?"("+setNumberSeperators(0-parseFloat(e))+")":setNumberSeperators(e)}function formatMoney(e,t,o,a,i){if(void 0===e)return e;var t=isNaN(t=Math.abs(t))?2:t,a=void 0===a?".":a,o=void 0===o?",":o,i=void 0===i?"":i,n=e<0?"-":"",r=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",l=(l=r.length)>3?l%3:0;return n+i+(l?r.substr(0,l)+o:"")+r.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(t?a+Math.abs(e-r).toFixed(t).slice(2):"")}function loadUrlInBrowser(e){var t=!1;arguments.length>1&&(t=arguments[1]),window.objAnalytics.data.events.push({category:e.match(/^https?:\/\/.+\.(zip|dmg|txt|cfg|gz|pl|pdf)$/i)?"download":"link",action:"click",label:e}),window.app.state.webbrowser?t?window.open(e):location.href=e:t?window.open(e,"_system","location=no"):window.open(e,"_blank","location=no")}function hasProperty(e,t){return"object"==typeof e&&null!==e&&e.hasOwnProperty(t)}function isPublicSite(){return window.objConfig.sitetype.indexOf("public")>-1}function translateFragment(e){if(window.objConfig.fragments.hasOwnProperty(e)){var t=window.objConfig.fragments[e];return t.indexOf("CO2")>-1&&(t=t.replace(/^(.*CO)(\d)(.*)$/,"$1<sub>$2</sub>$3")),t.indexOf("m3")>-1&&(t=t.replace(/^(.*m)(\d)(.*)$/,"$1<sup>$2</sup>$3")),t}return"["+e+"]"}function cloneObject(e){try{return JSON.parse(JSON.stringify(e))}catch(e){return console.trace(),console.log("---------------")}}function css(e,t){for(var o in t)"string"==typeof o&&(e.style[o]=t[o])}function messageIframeResizeToParent(){window.setTimeout(function(){window.postMessageToParent({action:"adjustiframeheight",value:document.getElementsByTagName("body")[0].offsetHeight})},100)}function postMessageToParent(e){window.parent.postMessage("object"==typeof e?JSON.stringify(e):e,"*")}function renderInfographic(e){void 0===e.initial&&(e.initial=!0),void 0===e.setall&&(e.setall=!0),generateArc({targetnode:objArcProps.targetnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:null,angle:e.angle}),e.setall&&generateArc({targetnode:objArcProps.targetleftnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:objArcProps.targetleftwrapper,angle:360-e.angle}),e.initial&&(objArcProps.anglestored=e.angle)}function applyInfographicDelta(e){renderInfographic(e>=objArcProps.anglestored?{angle:e,initial:!1,setall:!0}:{angle:e,initial:!1,setall:!1})}function generateArc(e){var t=360-e.angle;t<=0&&(t=.1);var o=[];o.push("M "),o.push(e.centerx+e.radius*Math.cos((270-t)*Math.PI/180)+" "),o.push(e.centery+e.radius*Math.sin((270-t)*Math.PI/180)+" A "),o.push(e.radius+" "+e.radius+" 0 "+(t<180?"1":"0")+" 0 "),o.push(e.centerx+e.radius*Math.cos(270*Math.PI/180)+" "),o.push(e.centery+e.radius*Math.sin(270*Math.PI/180)),null!=e.leftwrapper&&e.leftwrapper.setAttributeNS(null,"transform","rotate("+t+","+e.centerx+","+e.centery+")"),e.targetnode.setAttributeNS(null,"d",o.join(""))}function animateArc(e,t){var o={angle:e.start};TweenLite.to(o,t,{angle:e.end,onUpdate:function(){generateArc({targetnode:objArcProps.targetnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:null,angle:o.angle}),generateArc({targetnode:objArcProps.targetleftnode,centerx:objArcProps.centerx,centery:objArcProps.centery,radius:objArcProps.radius,leftwrapper:objArcProps.targetleftwrapper,angle:360-o.angle})},onComplete:function(){objArcProps.anglestored=e.end}})}var objUtils={},matchFound=!1,returnObj={},objStore={vars:{uselocalstorage:!0},store:null,setlocalstorageitem:function(e,t){objStore.store.setItem(e,t)},getlocalstorageitem:function(e){return objStore.store.getItem(e)},removelocalstorageitem:function(e){objStore.store.removeItem(e)},init:function(){var e=this;try{var t="t_"+Date.now();localStorage.setItem(t,t);var o=localStorage.getItem(t);if(localStorage.removeItem(t),t!==o)throw new Error;objStore.store=window.localStorage}catch(t){e.vars.uselocalstorage=!1,objStore.store=new MemoryStorage}null==e.getlocalstorageitem("statguid")&&e.setlocalstorageitem("statguid","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}};!function(e,t,o){"function"==typeof define&&define.amd?define("memorystorage",[],function(){return o()}):"object"==typeof exports?module.exports=o():e.MemoryStorage=o()}(this,0,function(){"use strict";function e(i){function n(){return Object.keys(r).filter(function(e){return!(e in t)}).concat(Object.keys(l))}var r=a[i=i||"global"];if(r)return r;if(!(this instanceof e))return new e(i);r=a[i]=this;var l={};return Object.defineProperty(r,o,{enumerable:!1,configurable:!0,get:function(){return l}}),Object.defineProperty(r,"id",{enumerable:!0,configurable:!0,get:function(){return i}}),Object.defineProperty(r,"length",{enumerable:!0,configurable:!0,get:function(){return n().length}}),r.getItem=function(e){return e in t?this[o][e]:this[e]},r.setItem=function(e,a){e in t?this[o][e]=a:this[e]=a},r.removeItem=function(e){e in t?delete this[o][e]:delete this[e]},r.key=function(e){var t=n();return e>=0&&e<t.length?t[e]:null},r.clear=function(){for(var e=(Object.keys(this).filter(function(e){return!(e in t)})),a=0;i=e[a];a++)i in t||delete this[i];e=Object.keys(this[o]);for(var i,a=0;i=e[a];a++)delete this[o][i]},"undefined"==typeof Proxy?r:new Proxy(r,{ownKeys:function(){return n()}})}var t={clear:1,getItem:1,id:1,key:1,length:1,removeItem:1,setItem:1},o="__memorystorage_cloaked_items__",a={};return e});var objInfographic={},objArcProps={targetnode:null,targetleftwrapper:null,targetleftnode:null,centerx:150,centery:125,radius:100,angle:0,anglestored:0},objFooter={init:function(){}},objHeader={el:{backbutton:null,togglefavouritebutton:null,regionname:null,breadcrumb:null,breadcrumbmarquee:null,regionnamemarquee:null},state:{showbackbutton:!1,togglefavouritevisible:!1},hidebackbutton:function(){var e=this;window.TweenLite.to(e.el.backbutton,.3,{display:"none",onComplete:function(){}})},showbackbutton:function(){var e=this;e.state.showbackbutton&&window.TweenLite.to(e.el.backbutton,.3,{display:"block",onComplete:function(){}})},hidefavouritebutton:function(){var e=this;window.TweenLite.to(e.el.togglefavouritebutton,.3,{display:"none",onComplete:function(){}})},showfavouritebutton:function(){var e=this;window.TweenLite.to(e.el.togglefavouritebutton,.3,{display:"block",onComplete:function(){window.objBookmarks.isfavourite()?e.el.togglefavouritebutton.className=e.el.togglefavouritebutton.className+" selected":e.el.togglefavouritebutton.className=e.el.togglefavouritebutton.className.replace(" selected","")}})},togglefavourite:function(e){var t="fav_"+window.objPageState.state.filter.orulevel+"_"+window.objPageState.state.filter.mru+"_"+window.objPageState.state.filter.oru,o="";if(window.objBookmarks.isfavourite())window.objStore.removelocalstorageitem(t),e.className=e.className.replace(" selected",""),o="remove favourite";else{var a={oru:window.objPageState.state.filter.orulevel,mru:window.objPageState.state.filter.mru,region_id:window.objPageState.state.filter.oru,region_name:window.objOruFilter.getregionnamebyid(window.objPageState.state.filter.oru),breadcrumb:window.objMruFilter.getmrufilterbreadcrumb()};window.objStore.setlocalstorageitem(t,JSON.stringify(a)),e.className=e.className+" selected",o="add favourite"}window.objAnalytics.data.events.push({category:"button",action:"click",label:o}),window.objBookmarks.renderfavouritepanel()},btnbackclick:function(){var e=this;e.hidebackbutton(),e.hidefavouritebutton(),window.objHeader.setregionname(window.objMap.state.mapname),window.objPageState.updatepagestate({view:"worldmap",filter:{oru:"none"}})},setregionname:function(e){var t=this;if(void 0!==e)if(window.isPublicSite())for(var o=document.getElementsByClassName("region_info_title"),a=0;a<o.length;a++)o[a].innerHTML=e;else window.TweenLite.to(t.el.regionname,.3,{opacity:0,onComplete:function(){e!==window.objMap.state.mapname&&(e=window.objMap.state.mapname+" &bull; "+e),t.el.regionname.innerHTML=e,t.el.regionnamemarquee=new Marquee("region_name",{behavior:"scroll",direction:"rtl",interrupt:"no",step:.1}),t.el.regionname.scrollWidth>t.el.regionname.clientWidth||t.el.regionnamemarquee&&t.el.regionnamemarquee.pause(),window.TweenLite.to(t.el.regionname,.3,{opacity:1})}})},setbreadcrumb:function(e){var t=this;window.TweenLite.to(t.el.breadcrumb,.3,{opacity:0,onComplete:function(){t.el.breadcrumb.innerHTML=e,t.el.breadcrumbmarquee=new Marquee("filter_breadcrumb",{behavior:"scroll",direction:"rtl",interrupt:"no",step:.1}),t.el.breadcrumb.scrollWidth>t.el.breadcrumb.clientWidth||t.el.breadcrumbmarquee&&t.el.breadcrumbmarquee.pause(),window.TweenLite.to(t.el.breadcrumb,.3,{opacity:1})}})},init:function(){var e=this;e.el.backbutton=window.getEl("btn_back"),e.el.togglefavouritebutton=window.getEl("toggle_favourite"),e.el.regionname=window.getEl("region_name"),e.el.breadcrumb=window.getEl("filter_breadcrumb"),e.state.showbackbutton=window.app.state.width<768}},objMap={state:{visible:null},el:{mapwrapper:null,elsvgholder:null,svgcontentwrapper:null},vars:{showdetailview:!1,regionidtoshow:null,zoomdelta:.3,nodataids:[]},data:null,maps:{world:{url:"jvector_world.svg"},region:{url:"philips_regions.svg"},market:{url:"philips_markets.svg"},country:{url:"jvector_countries.svg"}},getcolorforpercentage:function(e,t,o,a){var i=[{pct:1e-7,color:t},{pct:.5,color:o},{pct:1,color:a}],n=2,r=0;return(e/=100)<=.5?(n=1,e*=2):(r=1,n=2,e=2*(e-.5)),"rgb("+window.colourGradientor(e,[i[n].color.r,i[n].color.g,i[n].color.b],[i[r].color.r,i[r].color.g,i[r].color.b]).join(",")+")"},retrieveworldmapsvg:function(){var e=this;window.objTouchVars.elanimate=null,e.state.mapname=window.objOruFilter.convertoruleveltomarket(window.objPageState.state.filter.orulevel);var t=window.objStore.getlocalstorageitem("map_"+e.state.mapname+"_v"+window.objConfig.localstorageversion),o=!0;if(t&&t.indexOf("<svg")>-1&&(o=!1),o){var a=[];return a.type="xml",a.file=e.maps[e.state.mapname.toLowerCase()].url,a.method="getsvgworldmap",a.fulldomain=location.protocol+"//"+location.hostname,a.token=window.objLogin.token,a.v=window.pageVars.version,t=window.serverSideRequest({url:window.objConfig.urls.authurl2,formdata:a,method:"get",debug:!1}),t=t.replace(/fill:#00ffff/g,""),"string"==typeof t?(window.objStore.setlocalstorageitem("map_"+e.state.mapname+"_v"+window.objConfig.localstorageversion,t),t):""}return t.replace(/fill:#00ffff/g,"")},getworldmapdata:function(){var e,t=this;switch(window.objDataFilter.state.filter.datasource){case"lives_improved":case"":e={fulldomain:location.protocol+"//"+location.hostname,method:"getworldmapdata",type:"json",token:window.objLogin.token,oru:window.objPageState.state.filter.orulevel,mru:window.objPageState.state.filter.mru,snapshotid:window.objConfig.currentsnapshotid},window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,function(e,o){null!=e?window.objError.show("There was an error retrieving the worldmap data. "+("object"==typeof e?JSON.parse(e):e),!0):o.hasOwnProperty("authenticated")&&!o.authenticated?window.handleShibbolethLoginRequired():o.hasOwnProperty("error")?window.objError.show("There was an error retrieving the worldmap data. "+o.error.message,!0):t.postprocessworldmapdata(o)});break;case"sustainability":t.postprocessworldmapdata(window.objData.sustainability);break;case"global_presence":t.postprocessworldmapdata(window.objData.global_presence)}},createdatatypelistforregions:function(e){var t=[],o=[];return window.objOruFilter.retrieveoruarr(e).forEach(function(e){t=[],o=[];var a="philips_"+e.guid;if(window.objData.sustainability&&window.objData.sustainability.snapshotdata&&window.objConfig.datasources.indexOf("sustainability")>-1)for(var i in window.objData.sustainability.snapshotdata[a])window.objData.sustainability.snapshotdata[a].hasOwnProperty(i)&&t.push(i);if(window.objData.global_presence&&window.objData.global_presence.snapshotdata&&window.objConfig.datasources.indexOf("global_presence")>-1)for(var i in window.objData.global_presence.snapshotdata[a])window.objData.global_presence.snapshotdata[a].hasOwnProperty(i)&&o.push(i)}),{global_presence:o,sustainability:t}},postprocessworldmapdata:function(e){var t=this,o=window.rgbFromHex("#cae3e9"),a=window.rgbFromHex("#46b0a8");t.vars.nodataids.length=0,window.objLoading.show(),t.data=window.cloneObject(e.snapshotdata);var i=window.getEl("svgcontentwrapper"),n=window.getFirstLevelChildElements(i,"path");if(0===n.length&&(n=window.getFirstLevelChildElements(i,"g")),"lives_improved"===window.objDataFilter.state.filter.datasource)for(var r in t.data)"string"==typeof r&&(t.data[r].lprc=100*t.data[r].l/t.data[r].p);var l={},s={},d="philips_";window.objOruFilter.retrieveoruarr().forEach(function(e,o){if(0===o&&e.guid.indexOf("_")>-1&&(d=""),0===o)for(var a in t.data[d+e.guid])"string"==typeof a&&(s[a]={min:null,max:null});"object"==typeof t.data[d+e.guid]?l[d+e.guid]=t.data[d+e.guid]:e.guid});for(var r in l)if("string"==typeof r)for(var w in s)if("string"==typeof w){S=parseFloat(l[r][w]);isNaN(S)||(null===s[w].min&&null===s[w].max?s[w].min=s[w].max=S:S<s[w].min?s[w].min=S:S>s[w].max&&(s[w].max=S))}var u=100,p=100;("1"===window.objPageState.state.filter.orulevel||"global_presence"!==window.objDataFilter.state.filter.datasource&&"sustainability"!==window.objDataFilter.state.filter.datasource||"all"===window.objDataFilter.state.filter.subtype)&&"lives_improved"!==window.objDataFilter.state.filter.datasource||("lives_improved"===window.objDataFilter.state.filter.datasource?(u=s.lprc.max,p=s.lprc.min):(u=s[window.objDataFilter.state.filter.subtype].max,p=s[window.objDataFilter.state.filter.subtype].min));var c="1"===window.objPageState.state.filter.orulevel||("global_presence"===window.objDataFilter.state.filter.datasource||"sustainability"===window.objDataFilter.state.filter.datasource)&&"all"===window.objDataFilter.state.filter.subtype,g=u===p?1:100/(u-p);window.objConfig.colors[window.objPageState.state.filter.sector].hasOwnProperty("rgb")||(window.objConfig.colors[window.objPageState.state.filter.sector].rgb={},window.objConfig.colors[window.objPageState.state.filter.sector].rgb.low=window.rgbFromHex(window.objConfig.colors[window.objPageState.state.filter.sector].low),window.objConfig.colors[window.objPageState.state.filter.sector].rgb.middle=window.rgbFromHex(window.objConfig.colors[window.objPageState.state.filter.sector].middle),window.objConfig.colors[window.objPageState.state.filter.sector].rgb.high=window.rgbFromHex(window.objConfig.colors[window.objPageState.state.filter.sector].high));for(var b=0;b<n.length;b++){var f=n[b],m="UK"===f.id?"GB":f.id,r=window.objPageState.state.filter.mru+"_"+(4!==window.objPageState.state.filter.orulevel?m.toLowerCase():m),v=!!t.data[r]&&t.data[r];if(v){var h,y=!1;if("lives_improved"===window.objDataFilter.state.filter.datasource)h=t.data[r].percentageLI=t.data[r].lprc,t.data[r].l<100&&(y=!0);else if("all"===window.objDataFilter.state.filter.subtype){var j=[];for(var _ in v)if("string"==typeof _){var S=parseFloat(v[_]);isNaN(S)&&"-"===v[_]?j.push("no"):j.push("yes")}y=-1===j.indexOf("yes")}else"-"===(h=v[window.objDataFilter.state.filter.subtype])&&(y=!0);var P="#000";if(y&&window.objConfig.hideinactivecountries)P=t.getcolorforpercentage(100,o,o,o);else if(c)P=t.getcolorforpercentage(100,a,a,a);else{var x=100;u>p&&(x=(h-p)*g),x>=100&&(x=100),x<0&&(x=0),P=t.getcolorforpercentage(x,window.objConfig.colors[window.objPageState.state.filter.sector].rgb.low,window.objConfig.colors[window.objPageState.state.filter.sector].rgb.middle,window.objConfig.colors[window.objPageState.state.filter.sector].rgb.high)}f.style.fill=P,window.toggleClass(f,"no-data",y);for(var C=f.getElementsByTagName("*"),O=0;O<C.length;O++)"path"!==C[O].nodeName&&"polygon"!==C[O].nodeName&&"rect"!==C[O].nodeName&&"g"!==C[O].nodeName&&"polyline"!==C[O].nodeName||(C[O].style.fill=P,window.toggleClass(C[O],"no-data",y));y&&t.vars.nodataids.push(m)}else f.style.fill=o}t.el.rootanimate=window.getEl("viewport"),t.el.rootsvg=window.getEl("holder_1000").getElementsByTagName("svg")[0],t.el.svgcontentwrapper=window.getEl("svgcontentwrapper"),t.state.rootanimateattributevalues=t.retrievesvgelementobject(t.el.rootanimate),window.objTouchSettings.debug=!1,window.objTouchSettings.debugtointerface=!1,window.objTouchSettings.debugtoconsole=!0,window.objZoomPanSettings.mobile=window.app.state.mobileortablet,window.objZoomPanSettings.clickcallback=function(e){var t=e.srcElement;void 0===t&&(t=e.originalTarget);var o=t.nodeName,a=t.id?t.id:"",i=t.parentNode,n=(i.nodeName,i.id?i.id:"");""===a&&(a=n),"path"!==o&&"g"!==o&&"polygon"!==o||window.countryClicked(a)},window.initSgvZoomPan(t.el.rootsvg,t.el.rootanimate),t.resizeworldmap(),t.moveworldmap((t.el.elsvgholder.clientWidth-t.el.rootanimate.getBBox().width)/2,0),window.objLoading.hide(),window.objHeader.setregionname(t.state.mapname),window.objHeader.setbreadcrumb(window.objMruFilter.getmrufilterbreadcrumb()),t.vars.showdetailview?t.detailspanel():window.objRegionInfo.hide(),t.vars.showdetailview=!1,t.el.elsvgholder.style.visibility="visible",window.objRegionInfo.showhidelegend(u,p),window.objOruFilter.rendermobilegeographylist()},updatemap:function(e,t){var o=this;o.vars.showdetailview="boolean"==typeof e&&e,o.el.elsvgholder.style.visibility="hidden";var a=o.retrieveworldmapsvg();null!=a&&("function"==typeof t&&t(),window.removeHandlers(function(){o.el.elsvgholder.innerHTML="",o.el.elsvgholder.innerHTML=a,o.getworldmapdata()}))},retrievesvgelementobject:function(e){var t=this;window.objSvgElementProperties={},window.objSvgElementProperties.translatex=0,window.objSvgElementProperties.translatey=0,window.objSvgElementProperties.scale=1;var o=window.findPos(e.ownerSVGElement);window.objSvgElementProperties.x=o[0],window.objSvgElementProperties.y=o[1];for(var a,i=0,n=t.el.rootanimate.attributes,r=n.length;i<r;i++)(a=n.item(i)).nodeName,window.objSvgElementProperties[a.nodeName]=a.nodeValue;return window.objSvgElementProperties.transformmatrix=e.getCTM(),window.objSvgElementProperties.size=e.getBoundingClientRect(),window.objSvgElementProperties},resizeworldmap:function(){var e=this;if(void 0!==e.el.rootsvg){var t=e.el.elsvgholder.clientHeight,o=e.el.elsvgholder.clientWidth;e.el.rootsvg.setAttributeNS(null,"viewBox","0 0 "+o+" "+t),e.el.rootsvg.setAttributeNS(null,"enable-background","new 0 0 "+o+" "+t),e.el.rootsvg.setAttributeNS(null,"width",o),e.el.rootsvg.setAttributeNS(null,"height",t)}},moveworldmap:function(e,t){if(null!=window.objTouchVars.elanimate){var o={gesture:{center:{pageX:0,pageY:0}},clientX:0,clientY:0,target:{tagName:"svg"}};window.handleClickTouchStart(o),window.objTouchVars.clickstart=!1,o={gesture:{center:{pageX:e,pageY:t}},clientX:e,clientY:t},window.handleDrag(o),window.handleClickTouchEnd(o)}},centerworldmap:function(e){var t=this;window.svgSetTransform(e,{scale:t.state.rootanimateattributevalues.scale,translatex:0,translatey:0,transformmatrix:{}}),t.el.rootanimate.setAttributeNS(null,"transform",""),t.moveworldmap((t.el.elsvgholder.clientWidth-t.el.rootanimate.getBBox().width)/2,0),t.state.rootanimateattributevalues=t.retrievesvgelementobject(t.el.rootanimate)},maximizeworldmap:function(e){var t=this,o=1,a=0,i=0;window.app.state.width/window.app.state.height>=t.state.rootanimateattributevalues.size.width/t.state.rootanimateattributevalues.size.height?(o=window.app.state.height/t.state.rootanimateattributevalues.size.height,a=(window.app.state.width-t.state.rootanimateattributevalues.size.width*o)/2):(o=window.app.state.width/t.state.rootanimateattributevalues.size.width,i=(window.app.state.height-t.state.rootanimateattributevalues.size.height*o)/2),window.svgSetTransform(e,{scale:o,translatex:0,translatey:0,transformmatrix:{}}),t.moveworldmap(a,i),t.state.rootanimateattributevalues=t.retrievesvgelementobject(t.el.rootanimate)},hideselectedcountries:function(){Array.prototype.slice.call(objMap.el.elsvgholder.getElementsByClassName("active")).forEach(function(e){e.removeAttribute("class")})},zoom:function(e){var t=this,o=t.state.rootanimateattributevalues.scale,a=window.objTouchVars.elsvg.createSVGPoint();a.x=window.app.state.width/2,a.y=window.app.state.height/2-125,window.handleZoom(a,"in"===e?o+t.vars.zoomdelta:o-t.vars.zoomdelta),t.state.rootanimateattributevalues=t.retrievesvgelementobject(t.el.rootanimate)},detailspanel:function(){var e=this;window.objOruFilter.state.selectedoruguid=window.objPageState.state.filter.oru,window.objBookmarks.isfavourite()?window.getEl("toggle_favourite").className=window.getEl("toggle_favourite").className+" selected":window.getEl("toggle_favourite").className=window.getEl("toggle_favourite").className.replace(" selected",""),window.objHeader.showbackbutton(),window.objHeader.showfavouritebutton(),window.objSliders.start(),window.app.setmainwrapperclass();var t=window.objPageState.state.filter.mru+"_"+(window.objPageState.state.filter.oru.length<4?window.objPageState.state.filter.oru:window.objPageState.state.filter.oru.toLowerCase()),o=e.data[t],a=window.getEl(window.objPageState.state.filter.oru);if(a){var i=a.getAttribute("class");"string"==typeof i&&"no-data"===i&&!1===window.app.state.mobile?window.objPageState.updatepagestate({view:"worldmap",filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype,oru:"none"}}):window.TweenLite.to(a,0,{opacity:.7,onComplete:function(){e.hideselectedcountries(),a.setAttribute("class","active"),window.app.state.width>768?e.updateui(o,window.objPageState.state.filter.oru,a):window.TweenLite.to(e.el.elsvgholder,.2,{opacity:0,onComplete:function(){e.updateui(o,window.objPageState.state.filter.oru,a)}})}})}else window.objPageState.state.filter.oru},updateui:function(e,t,o){var a=this;if(a.setroundeddatainui(e),"lives_improved"===window.objDataFilter.state.filter.datasource){window.objRegionInfo.el.data.percentagelivesimproved.textContent=a.roundlivesimprovedpercentage(e.percentageLI)+"%";var i=window.getEl("lives_improved_icons");i.innerHTML="";for(var n=0;n<100;n++){var r=document.createElement("img");n<e.percentageLI?r.setAttribute("src","img/person-selected.png"):r.setAttribute("src","img/person.png"),i.appendChild(r)}}window.objHeader.setregionname(window.objOruFilter.getregionnamebyid(t.length<4?t:t.toLowerCase())),window.objRegionInfo.show(),window.TweenLite.to(o,.3,{opacity:1,onComplete:function(){}})},setroundeddatainui:function(e){function t(t){return"-"===e[t]?e[t]:o[t]}var o=this.roundlivesimproveddataobject(e);JSON.stringify(e),JSON.stringify(o);var a=window.getEl("region_info_wrapper lives_improved"),i=window.getEl("region_info_wrapper global_presence"),n=window.getEl("region_info_wrapper sustainability");if("lives_improved"===window.objPageState.state.filter.datasource)window.objRegionInfo.el.data.nrlivesimproved.textContent=o.displayl+" "+window.translateFragment("million"),window.objRegionInfo.el.data.labellivesimproved.textContent=window.translateFragment("lives_improved"),window.objRegionInfo.el.data.gdp.textContent=o.displayg+o.labelg,window.objRegionInfo.el.data.population.textContent=o.displayp+o.labelp,window.TweenLite.to(i,.3,{opacity:0,"z-index":-1,onComplete:function(){}}),window.TweenLite.to(n,.3,{opacity:0,"z-index":-2,onComplete:function(){}}),window.TweenLite.to(a,.3,{opacity:1,"z-index":1,onComplete:function(){}});else if("global_presence"===window.objPageState.state.filter.datasource)window.objRegionInfo.el.data.assets.textContent=t("value_assets"),window.objRegionInfo.el.data.employees.textContent=t("value_employees"),window.objRegionInfo.el.data.female.textContent=t("value_female"),window.objRegionInfo.el.data.male.textContent=t("value_male"),window.objRegionInfo.el.data.plants.textContent=t("value_plants"),window.objRegionInfo.el.data.research.textContent=t("value_research"),window.objRegionInfo.el.data.sales.textContent=t("value_sales"),window.TweenLite.to(i,.3,{opacity:1,"z-index":1,onComplete:function(){}}),window.TweenLite.to(n,.3,{opacity:0,"z-index":-1,onComplete:function(){}}),window.TweenLite.to(a,.3,{opacity:0,"z-index":-2,onComplete:function(){}});else if("sustainability"===window.objPageState.state.filter.datasource){try{window.objRegionInfo.el.data.co2.textContent=t("value_co2"),window.objRegionInfo.el.data.emission.textContent=t("value_emissions"),window.objRegionInfo.el.data.emissionhaz.textContent=t("value_emissionshaz"),window.objRegionInfo.el.data.trc.textContent=t("value_trc"),window.objRegionInfo.el.data.waste.textContent=t("value_waste"),window.objRegionInfo.el.data.wasterecycled.textContent=t("value_wasterecycled"),window.objRegionInfo.el.data.water.textContent=t("value_water")}catch(e){console.dir(e)}window.TweenLite.to(i,.3,{opacity:0,"z-index":-1,onComplete:function(){}}),window.TweenLite.to(n,.3,{opacity:1,"z-index":1,onComplete:function(){}}),window.TweenLite.to(a,.3,{opacity:0,"z-index":-2,onComplete:function(){}})}},roundlivesimproveddataobject:function(e){var t=0;if("lives_improved"===window.objPageState.state.filter.datasource)return e.l>=0&&(e.l>=1e9&&(e.roundedl=Math.round(e.l/1e6)),e.l>=1e8&&e.l<1e9&&(e.roundedl=Math.round(e.l/1e6*10)/10,t=1),e.l>=1e7&&e.l<1e8&&(e.roundedl=Math.round(e.l/1e6*100)/100,t=2,"3"===window.objPageState.state.filter.orulevel&&(t=1)),e.l<1e7&&(e.roundedl=Math.round(e.l/1e6*1e3)/1e3,t=3),e.displayl=window.formatMoney(e.roundedl,t,",",".",""),e.labell=""),e.g>=0&&(e.g>1?(e.roundedg=Math.round(e.g/1),t=0):(e.roundedg=Math.round(e.g/1*10)/10,t=1),e.displayg=window.formatMoney(e.roundedg,t,",",".",""),e.labelg=""),e.p>=0&&(e.p>1e6?(e.roundedp=Math.round(e.p/1e6),t=0):(e.roundedp=Math.round(e.p/1e6*10)/10,t=1),e.displayp=window.formatMoney(e.roundedp,t,",",".",""),e.labelp=""),e;var o=window.cloneObject(e);for(var a in o)if("string"==typeof a)switch(a){case"value_co2":case"value_emissions":case"value_emissionshaz":case"value_waste":case"value_wasterecycled":case"value_assets":case"value_employees":case"value_sales":o[a]=window.formatMoney(e[a],0,",",".","");break;case"value_water":var i=e[a]+"";i.indexOf(",")>-1&&(i=i.replace(/,/g,"")),o[a]=window.formatMoney(i,0,",",".","");break;default:o[a]=e[a]}return o},roundlivesimprovedpercentage:function(e){return e>100?100:e>=10&&e<100?Math.round(e):e<10&&e>.1?Math.round(10*e)/10:"< 0.1"},init:function(){var e=this;e.state.visible=!1,e.el.elsvgholder=window.getEl("holder_1000")}},objOverlay={state:{visible:null,tweening:null},el:{wrapper:null,closebutton:null},show:function(e,t){var o=this,a=void 0!==t&&t;o.state.tweening=!0,o.el.wrapper.style.display="block",a&&!o.state.tweening?window.TweenLite.to(o.el.wrapper,.3,{opacity:.7,delay:0,onComplete:o.showcomplete(e)}):(o.el.wrapper.style.opacity=.7,o.showcomplete(e))},showcomplete:function(e){objOverlay.state.visible=!0,objOverlay.state.tweening=!1,void 0!==e&&"boolean"!=typeof e&&e()},hide:function(e,t){var o=this,a=void 0!==t&&t;o.state.tweening=!0,a&&!o.state.tweening?window.TweenLite.to(o.el.wrapper,.3,{opacity:0,delay:0,onComplete:o.hidecomplete(e)}):o.hidecomplete(e)},hidecomplete:function(e){objOverlay.el.wrapper.style.display="none",objOverlay.state.visible=!1,objOverlay.state.tweening=!1,void 0!==e&&"boolean"!=typeof e&&e()},btncloseclick:function(){window.objHeader.btnbackclick()},init:function(){var e=this;e.state.tweening=!1,e.state.visible=!1,e.el.wrapper=window.getEl("overlay"),window.isPublicSite()&&(e.el.wrapper.closebutton=window.getEl("loader"),e.el.wrapper.setAttributeNS(null,"onclick","objOverlay.btncloseclick();"))}},objRegionInfo={state:{visible:null,tweening:null,panel:"current"},el:{wrapper:null,nrlivesimproved:null,labellivesimproved:null,percentagelivesimproved:null,population:null,gdp:null,legendmax:null,legendmin:null},show:function(){var e=this;if(e.state.tweening=!0,window.isPublicSite()&&(window.objFilter.hide(),window.objOverlay.show()),!0===window.app.state.mobile){e.removemobileregioninfos();var t=window.Sizzle("[data-target="+window.objPageState.state.filter.oru+"]")[0];t.getAttribute("class").indexOf("no-data")>-1?(t.className="mapselector no-data selected",t.innerHTML=t.innerHTML+'<div class="no-data-text">'+window.translateFragment("no_data_available")+"</div>"):(t.className="mapselector selected",t.innerHTML=t.innerHTML+window.getEl(window.objDataFilter.state.filter.datasource).outerHTML),t.getElementsByClassName("region_info_wrapper").length>0&&t.getElementsByClassName("region_info_wrapper")[0].removeAttribute("style"),window.app.state.inframe&&window.messageIframeResizeToParent()}else window.TweenLite.to(e.el.regionpanel,.3,{bottom:"0%",opacity:1,onComplete:e.showcomplete(e.el.regionpanel,!0)})},showcomplete:function(e,t){var o=objRegionInfo;o.state.tweening=!1,o.state.visible=!0},hide:function(){var e=this;e.state.visible&&(e.state.tweening=!0,window.app.state.width>768?window.TweenLite.to(e.el.regionpanel,.3,{bottom:"0%",opacity:0,onComplete:e.hidecomplete(e.el.regionpanel,!0)}):window.TweenLite.to(e.el.regionpanel,.3,{bottom:"-86%",opacity:0,onComplete:e.hidecomplete(e.el.regionpanel,!0)})),window.objPageState.mobile&&e.removemobileregioninfos(),window.objHeader.hidefavouritebutton()},hidecomplete:function(e,t){var o=objRegionInfo;o.state.tweening=!1,o.state.visible=!1,window.isPublicSite()&&window.objOverlay.state.visible&&window.objOverlay.hide()},renderLegend:function(e,t){var o=this;if(o.el.legend__title.innerHTML="all"===window.objDataFilter.state.filter.subtype?window.translateFragment("lives_improved"):window.translateFragment(window.objDataFilter.mapdatatypekeys(window.objDataFilter.state.filter.subtype)),o.el.legend__subtitle.innerHTML="",void 0===e||void 0===t||e===t)o.el.legend__top_value.innerHTML=window.translateFragment("high"),o.el.legend__low_value.innerHTML=window.translateFragment("low");else{var a=0,i=0;switch(window.objPageState.state.filter.datasource){case"lives_improved":a=window.objMap.roundlivesimprovedpercentage(e),i=window.objMap.roundlivesimprovedpercentage(t);break;default:var n={};n[window.objPageState.state.filter.subtype]=e,a=window.objMap.roundlivesimproveddataobject(n)[window.objPageState.state.filter.subtype],n[window.objPageState.state.filter.subtype]=t,i=window.objMap.roundlivesimproveddataobject(n)[window.objPageState.state.filter.subtype]}o.el.legend__top_value.innerHTML=a,o.el.legend__low_value.innerHTML=i}},showhidelegend:function(e,t){"lives_improved"===window.objPageState.state.filter.datasource||"all"!==window.objPageState.state.filter.subtype||"sustainability"===window.objPageState.state.filter.datasource&&"all"===window.objPageState.state.filter.subtype&&"3"===window.objPageState.state.filter.orulevel?(window.objRegionInfo.renderLegend(e,t),window.css(window.objRegionInfo.el.legend,{opacity:1})):window.css(window.objRegionInfo.el.legend,{opacity:0})},setdetailspanel:function(e,t){for(var o=document.getElementById(e+"_details"),a=void 0===t?"block":"all"===t?"block":"none",i=o.getElementsByTagName("div"),n=0;n<i.length;n++)"nr_label"===i[n].getAttribute("class")&&(-1===window.objMap.datatypes[e].indexOf(i[n].id)?i[n].style.display="none":i[n].style.display=a);void 0!==t&&"all"!==t&&(document.getElementById(t).style.display="block")},hidedetailspanel:function(){window.objHeader.setregionname(window.objMap.state.mapname),window.objOruFilter.state.selectedoruguid="none",window.objPageState.updatepagestate({view:"worldmap",filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype,oru:"none"}})},removemobileregioninfos:function(){for(var e=window.Sizzle("[data-target] > div"),t=0;t<e.length;t++)e[t].parentNode.className="mapselector"+(e[t].parentNode.getAttribute("class").indexOf("no-data")>-1?" no-data":""),e[t].parentNode.removeChild(e[t])},showhistory:function(){var e=this;window.TweenLite.to(e.el.history,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},hidehistory:function(){var e=this;window.TweenLite.to(e.el.history,.3,{opacity:0,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},init:function(){var e=this;e.state.visible=!1,e.state.tweening=!1,e.el.wrapper=window.getEl("region_info_wrapper"),e.el.regionpanel=window.getEl("region_info"),e.el.toolspanel=window.getEl("map_tools"),e.el.legend=window.getEl("map_tools__legend"),e.el.legend__title=window.getEl("map_tools__legend__title"),e.el.legend__subtitle=window.getEl("map_tools__legend__subtitle"),e.el.legend__top_value=window.getEl("map_tools__legend__top_value"),e.el.legend__low_value=window.getEl("map_tools__legend__low_value"),e.el.data={},e.el.data.nrlivesimproved=window.getEl("nr_lives_improved"),e.el.data.labellivesimproved=window.getEl("nr_lives_improved_label"),e.el.data.percentagelivesimproved=window.getEl("lives_improved_percentage"),e.el.data.population=window.getEl("nr_population"),e.el.data.gdp=window.getEl("nr_gdp"),e.el.data.assets=window.getEl("nr_assets"),e.el.data.employees=window.getEl("nr_employees"),e.el.data.female=window.getEl("nr_female"),e.el.data.male=window.getEl("nr_male"),e.el.data.plants=window.getEl("nr_plants"),e.el.data.research=window.getEl("nr_research"),e.el.data.sales=window.getEl("nr_sales"),e.el.data.co2=window.getEl("nr_co2"),e.el.data.emission=window.getEl("nr_emission"),e.el.data.emissionhaz=window.getEl("nr_emissionhaz"),e.el.data.trc=window.getEl("nr_trc"),e.el.data.waste=window.getEl("nr_waste"),e.el.data.wasterecycled=window.getEl("nr_wasterecycled"),e.el.data.water=window.getEl("nr_water"),e.el.btnshowcurrent=window.getEl("show_current"),e.el.btnshowsimulation=window.getEl("show_simulation"),e.el.history=window.getEl("graph"),e.el.regioninfotitle=window.getEl("region_info_title"),window.objArcProps.targetnode=window.getEl("arc_path"),window.objArcProps.targetleftwrapper=window.getEl("arc_path_left_wrapper"),window.objArcProps.targetleftnode=window.getEl("arc_path_left")}},objSliders={state:{visible:null,tweening:null},el:{wrapper:null,innerwrapper:null,slidersales:null,slidergreensales:null},vars:{data:null,content:null,slidersalesvalue:0,slidergreensalesvalue:0,livesimprovedcurrent:0,simulatorsampling:!1,debug:!1,updatetrendgraph:!0,updatecurrent:!1,usebiliniarinterpolation:!0,debugstring:"",recalculatecounter:0,setupsimulator:!0},calculatefloorceil:function(e,t){var o=0,a=0,i=Math.round(e/t)*t;return e>=0?e%t>t/2?o=(a=i)-t:a=(o=i)+t:Math.abs(e%t)>t/2||e%t==0?a=(o=i)+t:o=(a=i)-t,{floor:o,ceil:a}},start:function(){var e=this,t={fulldomain:location.protocol+"//"+location.hostname,method:"getlivesimprovedcachedata",type:"json",oru:window.objPageState.state.filter.oru,mru:window.objPageState.state.filter.mru,snapshotid:window.objConfig.currentsnapshotid,token:window.objLogin.token};e.recalculatecounter=0,window.psv("GET",window.objConfig.urls.dynamicresourceurl,t,e.getsimulatordatahandler)},getsimulatordatahandler:function(e,t){var o=objSliders;e?window.objError.handleError("objSliders.start",e):t.hasOwnProperty("authenticated")&&!t.authenticated?window.handleShibbolethLoginRequired():window.hasProperty(t,"error")?window.objError.show(t.error.message,!0):(o.vars.data=t,window.app.trendgraph.predictionlabel=o.vars.data.layout.simulatorlabel,window.app.trendgraph.predictiondate=o.vars.data.layout.simulatordate,window.app.trendgraph.stylecurrentline=o.vars.data.layout.simulatorstyle,o.setuphistorygraph())},setuphistorygraph:function(){var e,t=this.vars.data.historicaldata,o={points:[],ymin:null,ymax:null},a="",i=-1e12,n=1e12,r=/(\d{4})-(\d{2})-(\d{2})/;t.sort(function(e,t){return new Date(e.dateend)-new Date(t.dateend)});for(d=0;d<t.length;d++){var l=t[d].l;if(-1===l&&(l=0),e=r.exec(t[d].dateend),o.points.push({value:window.objMap.roundlivesimproveddataobject({l:l,g:-1,p:-1}).displayl,label:t[d].name,dateend:t[d].dateend,utcend:Date.UTC(+e[1],+e[2]-1,+e[3])}),d===t.length-1){var s=new Date(t[d].dateend);""!==window.app.trendgraph.predictionlabel?window.app.trendgraph.predictionlabel:"Q4 "+(s.getMonth()+1===12?s.getFullYear()+1:s.getFullYear()),a=""!==window.app.trendgraph.predictiondate?window.app.trendgraph.predictiondate:(s.getMonth()+1===12?s.getFullYear()+1:s.getFullYear())+"-12-31",e=r.exec(a),Date.UTC(+e[1],+e[2]-1,+e[3])}l>i&&(i=l),l<n&&(n=l)}if(o.ymin=parseFloat(window.objMap.roundlivesimproveddataobject({l:n,g:-1,p:-1}).displayl.replace(/,/,"")),o.ymax=parseFloat(window.objMap.roundlivesimproveddataobject({l:i,g:-1,p:-1}).displayl.replace(/,/,"")),window.objTrendGraph.props.axis.ygridlines=3,o.ymax<.1&&(window.objTrendGraph.props.axis.ygridlines=null),null!=window.app.trendgraph.pointsvisible&&o.points.length>window.app.trendgraph.pointsvisible)for(var d=0;d<o.points.length-window.app.trendgraph.pointsvisible+1;d++)o.points.shift();o.styles={},o.styles.stylecurrentline=window.app.trendgraph.stylecurrentline,window.objTrendGraph.props.line.lastsegment.class="lastsegment",window.objTrendGraph.props.line.lastpoint.id="lp",window.objTrendGraph.reset(),window.objTrendGraph.drawgraph(o)},init:function(){var e=this;e.state.visible=!1,e.state.tweening=!1}},objLogin={token:null,role:"",state:{visible:null,tweening:null,usernamedisabled:null,passworddisabled:null,authenticating:null,messages:[]},vars:{},el:{wrapper:null,submit:null},btnsubmitclick:function(){var e=window.objConfig.urls.hasOwnProperty("urlshiblogin")?window.objConfig.urls.urlshiblogin:"https://www.livesimproved.philips.com/tools/shibboleth-authenticate.aspx";location.href=e+"?rnd="+Math.random()},findlatestsnapshotid:function(e){window.objConfig.snapshots=e.snapshotconfig;var t=new Date("1970-01-01"),o="";if(null!=window.objConfig.snapshots)for(var a=0;a<window.objConfig.snapshots.length;a++){var i=window.objConfig.snapshots[a];new Date(i.dateend)-t>0&&(o=i.snapshotid,t=new Date(i.dateend))}window.objConfig.currentsnapshotid=o},getsnapshotconfig:function(){var e=this,t={type:"json",fulldomain:location.protocol+"//"+location.hostname,method:"getsnapshotdetailssimple",token:objLogin.token};window.psv("GET",window.objConfig.urls.authurl2,t,function(t,o){t||window.hasProperty(o,"error")?window.hasProperty(o,"error")?window.objError.show("There was an error retrieving snapshot information. "+("object"==typeof o?JSON.stringify(o):o),!0):window.objError.show("There was an error retrieving snapshot information. "+("object"==typeof t?JSON.stringify(t):t),!0):void 0===o||"string"==typeof o||null===o?(window.objError.show("There was an error retrieving snapshot information. No data was received...",!0),window.handleShibbolethLoginRequired()):o.hasOwnProperty("authenticated")&&!o.authenticated?window.handleShibbolethLoginRequired():(e.findlatestsnapshotid(o),e.checkappconfigforupdates(o),window.isPublicSite()?(objLogin.token=window.generateUniqueId().replace(/x/g,""),e.continueretrievemetadata()):e.checksession())})},checksession:function(){var e={fulldomain:location.protocol+"//"+location.hostname,method:"checksession",type:"json"};window.psv("GET",window.objConfig.urls.authurl2,e,function(e,t){e||window.hasProperty(t,"error")?window.hasProperty(t,"error")?window.objError.show("There was an error retrieving session information. "+("object"==typeof t?JSON.stringify(t):t),!0):window.objError.show("There was an error retrieving session information. "+("object"==typeof e?JSON.stringify(e):e),!0):t.authenticated?(objLogin.token=t.token,objLogin.continueretrievemetadata()):window.handleShibbolethLoginRequired()})},continueretrievemetadata:function(){window.isPublicSite()||(window.app.defaultpagestate.view="worldmap"),window.app.retrievemetadata()},checksnapshotconfigforupdates:function(e){var t=this,o=window.objStore.getlocalstorageitem("snapshotconfig"),a=e.snapshotconfig;if(o){o=JSON.parse(o).snapshotconfig;for(var i=0;i<a.length;i++){for(var n=!1,r=0;r<o.length;r++)if(a[i].snapshotid===o[r].snapshotid&&(n=!0,a[i].lastmodified!==o[r].lastmodified)){t.state.messages.push('There is updated data for "'+a[i].name+'".');break}n||t.state.messages.push('A new data set "'+a[i].name+'" has been added.')}}window.objStore.setlocalstorageitem("snapshotconfig",JSON.stringify(e))},checkappconfigforupdates:function(e){var t=this,o=window.objStore.getlocalstorageitem("appconfig"),a=e.appinfo,i="";window.app.state.mobileortablet?(i="<b>New release available</b><p>A new version ("+(window.app.state.ios?a.iosid:a.androidid)+") of the Lives Improved app is available.</p>",i+='<p>Please visit the <span class="mimiclink" onclick="loadUrlInBrowser(\'https://www.livesimproved.philips.com/download\', true)">Lives Improved website</span> to download and install this new version.</p>',i+="<p>Details:</p>",o&&(o=JSON.parse(o),window.app.state.ios?o.iosid!==a.iosid&&(t.state.messages.push(i),t.state.messages.push(a.iosdescription)):o.androidid!==a.androidid&&(t.state.messages.push(i),t.state.messages.push(a.andrioddescription)))):(i="<b>The Lives Improved website has updated</b>",i+="<p>Details:</p>",(o=o?JSON.parse(o):null)?o.iosid!==a.iosid&&(t.state.messages.push(i),t.state.messages.push(a.iosdescription)):(t.state.messages.push(i),t.state.messages.push(a.iosdescription))),window.objStore.setlocalstorageitem("appconfig",JSON.stringify(e.appinfo))},hide:function(){var e=this;e.state.tweening=!0,window.app.state.ios?(e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1):window.TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},show:function(){var e=this;window.objSliders.vars.simulatorsampling=!1,e.el.wrapper.style.display="block",e.state.tweening=!0,window.app.state.ios?(e.el.wrapper.style.opacity=1,e.state.tweening=!1,e.state.visible=!0,location.href=window.objConfig.urls.urlshiblogin+"?rnd="+Math.random()):window.TweenLite.to(e.el.wrapper,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0,location.href=window.objConfig.urls.urlshiblogin+"?rnd="+Math.random()}})},logout:function(){window.objStore.removelocalstorageitem("token"),window.objPageState.updatepagestate({view:"login"})},showupdatemessages:function(){var e=this;if(window.getEl("messagelist").innerHTML="",e.state.messages.length>0){for(var t=0;t<e.state.messages.length;t++)window.getEl("messagelist").innerHTML+="<li>"+e.state.messages[t]+"</li>";e.state.messages=[],e.showmessages()}},hidemessages:function(){var e=this;e.state.tweening=!0,window.TweenLite.to(e.el.messagespanel,.3,{opacity:0,onComplete:function(){window.objOverlay.hide(),e.el.messagespanel.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},showmessages:function(){var e=this;window.objOverlay.show(),e.state.tweening=!0,e.el.messagespanel.style.display="block",window.TweenLite.to(e.el.messagespanel,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},init:function(){var e=this;e.state.passworddisabled=!1,e.state.usernamedisabled=!1,e.state.authenticating=!1,e.el.wrapper=window.getEl("login_panel"),e.el.submit=window.getEl("btn_submit"),e.el.messagespanel=window.getEl("messages_panel"),e.token=window.objStore.getlocalstorageitem("token")}},objError={state:{visible:null,tweening:null},el:{wrapper:null,text:null},hide:function(){var e=this;e.el.wrapper.innerHTML="",e.state.tweening=!0,TweenLite.to(e.el.wrapper,.3,{height:0,onComplete:function(){e.state.tweening=!1,e.state.visible=!1}})},show:function(e,t){var o=this;o.el.wrapper.innerHTML=e,o.state.tweening=!0,TweenLite.to(o.el.wrapper,.3,{height:50,onComplete:function(){if(o.state.tweening=!1,o.state.visible=!0,t)setTimeout(function(){o.hide()},4e3)}})},handleError:function(e,t){var o=this;objLoading.state.visible&&objLoading.hide(),objOverlay.state.visible&&objOverlay.hide(),t.message&&(t=t.message),t.line?o.show("JS Error: line="+t.line+", message="+t.message+", stack="+t.stack,!0):"string"==typeof t?"token mismatch"==t.toLowerCase()||"not authenticated"==t.toLowerCase()?objLogin.show():o.show(t,!0):o.show(JSON.stringify(t),!0)},init:function(){var e=this;e.state.visible=!1,e.state.tweening=!1,e.el.wrapper=getEl("error")}},objFilter={state:{visible:null,tweening:null,currentfilterhtml:""},el:{wrapper:null,filtercontent:null},show:function(){var e=this;e.state.currentfilterhtml=e.el.filtercontent.innerHTML,window.isPublicSite()||window.objOverlay.show(),e.state.tweening||(e.state.tweening=!0,e.el.wrapper.style.display="block",window.TweenLite.to(e.el.wrapper,.3,{opacity:1,onComplete:e.showcomplete})),window.objMruFilter.setmrufilterstate(),window.objOruFilter.setorufilterstate()},showcomplete:function(){objFilter.state.tweening=!1,objFilter.state.visible=!0},hide:function(){var e=this;e.state.tweening||(e.state.tweening=!0,window.TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){window.isPublicSite()||window.objOverlay.hide(),e.el.filtercontent.innerHTML=e.state.currentfilterhtml,e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1,e.el.btnapply.style.display="none"}}))},blink:function(){var e=this;window.isPublicSite()?e.blinkcomplete():window.TweenLite.to(e.el.filtercontent,.2,{opacity:.5,onComplete:function(){e.el.loader.style.display="block",window.TweenLite.to(e.el.filtercontent,.4,{opacity:1,onComplete:e.blinkcomplete})}})},blinkcomplete:function(){objFilter.el.loader.style.display="none",objFilter.el.btnapply.style.display="block"},applyfilter:function(e){var t=this;window.isPublicSite()||!t.state.visible||t.state.tweening||t.hide();var o=window.objOruFilter.retrieveselectedorulevel();t.state.currentfilterhtml=t.el.filtercontent.innerHTML,t.el.btnapply.style.display="none";var a=window.objOruFilter.state.selectedoruguid;"boolean"==typeof e&&e&&(a="none");var i="worldmap";"none"===a&&"1"!==o||(i="detail");var n=window.objDataFilter.state.filter.subtype;o!==window.objPageState.state.filter.orulevel&&"all"!==window.objDataFilter.state.filter.subtype&&"lives_improved"!==window.objDataFilter.state.filter.datasource&&-1===window.objMap.createdatatypelistforregions(o)[window.objDataFilter.state.filter.datasource].indexOf(n)&&(n="all"),o!==window.objPageState.state.filter.orulevel&&"1"===o&&(i="detail",a="world"),window.isPublicSite()?window.objPageState.updatepagestate({view:i,filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:n,orulevel:o,oru:a,sector:window.objMruFilter.state.selectedsector,mru:window.objMruFilter.state.selectedmru}}):window.objPageState.updatepagestate({view:"worldmap",filter:{datasource:window.objDataFilter.state.filter.datasource,subtype:window.objDataFilter.state.filter.subtype,orulevel:window.objOruFilter.retrieveselectedorulevel(),oru:"none",sector:window.objMruFilter.state.selectedsector,mru:window.objMruFilter.state.selectedmru}}),window.isPublicSite()||window.objRegionInfo.state.visible&&!window.objRegionInfo.state.tweening&&window.objRegionInfo.hide()},init:function(){var e=this;e.state.visible=!1,e.state.tweening=!1,e.el.wrapper=window.getEl("filter_panel"),e.el.loader=window.getEl("filter_loader"),e.el.filtercontent=window.Sizzle("#filter_panel div.modal_content")[0],e.el.btnapply=window.getEl("btn_apply_filter"),e.el.btnapply.style.display="none",e.state.currentfilterhtml=e.el.filtercontent.innerHTML}},objBookmarks={state:{visible:null,tweening:null},el:{wrapper:null},isfavourite:function(){var e="fav_"+objPageState.state.filter.orulevel+"_"+objPageState.state.filter.mru+"_"+objPageState.state.filter.oru;return null!=objStore.getlocalstorageitem(e)},addbookmark:function(){},removefavourite:function(e,t){e.stopPropagation();var o=t.parentNode,a=o.getAttribute("data-key");return objStore.removelocalstorageitem("fav_"+a),TweenLite.to(o,.2,{left:"100%",delay:0,onComplete:function(){TweenLite.to(o,.3,{height:0,delay:0,onComplete:function(){return o.parentNode.removeChild(o),!1}})}}),!1},findfavourites:function(){var e=[];if(objStore.vars.uselocalstorage)for(var t=0;t<objStore.store.length;t++){var o=localStorage.key(t);o.indexOf("fav_")>-1&&e.push(objStore.store.getItem(o))}return e},renderfavouritepanel:function(){for(var e=this,t=e.findfavourites(),o=document.createElement("ul"),a=0;a<t.length;a++){var i=JSON.parse(t[a]),n=objMruFilter.getsectorfrombreadcrumb(i.breadcrumb),r=document.createElement("li");r.setAttribute("data-oru",i.oru),r.setAttribute("data-mru",i.mru),r.setAttribute("data-region",i.region_id),r.setAttribute("data-sector",n);var l=i.oru+"_"+i.mru+"_"+(4!=i.oru?i.region_id.toLowerCase():i.region_id);r.setAttribute("data-key",l),r.innerHTML='<div class="bookmark_color" style="background:'+objConfig.colors[n].middle+'"></div><h2>'+i.region_name+'</h2><span class="bookmark_sub">'+i.breadcrumb+'</span><div class="remove_bookmark" onclick="objBookmarks.removefavourite(event, this);return false;"></div>',r.onclick=function(){e.openfavourite(this.getAttribute("data-oru"),this.getAttribute("data-mru"),this.getAttribute("data-region"),this.getAttribute("data-sector"))},o.appendChild(r)}e.el.list.innerHTML="",0==t.length?e.el.list.innerHTML='<div style="padding: 10px">Use the heart icon to add your favourite combinations to this bookmark list.</div>':e.el.list.appendChild(o)},openfavourite:function(e,t,o,a){var i=this;objOruFilter.state.selectedoru=e,objMruFilter.state.selectedmru=t,objMruFilter.state.selectedsector=a,objOruFilter.settocurrentoru(),objPageState.updatepagestate({view:"detail",filter:{orulevel:e,oru:o,sector:a,mru:t}}),i.hide()},show:function(){var e=this;objOverlay.show(),e.state.tweening=!0,e.el.wrapper.style.display="block",TweenLite.to(e.el.wrapper,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0}})},hide:function(){var e=this;e.state.tweening=!0,TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){objOverlay.hide(),e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},init:function(){var e=this;e.state.visible=!1,e.state.tweening=!1,e.el.wrapper=getEl("bookmarks_panel"),e.el.list=getEl("bookmarkslist"),e.renderfavouritepanel()}},objExplain={state:{visible:null,tweening:null,contentloaded:!1},el:{wrapper:null,content:null},show:function(){var e=this;objOverlay.show(),e.state.tweening=!0,e.el.wrapper.style.display="block",TweenLite.to(e.el.wrapper,.3,{opacity:1,onComplete:function(){e.state.tweening=!1,e.state.visible=!0,e.state.contentloaded||serverSideRequest({url:objConfig.urls.base+"/data/faq.html"+(location.href.indexOf("http")>-1?"?rnd="+window.pageVars.version:""),method:"get",debug:!1,callback:function(t,o){e.el.content.innerHTML=o,e.state.contentloaded=!0}})}})},hide:function(){var e=this;e.state.tweening=!0,TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){objOverlay.hide(),e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},showfaqcontent:function(e,t){for(var o=Sizzle("#explain_content div.selected"),a=0;a<o.length;a++)o[a].className=o[a].className.replace(" selected","");e.className+=" selected",getEl(t).className+=" selected"},init:function(){var e=this;e.state.visible=!1,e.state.tweening=!1,e.el.wrapper=getEl("explain_panel"),e.el.content=getEl("explain_content")}},objTrendGraph={state:{valuepopupopen:!1,trendpopupflipped:!1},vars:{popuptrendwidth:0,popuptrendheight:0,popuptrendtextwrapperheight:0,popupvaluewidth:0,popupvalueheight:0,data:null,template:null,debug:window.objConfig.sitetype.indexOf("dev")>-1},el:{root:null,lastsegment:null,lastpoint:null,popuptrend:null,popuptrendbase:null,popuptrendnumber:null,popuptrendtextwrapper:null,popupvalue:null,popupvaluenumber:null},props:{width:640,height:300,padding:{top:60,bottom:40,left:45,right:45},axis:{ymin:4,ymax:15,ystep:2.5,ygridlines:null,ygridlinesfullwidth:!0,showxlines:!1,xlinelength:8,showylines:!1,ylinelength:8,ylabelinset:!0,xpaddingleft:35,xpaddingright:10,ypaddingtop:20,ypaddingbottom:20},labels:{x:{padding:{bottom:20}},y:{translate:{x:0,y:8}}},coordinatepoint:{radius:5},title:{text:"Trend"},line:{lastsegment:{id:"last_segment",class:"last"},lastpoint:{id:"last_point",class:"last"}}},decimalplaces:function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},correctlabeldecimals:function(e,t){var o=!1,a=0;3===arguments.length&&(o=arguments[2]),t=t.replace(/,/,""),e=e.replace(/,/,""),t.indexOf(".")>-1&&(a=t.split(".")[1].length);var i=window.formatMoney(parseFloat(e),a,",",".","");return o&&i.indexOf(".")>-1&&(i=parseFloat(i).toFixed(i.split(".")[1].length-1)),i},reset:function(){},getMinMax:function(){for(var e=this,t={min:1e18,max:0},o=0;o<e.vars.data.points.length;o++){var a=1*e.vars.data.points[o].value.replace(",","");a<t.min&&(t.min=a),a>t.max&&(t.max=a)}return t},createColumn:function(e,t,o,a){var i=this,n=document.createElement("div"),r=document.createElement("div"),l=document.createTextNode(e.value);r.classList.add("value"),r.appendChild(l),n.appendChild(r);var s=document.createElement("div");s.classList.add("point"),s=i.drawPoint(s,e,t,o,a),n.appendChild(s);var d=document.createElement("div"),w=document.createTextNode(e.label);return d.classList.add("period"),d.appendChild(w),n.appendChild(d),n},drawPoint:function(e,t,o,a,i){var n=i*(1*t.value.replace(",","")-o.min)/a,r=document.createElement("div");return r.classList.add("y"),r.setAttribute("style","bottom: "+(n+15)+"px"),e.appendChild(r),e},createLine:function(e,t,o,a,i){var n=Math.sqrt((e-o)*(e-o)+(t-a)*(t-a)),r="rotate("+-180*Math.atan2(a-t,o-e)/Math.PI+"deg)",l=document.createElement("div");l.classList.add("line");var s="bottom: "+t+"px; transform: "+r+"; width: "+n+"px;";l.setAttribute("style",s),i.appendChild(l)},drawgraph:function(e){var t=this;void 0===e&&(e=t.vars.data),t.el.root.innerHTML="";e.points.sort(function(e,t){return e.utcend-t.utcend}),t.vars.data=e;for(var o=t.getMinMax(),a=t.el.root.getBoundingClientRect().height-120,i=o.max-o.min,n=0;n<t.vars.data.points.length;n++){var r=t.createColumn(t.vars.data.points[n],o,i,a);t.el.root.appendChild(r)}for(var l=document.querySelectorAll(".y"),n=0;n<l.length-1;n++){var s=l[n].getBoundingClientRect(),d=l[n+1].getBoundingClientRect();t.createLine(s.left+5,1*l[n].style.bottom.replace("px","")+5,d.left+5,1*l[n+1].style.bottom.replace("px","")+5,l[n].parentNode)}},redrawgraph:function(){for(var e=document.querySelectorAll(".y"),t=0;t<e.length-1;t++){var o=e[t].getBoundingClientRect(),a=e[t+1].getBoundingClientRect();self.createLine(o.x+5,1*e[t].style.bottom.replace("px","")+5,a.x+5,1*e[t+1].style.bottom.replace("px","")+5,e[t].parentNode)}},init:function(){this.el.root=document.getElementById("graph")}},objLoading={state:{visible:null,tweening:null},vars:{animate:!1},el:{wrapper:null},show:function(e){var t=this;t.state.tweening=!0,t.el.wrapper&&(t.el.wrapper.style.display="block",(objOverlay.state.visible||0==objOverlay.state.visible&&1==objOverlay.state.tweening)&&0==objFilter.state.visible?objLoading.el.wrapper.style.background='url("./img/ajax-loader.gif") no-repeat':objLoading.el.wrapper.style.background='url("./img/ajax-loader_white.gif") no-repeat',app.state.ios?(t.el.wrapper.style.opacity=.7,t.state.visible=!0,t.state.tweening=!1,e&&e()):TweenLite.to(t.el.wrapper,.3,{opacity:.7,delay:0,onComplete:function(){t.state.visible=!0,t.state.tweening=!1,e&&e()}}))},hide:function(e){var t=this;t.state.tweening=!0,t.el.wrapper&&(app.state.ios?(t.el.wrapper.style.display="none",t.state.visible=!1,t.state.tweening=!1,e&&e()):TweenLite.to(t.el.wrapper,.3,{opacity:0,delay:0,onComplete:function(){t.el.wrapper.style.display="none",t.state.visible=!1,t.state.tweening=!1,e&&e()}}))},init:function(){var e=this;e.state.tweening=!1,e.state.visible=!1,e.el.wrapper=getEl("loading")}},objPanelInfo={state:{visible:null,tweening:null,contentloaded:!1},el:{wrapper:null,content:null},show:function(e){var t=this;t.getcontent(e,function(){t.state.tweening=!0,t.el.wrapper.style.display="block",window.TweenLite.to(t.el.wrapper,.3,{opacity:1,onComplete:function(){t.state.tweening=!1,t.state.visible=!0}})})},hide:function(){var e=this;e.state.tweening=!0,window.TweenLite.to(e.el.wrapper,.3,{opacity:0,onComplete:function(){e.el.wrapper.style.display="none",e.state.tweening=!1,e.state.visible=!1}})},getcontent:function(e,t){var o=this,a=e+"_intro.html";window.serverSideRequest({url:window.objConfig.urls.base+"/data/"+a+(location.href.indexOf("http")>-1?"?v="+window.pageVars.version:""),method:"get",debug:!1,callback:function(a,i){o.el.contentwrapper.className=e,o.el.content.innerHTML=i,t()}})},removelocalstorageitems:function(){window.objStore.removelocalstorageitem("seenAppIntro"),window.objStore.removelocalstorageitem("seenFilterIntro"),window.objStore.removelocalstorageitem("seenRegionInfoIntro"),location.reload()},init:function(){var e=this;e.state.visible=!1,e.state.tweening=!1,e.el.wrapper=window.getEl("panel_info_panel"),e.el.contentwrapper=window.getEl("content_wrapper"),e.el.content=window.getEl("panel_info_content")}},objMruFilter={state:{selectedmru:null,selectedsector:null,tweening:null},el:{mrufilter:null,tempmru:null},setmrufilterstate:function(){var e=this;e.state.selectedmru=window.objPageState.state.filter.mru,e.state.selectedsector=e.getmrufilteraxisarray(window.objPageState.state.filter.mru)[0].id,e.showlevel(e.state.selectedsector,e.state.selectedmru,!1)},getsectoridfromfilterhtml:function(){},getmrufilteraxisarray:function(e){var t="#filter_container #"+e,o=window.Sizzle(t)[0],a=[];if(o&&o.firstElementChild)for(a.push({id:o.id,name:o.firstElementChild.innerHTML});null!=o.parentNode&&"filter_list"!==o.parentNode.className;)"li"===(o=o.parentNode).localName&&a.push({id:o.id,name:o.firstElementChild.innerHTML});else a.push({id:"philips",name:"Philips Group"});return a.reverse()},getsectorfrombreadcrumb:function(e){return e.indexOf("ealthcare")>-1?"PD0900":e.indexOf("ighting")>-1?"PD0100":e.indexOf("ifestyle")>-1||e.indexOf("ersonal")>-1?"PD0200":e.indexOf("onnected")>-1?"DHS003":e.indexOf("iagnosis")>-1?"DHS001":e.indexOf("oyal")>-1?"royalphilips":"philips"},getmrufilterbreadcrumb:function(){for(var e=this.getmrufilteraxisarray(window.objPageState.state.filter.mru),t=[],o=0;o<e.length;o++)t.push(e[o].name);return t.join(" &bull; ")},preparehtml:function(e){var t=this;t.el.tempmru.innerHTML=e,t.el.mrufilter=window.getEl("filter_container"),t.el.mrufilter.innerHTML=e,t.state.selectedsector=window.app.defaultpagestate.filter.sector},selectmru:function(e,t,o){var a=this;e&&e.stopPropagation(),a.showlevel(t,o)},showlevel:function(e,t){var o=this;o.state.selectedmru=t,o.state.selectedsector=e;for(var a=window.getEl(t),i=a.parentNode,n=window.getFirstLevelChildElements(i,"li"),r=window.getEl("filter_container").getElementsByTagName("li"),l=0;l<r.length;l++)r[l].className="";for(var s=0;s<n.length;s++){var d=n[s];if(d!==a)for(var w=d.getElementsByTagName("ul"),u=0;u<w.length;u++)2===arguments.length?window.TweenLite.to(w[u],.2,{height:0}):w[u].style.height="0px"}if(a.className="selected",2===arguments.length)(c=window.getFirstLevelChildElements(a,"ul")).length>0&&window.TweenLite.to(c[0],.4,{height:"auto"});else for(var p=o.getmrufilteraxisarray(window.objPageState.state.filter.mru),l=0;l<p.length;l++){var c=window.getFirstLevelChildElements(window.getEl(p[l].id),"ul");c.length>0&&(c[0].style.height="auto")}window.objHeader.setbreadcrumb(objMruFilter.getmrufilterbreadcrumb()),2===arguments.length&&window.objFilter.blink(),window.isPublicSite()&&window.objFilter.applyfilter()},init:function(e){var t=this;t.state.tweening=!1,t.state.selectedmru=window.app.defaultpagestate.filter.mru,t.state.selectedsector="philips",t.el.mrufilter=window.getEl("filter_container"),t.el.tempmru=window.getEl("producttree_temp")}},objOruFilter={json:null,listlevel1world:[],listlevel2region:[],listlevel3market:[],listlevel4country:[],state:{selectedoru:null,selectedoruguid:null},el:{mrufilter:null,wrapper:null},postprocessorudata:function(){var e=this;if(e.listlevel1world.push({guid:objOruFilter.json.unit.guid,parent:void 0}),"object"==typeof objOruFilter.json.unit.subunits)for(var t in objOruFilter.json.unit.subunits)if("string"==typeof t&&(e.listlevel2region.push({guid:objOruFilter.json.unit.subunits[t].guid,parent:objOruFilter.json.unit.guid}),"object"==typeof objOruFilter.json.unit.subunits[t].subunits))for(var o in objOruFilter.json.unit.subunits[t].subunits)if("string"==typeof o&&(e.listlevel3market.push({guid:objOruFilter.json.unit.subunits[t].subunits[o].guid,parent:objOruFilter.json.unit.subunits[t].guid}),"object"==typeof objOruFilter.json.unit.subunits[t].subunits[o].subunits))for(var a in objOruFilter.json.unit.subunits[t].subunits[o].subunits)"string"==typeof a&&e.listlevel3market.push({guid:objOruFilter.json.unit.subunits[t].subunits[o].subunits[a].guid,parent:objOruFilter.json.unit.subunits[t].subunits[o].guid})},retrieveoruarr:function(e){var t=parseInt(void 0===e?window.objPageState.state.filter.orulevel:e,10);switch(t){case 1:return window.objOruFilter.listlevel1world;case 2:return window.objOruFilter.listlevel2region;case 3:return window.objOruFilter.listlevel3market;case 4:return window.objOruFilter.listlevel4country;default:return window.objError.show("Unexpected level was passed ("+t+").",!0),[]}},setorufilterstate:function(){var e=this;e.state.selectedoru=window.objPageState.state.filter.orulevel;var t="btn_country";switch(window.objPageState.state.filter.orulevel){case"1":t="btn_world";break;case"2":t="btn_region";break;case"3":t="btn_bmc"}e.selectoru(window.getEl(t),window.objPageState.state.filter.orulevel,!1)},getregionnamebyid:function(e){var t=window.translateFragment(e);if(t.indexOf("[")>-1){var o=void 0;"cantral-east_europe"===e&&(o="central-east_europe"),"central-east_europe"===e&&(o="cantral-east_europe"),o&&(t=window.translateFragment(o))}return window.returnObj={},t},selectoru:function(e,t){var o=this;o.el.wrapper=window.getEl("oru_filter_container"),e.className="selected",o.state.selectedoru=t,window.objHeader.setbreadcrumb(window.objMruFilter.getmrufilterbreadcrumb()),2===arguments.length&&window.objFilter.blink(),window.objFilter.applyfilter(!0)},retrieveselectedorulevel:function(){return objOruFilter.state.selectedoru=objOruFilter.el.orulevelselect.options[objOruFilter.el.orulevelselect.selectedIndex].value,objOruFilter.state.selectedoru},settocurrentoru:function(){for(var e=this.el.wrapper.getElementsByTagName("option"),t=0;t<e.length;t++)e[t].getAttribute("value")===window.objPageState.state.filter.orulevel?e[t].setAttribute("selected","selected"):e[t].removeAttribute("selected")},rendermobilegeographylist:function(){var e='<ul class="c-region-list">';this.retrieveoruarr().forEach(function(t){-1===window.objMap.vars.nodataids.indexOf(t.guid)?e+='<li class="mapselector" data-target="'+t.guid+'" onclick="countryClicked(\''+t.guid+"', true)\">"+window.translateFragment(t.guid)+"</li>":e+='<li class="mapselector no-data" data-target="'+t.guid+'" onclick="countryClicked(\''+t.guid+"', true)\">"+window.translateFragment(t.guid)+"</li>"}),e+="</ul>",window.getEl("regions").innerHTML=e,window.app.state.mobile&&window.app.state.inframe&&window.messageIframeResizeToParent()},setdatalevelattribute:function(e){window.getEl("body").setAttribute("data-orulevel","level"+(e||document.getElementsById("oru-select").selectedValue))},convertoruleveltomarket:function(e){switch(parseInt(e,10)){case 1:return"World";case 2:return"Region";case 3:return"Market";case 4:return"Country"}return""},init:function(e){var t=this;t.state.selectedoru=window.app.defaultpagestate.filter.orulevel,t.el.wrapper=window.getEl("oru_filter_container"),t.el.orulevelselect=window.getEl("oru-select"),objOruFilter.setdatalevelattribute(1)}},objDataFilter={el:{wrapper:""},vars:{subclicked:!1,timerid:null},state:{filter:{datasource:"lives_improved",subtype:""},subtype:{}},init:function(){this.el.wrapper=window.getEl("map-tab_panels")},resetsubtypeindicators:function(e){for(var t=0;t<e.length;t++)e[t].innerText=window.translateFragment("all_data")},setactivetab:function(e){for(var t=objDataFilter.el.wrapper.getElementsByClassName("active-tab"),o=0;o<t.length;o++)t[o].removeAttribute("class");e.setAttribute("class","active-tab")},mapdatatypekeys:function(e){var t={value_co2:"c_o_2",value_fte:"number_of_employees",value_waste:"waste",value_water:"water",value_emissions:"emissions",value_emissionshaz:"emissionshaz",value_trc:"lwc_rate",value_wasterecycled:"recycled",value_sales:"number_sales",value_male:"percentage_male",value_female:"percentage_female",value_research:"r_and_d_centers",value_plants:"manufacturing_sites",value_assets:"number_assets",value_employees:"number_of_employees"};return t[e]?t[e]:e},renderdatasubtypefilters:function(){var e=this;if(window.objConfig.datasources.indexOf("sustainability")>-1){var t='<div class="bg"></div><ul><li class="datasubtype" data-subtype="all" onclick="objDataFilter.changesubtype(\'sustainability\', \'all\')">'+window.translateFragment("all_data")+"</li>";window.objMap.datatypes.sustainability.forEach(function(o){o.indexOf("value_")>-1&&(t+='<li class="datasubtype" data-subtype="'+o+"\" onclick=\"objDataFilter.changesubtype('sustainability', '"+o+"')\">"+window.translateFragment(e.mapdatatypekeys(o)).replace(/^(.*?)(\s*\(.*\))$/g,"$1")+"</li>")}),t+="</ul>",window.Sizzle("li[data-panel=sustainability] .datatype-filter")[0].innerHTML=t}if(window.objConfig.datasources.indexOf("global_presence")>-1){var o='<div class="bg"></div><ul><li class="datasubtype" data-subtype="all" onclick="objDataFilter.changesubtype(\'global_presence\', \'all\')">'+window.translateFragment("all_data")+"</li>";window.objMap.datatypes.global_presence.forEach(function(t){t.indexOf("value_")>-1&&(o+='<li class="datasubtype" data-subtype="'+t+"\" onclick=\"objDataFilter.changesubtype('global_presence', '"+t+"')\">"+window.translateFragment(e.mapdatatypekeys(t)).replace(/^(.*?)(\s*\(.*\))$/g,"$1")+"</li>")}),o+="</ul>",window.Sizzle("li[data-panel=global_presence] .datatype-filter")[0].innerHTML=o}},setdatasubtypefilter:function(e,t){for(var o=document.getElementsByClassName("datasubtype"),a=0;a<o.length;a++)o[a].setAttribute("class","datasubtype");var i=window.Sizzle("li[data-panel="+e+"] li[data-subtype="+t+"]");void 0!==i&&i[0].setAttribute("class","datasubtype active")},changedatasource:function(e){objDataFilter.vars.subclicked||(objDataFilter.state.filter.datasource=e,objDataFilter.state.filter.subtype="all",window.objFilter.applyfilter())},changesubtype:function(e,t){objDataFilter.vars.subclicked=!0,objDataFilter.state.filter.datasource=e,objDataFilter.state.filter.subtype=t,window.objFilter.applyfilter(),objDataFilter.vars.timerid=setTimeout(function(){objDataFilter.vars.subclicked=!1},50)},datasourcechanged:function(e){var t=window.Sizzle("li[data-panel="+e+"]")[0];objDataFilter.setactivetab(t),objDataFilter.resetsubtypeindicators(objDataFilter.el.wrapper.getElementsByClassName("subtypeindicator")),window.getEl("body").removeAttribute("data-subtype"),"lives_improved"!==e&&window.objRegionInfo.setdetailspanel(e,"all"),"lives_improved"!==e&&objDataFilter.setdatasubtypefilter(e,"all")},subtypechanged:function(e,t){var o=window.Sizzle("li[data-panel="+e+"] li[data-subtype="+t+"]")[0],a=window.Sizzle("li[data-panel="+e+"]")[0];objDataFilter.setactivetab(a),objDataFilter.resetsubtypeindicators(objDataFilter.el.wrapper.getElementsByClassName("subtypeindicator")),a.getElementsByClassName("subtypeindicator")[0].innerHTML=o.innerHTML,window.getEl("body").setAttribute("data-subtype",t),"lives_improved"!==e&&window.objRegionInfo.setdetailspanel(e,t),"lives_improved"!==e&&objDataFilter.setdatasubtypefilter(e,t)},renderdatalabel:function(e){var t=window.objConfig.datalabels[window.objConfig.siteid],o=window.objConfig.datalabels.q417;"lives_improved"===e?t=o:"sustainability"===e&&"qr"===window.objConfig.pubtype&&("future"===window.objConfig.datatype&&(t=o),t+="_ht");var a=window.translateFragment(t);window.app.state.inframe&&window.setTimeout(function(){window.postMessageToParent({action:"setdatalabel",value:a})},100)}},app={state:{width:null,height:null,mobile:null,mobileortablet:null,ios:!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),ios7:!!navigator.userAgent.match(/OS 7_/g),ipad:!!navigator.userAgent.match(/(iPad)/g),orientation:"",ie:!!window.MSStream,webbrowser:location.href.indexOf("http")>-1,initialmapview:!0,inframe:top!==self},vars:{basehtml:null},defaultpagestate:{view:"detail",popup:"none",filter:{datasource:"lives_improved",subtype:"all",orulevel:"1",oru:"world",sector:"philips",mru:"philips"}},labels:{simulatortitle:" simulation"},trendgraph:{predictionlabel:"Q1 2014",predictiondate:"2014-03-31",pointsvisible:null,stylecurrentline:""},el:{outerwrapper:null},btnfilterclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"open filter panel"}),window.objFilter.show()},btnbookmarksclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"open bookmarks panel"}),window.objBookmarks.show()},btnexplainclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"open help panel"}),window.objExplain.show()},btnlogoutclick:function(e){window.objAnalytics.data.events.push({category:"button",action:"click",label:"logout"}),window.objLogin.logout()},showtransparentlayer:function(){window.getEl("transparentlayer").style.display="block"},hidetransparentlayer:function(){window.getEl("transparentlayer").style.display="none"},isMobile:{any:function(){return"none"===window.getComputedStyle(window.getEl("map"),null).display},mobileortablet:function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}},setmainwrapperclass:function(){window.app.el.outerwrapper.className=window.objConfig.sitetype+" "+window.objPageState.state.filter.sector+" view-"+window.objPageState.state.view+" datasource-"+window.objPageState.state.filter.datasource+" subtype-"+window.objPageState.state.filter.subtype+" orulevel-"+window.objPageState.state.filter.orulevel+" oru-"+window.objPageState.state.filter.oru+" sector-"+window.objPageState.state.filter.sector+" mru-"+window.objPageState.state.filter.mru+" pubtype-"+window.objConfig.pubtype+" nrdatasources-"+window.objConfig.datasources.length},retrievemetadata:function(){var e={fulldomain:location.protocol+"//"+location.hostname,method:"getoruandproductdata",type:"json",token:window.objLogin.token,snapshotid:window.objConfig.currentsnapshotid};window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,app.retrievemetadatahandler)},retrievemetadatahandler:function(e,t){e||window.hasProperty(t,"error")?window.hasProperty(t,"error")?window.objError.show("There was an error retrieving metadata information. "+("object"==typeof t?JSON.stringify(t):t),!0):window.objError.show("There was an error retrieving metadata information. "+("object"==typeof e?JSON.stringify(e):e),!0):t.hasOwnProperty("authenticated")&&!t.authenticated?window.handleShibbolethLoginRequired():(window.objOruFilter.json=t.result.orudata,window.objOruFilter.postprocessorudata(),window.objMruFilter.preparehtml(t.result.productdata),window.objConfig.datasources.indexOf("sustainability")>-1?app.retrievesustainabilitydata():window.objConfig.datasources.indexOf("global_presence")>-1?app.retrieveglobalpresencedata():app.processinitialview(!0))},retrievesustainabilitydata:function(){var e={_type:"json",method:"getworldmapdata",token:window.objLogin.token,source:"sustainability",period:window.objConfig.datatype,pubtype:window.objConfig.pubtype};window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,function(e,t){null!=e?window.objError.show("There was an error retrieving the sustainability data. "+("object"==typeof e?JSON.parse(e):e),!0):(window.objData.sustainability=t,window.objConfig.datasources.indexOf("global_presence")>-1?app.retrieveglobalpresencedata():app.processinitialview(!0))})},retrieveglobalpresencedata:function(){var e={_type:"json",method:"getworldmapdata",token:window.objLogin.token,source:"global_presence",period:window.objConfig.datatype,pubtype:window.objConfig.pubtype};window.psv("GET",window.objConfig.urls.dynamicresourceurl,e,function(e,t){null!=e?window.objError.show("There was an error retrieving the Global Presence data. "+("object"==typeof e?JSON.parse(e):e),!0):(window.objData.global_presence=t,app.processinitialview(!0))})},start:function(e){window.objLogin.hide(),window.objMap.updatemap(e,app.showappintromessage)},showappintromessage:function(){var e=window.objStore.getlocalstorageitem("seenAppIntro");window.isPublicSite()?window.objStore.setlocalstorageitem("seenAppIntro","true"):e&&app.state.mobile||!app.state.mobile?window.objLogin.showupdatemessages():(window.objPanelInfo.show("app"),window.objStore.setlocalstorageitem("seenAppIntro","true"))},getdimensions:function(){var e=this;e.state.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e.state.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e.state.width>e.state.height?e.state.orientation="landscape":e.state.orientation="portrait"},processinitialview:function(e){var t=this;if(location.hash.length>0){var o=window.objPageState.hash2object(location.hash);o.hasOwnProperty("error")?location.hash=window.objPageState.object2hash(t.defaultpagestate):e?window.objPageState.handlechange(o):location.hash.indexOf("!/login/")>-1||(window.objStore.setlocalstorageitem("stateremembered",JSON.stringify(o)),o.view="login",location.hash=window.objPageState.object2hash(o))}else if(null!==window.objStore.getlocalstorageitem("stateremembered"))try{var a=JSON.parse(window.objStore.getlocalstorageitem("stateremembered"));window.objStore.removelocalstorageitem("stateremembered"),location.hash=window.objPageState.object2hash(a)}catch(e){window.objStore.removelocalstorageitem("stateremembered"),location.hash=window.objPageState.object2hash(t.defaultpagestate)}else location.hash=window.objPageState.object2hash(t.defaultpagestate)},initobjects:function(){var e=this;e.getdimensions(),e.state.mobile=e.isMobile.any(),e.state.mobileortablet=e.isMobile.mobileortablet(),window.objStore.init(),window.objAnalytics.init(),window.objLogin.init(),window.objMap.init(),window.objFooter.init(),window.objHeader.init(),window.objOverlay.init(),window.objRegionInfo.init(),window.objSliders.init(),window.objError.init(),window.objFilter.init(),window.objBookmarks.init(),window.objExplain.init(),window.objTrendGraph.init(),window.objLoading.init(),window.objPanelInfo.init(),window.objOruFilter.init(),window.objMruFilter.init(),window.objDataFilter.init(),e.state.ios&&(window.objZoomPanSettings.dragtimerdelay=800,window.objZoomPanSettings.touchtimerdelay=300,e.state.ios7&&(window.getEl("title_bar").style.height="65px",window.getEl("info").style.top="10px",window.getEl("btn_back").style.top="10px",window.getEl("toggle_favourite").style.top="10px")),e.setmainwrapperclass(),app.state.inframe&&window.toggleClass(document.body,"inframe",!0);var t=window.translateFragment("wm_label_ar16"),o=parseInt(window.objConfig.siteid.replace(/^.*(\d\d)$/,"$1"),10);"qr"===window.objConfig.pubtype&&window.objConfig.siteid.indexOf("q1")>-1&&o--,t=t.replace("16",o),window.objConfig.siteid.indexOf("q2")>-1||window.objConfig.siteid.indexOf("q3")>-1?t=t.replace("full-year","the first half-year"):window.objConfig.siteid.indexOf("q4")>-1&&(t=t.replace("full-year","the second half-year")),document.getElementById("sustainability_footnote").innerHTML=t,window.objLogin.getsnapshotconfig()},retrievetranslationfragments:function(e,t){if(e)window.objError.show(e,!0);else{window.app.vars.basehtml=t;var o=location.href.replace(/^(.*)index.*$/,"$1")+"data/locale-"+window.objConfig.lang+("en"===window.objConfig.lang?"_US":"_CN")+".json";(window.location.href.indexOf("results.philips.com")>-1||window.location.href.indexOf("resultshub.com")>-1)&&(o="/publications/"+(app.state.inframe?window.objConfig.siteid:"ar16")+"/data/locale-"+window.objConfig.lang+("en"===window.objConfig.lang?"_US":"_CN")+".json"),window.psv("GET",o,{v:window.pageVars.version},function(e,t){if(e)window.objError.show("There was an error retrieving translation fragments. "+("object"==typeof e?JSON.stringify(e):e),!0);else{for(var o in t)"string"==typeof o&&(window.objConfig.fragments[o]=t[o]);window.app.reworkbasehtml()}})}},reworkbasehtml:function(){window.app.vars.basehtml=window.app.vars.basehtml.replace(/\[([a-zA-Z\d\s_-]*?)\]/g,function(e,t,o,a){return window.translateFragment(t)}),app.el.outerwrapper.innerHTML=window.app.vars.basehtml;for(var e=document.getElementsByClassName("datafilter"),t=[],o=0;o<e.length;o++){var a=e[o].id.replace(/tab_/,"");-1===window.objConfig.datasources.indexOf(a)&&t.push(e[o].id)}t.forEach(function(e){document.getElementById(e).parentNode.removeChild(document.getElementById(e))}),window.app.initobjects()},init:function(){var e=this;app.defaultpagestate.filter.datasource=window.objConfig.datasources[0],e.el.outerwrapper=window.getEl("content_outer_wrapper"),window.serverSideRequest({url:window.objConfig.urls.base+"/data/body_content.html?v="+window.pageVars.version,method:"get",debug:!1,callback:window.app.retrievetranslationfragments})}},regValid=/^#\!\/(login|worldmap|detail?)\/((\w|\d|-)+)\/((\w|\d|-)+)\/((\w|\d|-)+)\/((\w|\d|-)+)\/(filter|faq|help|bookmark|none?)\/((\w|\d|-)+)\/((\w|\d|-)+?)$/g,objPageState={state:{view:null,popup:null,filter:{datasource:null,subtype:null,orulevel:null,oru:null,sector:null,mru:null}},stateremembered:{},vars:{processed:0},clonestateobject:function(){var e=this;return{view:e.state.view,popup:e.state.popup,filter:{orulevel:e.state.filter.orulevel,oru:e.state.filter.oru,sector:e.state.filter.sector,mru:e.state.filter.mru,datasource:objPageState.state.filter.datasource}}},setstateobject:function(e){var t=this;e.hasOwnProperty("view")&&(t.state.view=e.view),e.hasOwnProperty("popup")&&(t.state.popup=e.popup),e.hasOwnProperty("filter")&&(e.filter.hasOwnProperty("orulevel")&&(t.state.filter.orulevel=e.filter.orulevel),e.filter.hasOwnProperty("oru")&&(t.state.filter.oru=e.filter.oru),e.filter.hasOwnProperty("sector")&&(t.state.filter.sector=e.filter.sector),e.filter.hasOwnProperty("mru")&&(t.state.filter.mru=e.filter.mru),e.filter.hasOwnProperty("datasource")&&(t.state.filter.datasource=e.filter.datasource),e.filter.hasOwnProperty("subtype")&&(t.state.filter.subtype=e.filter.subtype))},updatepagestate:function(e){var t=objPageState.clonestateobject();e.hasOwnProperty("view")&&(t.view=e.view),e.hasOwnProperty("popup")&&(t.popup=e.popup),e.hasOwnProperty("filter")&&(e.filter.hasOwnProperty("orulevel")&&(t.filter.orulevel=e.filter.orulevel),e.filter.hasOwnProperty("oru")&&(t.filter.oru=e.filter.oru),e.filter.hasOwnProperty("sector")&&(t.filter.sector=e.filter.sector),e.filter.hasOwnProperty("mru")&&(t.filter.mru=e.filter.mru),e.filter.hasOwnProperty("datasource")&&(t.filter.datasource=e.filter.datasource),e.filter.hasOwnProperty("subtype")&&(t.filter.subtype=e.filter.subtype)),location.hash=objPageState.object2hash(t),objPageState.vars.processed++},hash2object:function(e){return regValid.test(e)?{view:e.replace(regValid,"$1"),popup:e.replace(regValid,"$10"),filter:{orulevel:e.replace(regValid,"$2"),oru:e.replace(regValid,"$4"),sector:e.replace(regValid,"$6"),mru:e.replace(regValid,"$8"),datasource:e.replace(regValid,"$11"),subtype:e.replace(regValid,"$13")}}:{error:!0}},object2hash:function(e){return"#!/"+e.view+"/"+e.filter.orulevel+"/"+e.filter.oru+"/"+e.filter.sector+"/"+e.filter.mru+"/"+e.popup+"/"+e.filter.datasource+"/"+(e.filter.subtype?e.filter.subtype:"all")},calculatestatedelta:function(e,t){var o={filter:{}};for(var a in e)if("string"==typeof a&&t.hasOwnProperty(a))if("filter"===a){if(t.hasOwnProperty("filter"))for(var i in e.filter)"string"==typeof i&&t.filter.hasOwnProperty(i)&&e.filter[i]!==t.filter[i]&&(o.filter[i]=t.filter[i])}else e[a]!==t[a]&&(o[a]=t[a]);return o},handlechange:function(e){var t=this,o=t.calculatestatedelta(t.state,e);window.objAnalytics.data.views.push({page:location.hash.substr(2),title:location.hash.replace(regValid,function(){if("login"===e.view)return"/login";if(null==window.objOruFilter.json)return"/nothing";for(var t="/"+arguments[1]+"/"+window.objOruFilter.convertoruleveltomarket(arguments[2]).toLowerCase()+"/"+arguments[4]+"/",o=window.objMruFilter.getmrufilteraxisarray(arguments[8]),a=[],i=0;i<o.length;i++)a.push(o[i].name.toLowerCase().replace(/[\s]/gi,"_").replace(/&amp;/,"and"));return t+=a.join("/")+"/"+arguments[10]})});var a=!1,i=!1,n=!1,r=!1,l=!1,s=!1;if(t.state.filter.orulevel!==e.filter.orulevel&&(i=!0,a=!0),t.state.filter.oru!==e.filter.oru&&(n=!0,a=!0),t.state.filter.sector!==e.filter.sector&&(a=!0),t.state.filter.mru!==e.filter.mru&&(a=!0),t.state.filter.datasource!==e.filter.datasource&&(r=!0,a=!0,window.objDataFilter.state.filter.datasource=e.filter.datasource),t.state.filter.subtype!==e.filter.subtype&&(l=!0,a=!0,window.objDataFilter.state.filter.subtype=e.filter.subtype),JSON.stringify(t.state,null,"  "),JSON.stringify(e,null,"  "),JSON.stringify(o,null,"  "),"login"===t.state.view&&"login"!==e.view&&(s=!0),t.state.mobileortablet&&t.state.initialmapview&&s&&"login"!==e.view&&app.showtransparentlayer(),(i||r||l)&&(window.objMap.datatypes=window.objMap.createdatatypelistforregions(e.filter.orulevel),window.objDataFilter.renderdatasubtypefilters(),"all"!==e.filter.subtype?window.objDataFilter.subtypechanged(e.filter.datasource,e.filter.subtype):window.objDataFilter.datasourcechanged(e.filter.datasource),window.objDataFilter.renderdatalabel(e.filter.datasource)),n&&"lives_improved"!==e.filter.datasource&&window.objRegionInfo.setdetailspanel(e.filter.datasource,e.filter.subtype),t.state.view!==e.view)switch(e.view){case"login":t.stateremembered=t.clonestateobject(),t.setstateobject(e),window.objLogin.show();break;default:t.updateworldmapview(e,o)}else a&&t.updateworldmapview(e,o);window.objOruFilter.setdatalevelattribute(e.filter.orulevel),t.setstateobject(e),window.app.setmainwrapperclass()},updateworldmapview:function(e,t){this.setstateobject(e);var o=!1;t.hasOwnProperty("filter")&&(t.filter.hasOwnProperty("orulevel")||t.filter.hasOwnProperty("datasource")||t.filter.hasOwnProperty("sector"))&&(o=!0),"object"==typeof window.objMap.data&&!1===o?(t.hasOwnProperty("filter")&&t.filter.hasOwnProperty("subtype")&&window.objMap.updatemap("detail"===e.view,app.showappintromessage),"detail"===e.view?window.objMap.detailspanel():(window.objRegionInfo.hide(),window.objMap.hideselectedcountries(),window.objHeader.setregionname(window.objMap.state.mapname))):(window.objOruFilter.settocurrentoru(),"detail"===e.view?app.start(!0):app.start())},copyfilterattributes:function(e){self.state.filter.orulevel!==e.filter.orulevel&&(self.state.filter.orulevel=e.filter.orulevel),self.state.filter.oru!==e.filter.oru&&(self.state.filter.oru=e.filter.oru),self.state.filter.sector!==e.filter.sector&&(self.state.filter.sector=e.filter.sector),self.state.filter.mru!==e.filter.mru&&(self.state.filter.mru=e.filter.mru)},init:function(){}},objAnalytics={data:{views:[],events:[]},state:{enabled:-1===location.href.indexOf("www.results.philips.com")},asyncanalytics:function(){for(var e=this,t=0;t<e.data.views.length;t++)e.state.enabled&&window.ga("send","pageview",e.data.views[t]),t===e.data.views.length-1&&(e.data.views.length=0);for(t=0;t<e.data.events.length;t++){if(e.data.events[t].hasOwnProperty("category")&&e.data.events[t].hasOwnProperty("action"))switch(Object.keys(e.data.events[t]).length){case 2:e.state.enabled&&window.ga("send","event",e.data.events[t].category,e.data.events[t].action);break;case 3:e.data.events[t].hasOwnProperty("label")&&e.state.enabled&&window.ga("send","event",e.data.events[t].category,e.data.events[t].action,e.data.events[t].label);break;case 4:e.data.events[t].hasOwnProperty("label")&&e.data.events[t].hasOwnProperty("value")&&e.state.enabled&&window.ga("send","event",e.data.events[t].category,e.data.events[t].action,e.data.events[t].label,e.data.events[t].value)}t===e.data.events.length-1&&(e.data.events.length=0)}window.setTimeout(function(){objAnalytics.asyncanalytics()},500)},init:function(){var e=this;if(e.state.enabled){!function(e,t,o,a,i,n,r){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,n=t.createElement(o),r=t.getElementsByTagName(o)[0],n.async=1,n.src=a,r.parentNode.insertBefore(n,r)}(window,document,"script",location.href.indexOf("http")>-1?"//www.google-analytics.com/analytics.js":"js/lib/analytics.js","ga");var t;t=location.href.indexOf("http")>-1?"auto":{storage:"none",clientId:window.objStore.getlocalstorageitem("statguid")},window.ga("create","UA-52778332-1",t),window.ga("set","forceSSL",!0),window.ga("send","pageview",{page:"/start"+(location.href.indexOf("http")>-1?"/website":"/app")}),e.asyncanalytics()}}};window.onresize=function(){app.getdimensions();try{app.isMobile.any()||(window.objMap.resizeworldmap(),window.objMap.centerworldmap(window.objMap.el.rootanimate),window.objTrendGraph.drawgraph())}catch(e){}},window.onhashchange=function(){var e=objPageState.hash2object(location.hash);e.hasOwnProperty("error")?location.hash=objPageState.object2hash(app.defaultpagestate):objPageState.handlechange(e)},window.objData={};