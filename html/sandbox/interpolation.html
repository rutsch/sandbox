<!DOCTYPE html>
<!--[if IEMobile 7 ]>    <html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js"> <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<script type="text/javascript" src="../js/helpers/utils.js">//</script>
		<script type="text/javascript" src="../js/helpers/infographic.js">//</script>
		<script type="text/javascript" src="../js/panels/region_info.js">//</script>
		<script type="text/javascript" src="../js/panels/sliders.js">//</script>

		<style>

			body {
				background-color: white;
			}
			
#section1, #section2{
 width: 300px;

}
#slidersales, #slidergreensales{
	width: 250px;
}
path#arc_path, circle#background, path#arc_path_left{
	fill: none;
	stroke-width: 20;       	
}

path#arc_path {
    opacity: 0.4;
    stroke: #000000;
}
path#arc_path_left{
    opacity: 0.6;
    stroke: #000000;
}
circle#background{
	stroke-opacity: .1;
	stroke: #efefef;
}
.slider_value{
	width: 12%;
	display: inline-block;
	font-size: 15px;
	font-weight: bold;
	padding: 0px 0px;
	color: #007aa7;
	float: right;
}
.range_indicator{
	width: 83%;
	height: 20px;
	position: relative;
	padding-top: 5px;
	color: #4a4a4a;
	font-size: 9px;
}
.range_indicator .min{
	position: absolute;
	left: 0%;
}
.range_indicator .zero{
	position: absolute;
	left: 41%;	
}
.range_indicator .max{
	position: absolute;
	left: 98%;	
}

		</style>

	
	</head>
	<body>

		<div id="region_info_wrapper">
			<div class="svg_wrapper">
				<div id="holder">
					<svg id="svg_circle" xmlns="http://www.w3.org/2000/svg" version="1.1" width="30%" height="30%" viewBox="-10 -10 240 240">
					  <g id="g" fill="none" transform="translate(-80,-80)">
						<circle id="background" width="100" cx="200" cy="200" r="100" />
						<path id="arc_path" />
						<g id="arc_path_left_wrapper" transform="rotate(0,200,200)">
							<path id="arc_path_left" />
						</g>
						<g transform="translate(20,0)">
							<text id="lives_improved_percentage" x="140" y="210" fill="#000">100%</text>
							<text id="lives_improved_percentage_sub" x="0" y="220" fill="#000" width="200">
								<tspan x="5.3em" dy="1.1em">of population</tspan>
							</text>
						</g>
					  </g>
						<g transform="translate(50,50)" id="down">
							<path fill="#FFFFFF" d="M25.719,25.599c4.455-4.459,4.455-11.681-0.002-16.136c-4.453-4.457-11.679-4.458-16.133,0
								c-4.458,4.455-4.457,11.679,0,16.136C14.04,30.054,21.266,30.055,25.719,25.599z M15.816,23.015
								c-0.603-0.001-1.094-0.491-1.095-1.096c0.001-0.603,0.493-1.093,1.093-1.094l3.523,0.001l-6.847-6.847
								c-0.215-0.215-0.322-0.495-0.323-0.772c0.001-0.281,0.108-0.564,0.321-0.773c0.425-0.429,1.119-0.429,1.546,0l6.848,6.849
								l0.002-3.521c0-0.605,0.488-1.094,1.095-1.094c0.603-0.002,1.091,0.491,1.093,1.09v6.163c0,0.012-0.006,0.017-0.006,0.027
								c-0.003,0.138-0.029,0.267-0.078,0.392c-0.05,0.115-0.123,0.215-0.207,0.305c-0.014,0.018-0.018,0.037-0.029,0.051
								c-0.017,0.017-0.037,0.02-0.055,0.037c-0.091,0.078-0.191,0.151-0.303,0.198c-0.133,0.056-0.275,0.084-0.42,0.084L15.816,23.015z"
								/>
						</g>
						<g transform="translate(50,50)" id="up">
							<path fill="#FFFFFF" d="M25.719,9.462c-4.457-4.455-11.681-4.455-16.137,0c-4.457,4.457-4.457,11.682,0,16.137
								c4.456,4.457,11.68,4.457,16.137,0C30.174,21.145,30.174,13.917,25.719,9.462z M23.133,19.367c0,0.604-0.49,1.094-1.093,1.094
								c-0.604,0-1.093-0.49-1.093-1.094v-3.522l-6.85,6.848c-0.213,0.215-0.493,0.32-0.773,0.32c-0.279,0-0.561-0.105-0.774-0.32
								c-0.427-0.426-0.427-1.119,0-1.547l6.848-6.848h-3.52c-0.603,0-1.094-0.489-1.094-1.094c0-0.604,0.491-1.093,1.094-1.093h6.161
								c0.011,0,0.019,0.005,0.028,0.006c0.135,0.003,0.266,0.027,0.389,0.079c0.117,0.047,0.217,0.121,0.309,0.203
								c0.015,0.014,0.035,0.018,0.049,0.031c0.016,0.017,0.02,0.038,0.035,0.055c0.081,0.09,0.152,0.188,0.199,0.301
								c0.058,0.135,0.084,0.277,0.084,0.421V19.367z"/>
						</g>
					</svg>
				</div>					
			</div>
		</div>
		<div id="nr_lives_improved" style="font-size: 40px; font-weight: bold;">0</div>
		<div id="simulation">
			<div id="simulation_wrapper">
				<div id="section1">
					<h4>Sales</h4>
					<input id="slidersales" type="range" min="-20" max="30" value="0" step="0.1" class="philips"><div class="slider_value" id="value_sales">0%</div>		
					<div class="range_indicator">
						<div class="min" id="salesmin">-20</div>
						<div class="zero" id="saleszero">0</div>
						<div class="max" id="salesmax">30</div>
					</div>								
				</div>
				<div id="section2">
					<h4>Green sales</h4>
					<input id="slidergreensales" type="range" min="-20" max="30" value="0" step="0.1" class="philips"><div class="slider_value" id="value_green_sales">0%</div>		
					<div class="range_indicator">
						<div class="min" id="greensalesmin">-20</div>
						<div class="zero" id="greensaleszero">0</div>
						<div class="max" id="greensalesmax">30</div>
					</div>
				</div>
			</div>
			<div id="simulation_error_wrapper">

			</div>
		</div>
		<div id="debug" style="width: 400px; height: 500px; overflow: auto; border: 1px solid red;position: absolute; top: 10px; left: 50%">...</debug>

		<script>
			var objMruFilter={state: {selectedmru: "philips", selectedsector: "philips", tweening: false}};
			var objOruFilter={state: {selectedoru: 1, selectedoruguid: "world"}};
			var objMap={
				data: {
					philips_world:{
						p: 6947233495.0,
						g: 71228.656,
						l: 1747187453.67277
					}
				},
				roundlivesimproveddataobject: function(objData){
					var intDecimals=0;
					
					//lives improved
					if(objData.l>=0){
						//always have 4 digits in the display
						//more than 1000 million
						if(objData.l>=1000000000){
							//console.log('-2');
							objData.roundedl=Math.round(objData.l/1000000);
						}
						//100 - 999.99 million
						if(objData.l>=100000000 && objData.l<1000000000){
							//console.log('-1');
							objData.roundedl=Math.round((objData.l/1000000)*10)/10;
							intDecimals=1;
						}
						//10 - 99.99 million
						if(objData.l>=10000000 && objData.l<100000000){
							//console.log('0');
							objData.roundedl=Math.round((objData.l/1000000)*100)/100;
							intDecimals=2;
						}
						//0.0001 - 9.99 million
						if(objData.l>=1 && objData.l<10000000){
							//console.log('1');
							objData.roundedl=Math.round((objData.l/1000000)*1000)/1000;
							intDecimals=3;
						}

						objData.displayl=formatMoney(objData.roundedl, intDecimals,',','.','');
						objData.labell='million lives improved';
					}

					//gdp
					if(objData.g>=0){
						if(objData.g>1){
							objData.roundedg=Math.round(objData.g/1);
							intDecimals=0;
						}else{
							objData.roundedg=Math.round((objData.g/1)*10)/10;
							intDecimals=1;
						}
						objData.displayg=formatMoney(objData.roundedg, intDecimals,',','.','');
						objData.labelg=' billion';				
					}

					//population
					if(objData.p>=0){
						if(objData.p>1000000){
							objData.roundedp=Math.round(objData.p/1000000);
							intDecimals=0;
						}else{
							objData.roundedp=Math.round((objData.p/1000000)*10)/10;
							intDecimals=1;
						}
						objData.displayp=formatMoney(objData.roundedp, intDecimals,',','.','');
						objData.labelp=' million';	
					}

					return objData;
				}
			}
			var objRegionInfo={
				el: {wrapper: getEl('region_info_wrapper')}

			}

			var objTrendGraph = {
				updatelastpointingraph: function(bla){}

			}

			var app = {
				state: {
					width: null,
					height: null,
					mobile: null,
					ios: ( navigator.userAgent.match(/(iPad|iPhone|iPod)/g) ? true : false ),
					ipad: ( navigator.userAgent.match(/(iPad)/g) ? true : false )
				},

				start: function(){
					//retrieve a set of simulator data for philips-world
					psv('GET', 'js/simulator_philips_world.json', {}, function(err, response){

						if(response.error) {
							alert(response.error.message);
						}else{
							console.log('sucessfully loaded simulator data');
							//store the data we have received
							objSliders.vars.data=response;

							

							//initiate the base logic and start sampling the slider positions
							objSliders.setupsimulator();
						}
					});
							
				},
				init: function(){
					var self = this;
					self.state.width = document.body.clientWidth;
					self.state.height = document.documentElement["clientHeight"];

					objArcProps.targetnode=getEl('arc_path');
					objArcProps.targetleftwrapper=getEl('arc_path_left_wrapper');
					objArcProps.targetleftnode=getEl('arc_path_left');	
					renderInfographic({angle: 0});

					objSliders.init();
					//set the debug modus to true
					objSliders.vars.debug=true;
					objSliders.vars.updatetrendgraph=false;
					objSliders.vars.updatecurrent=true;

					self.start();

				}
			}

			app.init();

		</script>	
	</body>
</html>    
